<!doctype html>
<html>
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <title>iOS Developers Guide | Parse</title>

  <link rel="apple-touch-icon" sizes="57x57" href="https://parse.com/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://parse.com/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://parse.com/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://parse.com/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://parse.com/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://parse.com/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://parse.com/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://parse.com/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://parse.com/apple-touch-icon-180x180.png">
  <meta name="apple-mobile-web-app-title" content="Parse">
  <link rel="icon" type="image/png" href="https://parse.com/favicon-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://parse.com/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="https://parse.com/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="https://parse.com/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="https://parse.com/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#5298fc">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="application-name" content="Parse">

  <meta name="theme-color" content="#5298fc">

      <!-- CSS -->
      <!-- build:css -->
      <link href="/Docs/css/lib/vendor/prism.css" rel="stylesheet" />
      <link href="/Docs/css/lib/vendor/custom_prism-okaidia.css" rel="stylesheet" />
      <link href="/Docs/css/lib/vendor/prism-line-numbers.css" rel="stylesheet" />
      <link href="/Docs/css/docs.css" rel="stylesheet" />
      <!-- endbuild -->


      <!--[if lte IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/classlist/2014.01.31/classList.min.js"></script>
      <![endif]-->

      <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

  <!--[if lt IE 8]>
      <link rel="stylesheet" type="text/css" href="/stylesheets/ie7.css" />
  <![endif]-->
  <!--[if IE 8]>
      <link rel="stylesheet" type="text/css" href="/stylesheets/ie8.css" />
  <![endif]-->
  <!--[if lt IE 10]>
      <link rel="stylesheet" type="text/css" href="/stylesheets/ie89.css" />
  <![endif]-->
  <script>if(Function('/*@cc_on return document.documentMode===10@*/')()){document.documentElement.className+=' ie10';}</script>

  <meta name="csrf-param" content="authenticity_token">
  <meta name="csrf-token" content="KxDoKysxiXDIRV8VXwDYlQStDGzjbGZ24y6ZgQLYAsE=">
  <meta name="description" content="Focus on creating unique &amp; engaging apps on any platform. We take care of everything else your app needs, from the core of your app to analytics and push notifications.">
  <meta name="keywords" content="backend, mobile, development, server, code">
  <meta property="fb:app_id" content="361736430535656">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Parse">
  <meta property="og:image" content="http://parse.com/images/og/default.jpg">
  <meta property="og:description" content="Focus on creating unique &amp; engaging apps on any platform. We take care of everything else your app needs, from the core of your app to analytics and push notifications.">
  <meta property="og:url" content="https://parse.com/docs/ios/guide">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
<script type="text/javascript" async="" src="./docs-detail_files/tagjs"></script><meta name="chromesniffer" id="chromesniffer_meta" content="{&quot;Google Analytics&quot;:-1,&quot;jQuery&quot;:&quot;1.7.2&quot;,&quot;jQuery UI&quot;:&quot;1.8.21&quot;,&quot;Backbone.js&quot;:&quot;0.9.2&quot;,&quot;Underscore.js&quot;:&quot;1.4.4&quot;}"><script type="text/javascript" src="chrome-extension://homgcnaoacgigpkkljjjekpignblkeae/detector.js"></script><style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
.en-markup-crop-options {
  top: 18px !important;
  left: 50% !important;
  margin-left: -100px !important;
  width: 200px !important;
  border: 2px rgba(255,255,255,.38) solid !important;
  border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
  margin-left: 0px !important;
}
  </style>
</head>

  <body class="pure p_docs p_docs_show_guide user_logged_in" style="position: relative;">
  <div class="site__wrapper">
    <div class="site__content">

      <aside class="site__menu">
    <nav class="site__menu__nav">
        <ul>
            <li><a href="/migration">Migration Guide</a></li>
            <li><a href="/help">Help</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="http://blog.parse.com/">Blog</a></li>
        </ul>
    </nav>

    <div class="site__menu__socials">
        <h4 class="h4">Stay Connected</h4>

        <ul>
            <li>
                <a href="https://www.facebook.com/parseit">
                    <svg class="icon icon-fb"><use xlink:href="/assets/symbols.svg#fb"></use></svg>
                </a>
            </li>
            <li>
                <a href="https://twitter.com/parseit">
                    <svg class="icon icon-twitter"><use xlink:href="/assets/symbols.svg#twitter"></use></svg>
                </a>
            </li>
            <li>
                <a href="https://parseplatform.github.io">
                    <svg class="icon icon-github"><use xlink:href="/assets/symbols.svg#github"></use></svg>
                </a>
            </li>
            <li>
                <a href="http://stackoverflow.com/questions/tagged/parse.com">
                    <svg class="icon icon-stack-overflow"><use xlink:href="/assets/symbols.svg#stack-overflow"></use></svg>
                </a>
            </li>
        </ul>

        <p class="site__menu__build-together">Let&rsquo;s build together.</p>
    </div>
</aside>

      <div class="content__wrapper">
        <header class="site__header site__header--white">
    <div class="container">

        <a href="/" class="header-logo">
            <span class="hidden">Parse</span>
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            	 viewBox="0 0 152 60" style="enable-background:new 0 0 152 60;" xml:space="preserve">
            <g>
            	<path class="line one" d="M23.072,39.678c-0.011,3.348-2.395,4.615-4.909,4.615c-2.851,0-4.541-1.701-4.541-4.357
            		c0-2.964,2.031-4.667,5.35-4.725h13.611c6.428,0.079,10.137-5.391,10.137-9.953c0-4.598-3.485-9.598-9.622-9.842
            		c-6.083-0.242-9.99,5.281-9.99,11.167v3.863"/>
            	<path class="line two" d="M23.072,39.678c-0.011,3.348-2.395,4.615-4.909,4.615c-2.851,0-4.541-1.701-4.541-4.357
            		c0-2.964,2.031-4.667,5.35-4.725h13.611c6.428,0.079,10.137-5.391,10.137-9.953c0-4.598-3.485-9.598-9.622-9.842
            		c-6.083-0.242-9.99,5.281-9.99,11.167v3.863"/>
            	<path class="line three" d="M23.072,39.678c-0.011,3.348-2.395,4.615-4.909,4.615c-2.851,0-4.541-1.701-4.541-4.357
            		c0-2.964,2.031-4.667,5.35-4.725h13.611c6.428,0.079,10.137-5.391,10.137-9.953c0-4.598-3.485-9.598-9.622-9.842
            		c-6.083-0.242-9.99,5.281-9.99,11.167v3.863"/>
            	<path class="st1" d="M151.88,31.106c0-4.561-2.575-7.835-7.173-7.872c-5.665-0.037-9.197,4.12-9.197,10.484v0.11
            		c0,6.033,3.863,9.601,9.601,9.601c1.839,0,4.083-0.405,5.739-1.177v-3.568c-1.839,0.956-3.752,1.398-5.408,1.398
            		c-3.568,0-6.07-1.803-6.18-5.959h12.36C151.807,33.056,151.88,32.026,151.88,31.106z M148.312,31.07h-8.829
            		c0.625-3.053,2.354-4.745,4.966-4.745c2.575,0,3.863,1.729,3.863,4.561V31.07z"/>
            	<path class="st1" d="M125.725,34.712l0.405,0.147c2.869,1.03,3.531,1.655,3.531,2.906c0,1.471-0.993,2.428-3.458,2.428
            		c-1.986,0-4.12-0.662-6.364-1.692v3.752c1.803,0.699,4.12,1.177,6.364,1.177c4.819,0,7.21-2.428,7.21-5.812
            		c0-2.943-1.471-4.525-5.408-5.959l-0.405-0.147c-3.127-1.14-3.752-1.655-3.752-2.869c0-1.361,0.956-2.281,3.237-2.281
            		c1.839,0,3.642,0.589,5.408,1.435v-3.531c-1.582-0.625-3.348-1.03-5.26-1.03c-4.598,0-7.1,2.575-7.1,5.886
            		C120.134,31.695,121.679,33.24,125.725,34.712"/>
            	<path class="st1" d="M110.863,29.892c1.288-2.023,3.09-3.016,5.26-3.016c0.773,0,1.508,0.11,2.17,0.331v-3.384
            		c-0.625-0.258-1.361-0.405-2.134-0.405c-2.281,0-4.01,1.03-5.518,3.09l-0.258-2.869h-3.164v19.386h3.642V29.892z"/>
            	<path class="st1" d="M96.481,23.197c-2.281,0-4.672,0.699-6.474,1.692v3.605c2.023-1.251,4.378-2.023,6.254-2.023
            		c2.612,0,3.679,1.14,3.679,3.274v1.619c-5.334,0.147-8.461,1.03-10.116,2.685c-1.177,1.14-1.692,2.685-1.692,4.267
            		c0,3.274,2.354,5.15,5.702,5.15c2.244,0,4.378-0.92,6.327-2.796l0.221,2.354h3.164V30.003
            		C103.544,25.405,101.263,23.197,96.481,23.197z M99.938,37.728c-1.471,1.619-3.2,2.722-5.297,2.722
            		c-1.729,0-2.833-0.883-2.833-2.428c0-2.281,1.876-3.642,8.13-3.826V37.728z"/>
            	<path class="st1" d="M77.609,17.643h-8.571v25.383h3.826v-8.314h4.745c5.923,0,9.491-3.164,9.491-8.498V26.14
            		C87.1,20.806,83.532,17.643,77.609,17.643z M83.311,26.214c0,3.421-1.986,5.04-5.444,5.04h-5.003V21.101h5.04
            		c3.421,0,5.408,1.619,5.408,5.04V26.214z"/>
            	<path class="st1" d="M27.838,2.192C12.204,2.192-0.12,14.589-0.12,30.15c0,15.597,12.323,27.958,27.958,27.958
            		c15.634,0,27.958-12.36,27.958-27.958C55.795,14.589,43.472,2.192,27.838,2.192z M32.473,36.955H18.752
            		c-1.986,0-3.164,1.214-3.164,3.017c0,1.582,1.067,2.722,2.612,2.722c1.766,0,2.796-1.214,2.906-3.016h4.01
            		c-0.184,4.341-2.906,6.658-6.953,6.658c-3.789,0-6.585-2.575-6.585-6.401c0-3.973,2.98-6.769,7.394-6.769h13.611
            		c4.598,0,8.093-3.348,8.093-7.909c0-4.598-3.127-7.799-7.578-7.799c-4.414,0-7.946,3.237-7.946,9.123v3.863h-4.046v-3.863
            		c0-7.872,5.076-12.986,12.066-12.986c6.695,0,11.551,4.782,11.551,11.588C44.723,32.026,39.499,36.955,32.473,36.955z"/>
            </g>
            </svg>
        </a>

        <a href="javascript:;" class="header-hamburger" data-menu-trigger="toggle">
            <span class="header-hamburger__wrap">
                <span class="header-hamburger__line--top"></span>
                <span class="header-hamburger__line--middle"></span>
                <span class="header-hamburger__line--bottom"></span>

                <span class="header-hamburger__line--arrow-top"></span>
                <span class="header-hamburger__line--arrow-bottom"></span>
            </span>
        </a>

        <ul class="header-nav">
            <li><a href="https://parse.com/migration">Migration Guide</a></li>
            <li><a href="https://parse.com/apps/quickstart">QuickStart Guide</a></li>
            <li><a href="/Docs">Docs</a></li>
            <li><a href="http://blog.parse.com">Blog</a></li>
            <li><a href="https://parse.com/help">Help</a></li>
        </ul>

    </div><!-- container -->
</header>


        <aside class="hero hero--docs">
          <div class="grid-container">
            <div class="col-md--6 col-lg--9">
                <p class="h1 h1--white" data-ignore-from-select>
                    <span>iOS <em>Guide</em></span>

                    <a href="/Docs" class="btn btn--back">
                        <span class="hide-mobile">Browse all platforms</span>
                        <span class="show-mobile">Browse</span>
                    </a>

                    <svg class="icon icon-ios"><use xlink:href="/Docs/assets/symbols.svg#ios"></use></svg>
                </p>
            </div>
          </div>
        </aside><!-- .hero -->

        <div class="guide" data-nav-waypoint>

          <div class="grid-container">
            <div class="col-md--6 col-lg--9">

              <div class="guide_content">
                <div id="toc" style="overflow-y: scroll; height: 100%;">
                  <div class="top_links">
                  
                    <a href="https://parse.com/apps/quickstart">Quickstart<i class="icon_minimize"></i></a>
                  
                  
                    <a href="https://parse.com/docs/ios/api/">API Reference<i class="icon_minimize"></i></a>
                  

                    <ul class="ui_live_toc">
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#getting-started">Getting Started</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#objects">Objects</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="The PFObject" class="ui_live_toc_major">
                            <a href="#the-pfobject">The PFObject</a>
                          </li>
                        
                          <li data-name="Saving Objects" class="ui_live_toc_major">
                            <a href="#saving-objects">Saving Objects</a>
                          </li>
                        
                          <li data-name="Retrieving Objects" class="ui_live_toc_major">
                            <a href="#retrieving-objects">Retrieving Objects</a>
                          </li>
                        
                          <li data-name="The Local Datastore" class="ui_live_toc_major">
                            <a href="#the-local-datastore">The Local Datastore</a>
                          </li>
                        
                          <li data-name="Saving Objects Offline" class="ui_live_toc_major">
                            <a href="#saving-objects-offline">Saving Objects Offline</a>
                          </li>
                        
                          <li data-name="Updating Objects" class="ui_live_toc_major">
                            <a href="#updating-objects">Updating Objects</a>
                          </li>
                        
                          <li data-name="Deleting Objects" class="ui_live_toc_major">
                            <a href="#deleting-objects">Deleting Objects</a>
                          </li>
                        
                          <li data-name="Relational Data" class="ui_live_toc_major">
                            <a href="#relational-data">Relational Data</a>
                          </li>
                        
                          <li data-name="Data Types" class="ui_live_toc_major">
                            <a href="#data-types">Data Types</a>
                          </li>
                        
                          <li data-name="Subclasses" class="ui_live_toc_major">
                            <a href="#subclasses">Subclasses</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#queries">Queries</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="Basic Queries" class="ui_live_toc_major">
                            <a href="#basic-queries">Basic Queries</a>
                          </li>
                        
                          <li data-name="Specifying Constraints with NSPredicate" class="ui_live_toc_major">
                            <a href="#specifying-constraints-with-nspredicate">Specifying Constraints with NSPredicate</a>
                          </li>
                        
                          <li data-name="Query Constraints" class="ui_live_toc_major">
                            <a href="#query-constraints">Query Constraints</a>
                          </li>
                        
                          <li data-name="Queries On Array Values" class="ui_live_toc_major">
                            <a href="#queries-on-array-values">Queries On Array Values</a>
                          </li>
                        
                          <li data-name="Queries On String Values" class="ui_live_toc_major">
                            <a href="#queries-on-string-values">Queries On String Values</a>
                          </li>
                        
                          <li data-name="Relational Queries" class="ui_live_toc_major">
                            <a href="#relational-queries">Relational Queries</a>
                          </li>
                        
                          <li data-name="Querying The Local Datastore" class="ui_live_toc_major">
                            <a href="#querying-the-local-datastore">Querying The Local Datastore</a>
                          </li>
                        
                          <li data-name="Caching Queries" class="ui_live_toc_major">
                            <a href="#caching-queries">Caching Queries</a>
                          </li>
                        
                          <li data-name="Counting Objects" class="ui_live_toc_major">
                            <a href="#counting-objects">Counting Objects</a>
                          </li>
                        
                          <li data-name="Compound Queries" class="ui_live_toc_major">
                            <a href="#compound-queries">Compound Queries</a>
                          </li>
                        
                          <li data-name="Subclass Queries" class="ui_live_toc_major">
                            <a href="#subclass-queries">Subclass Queries</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#users">Users</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="Properties" class="ui_live_toc_major">
                            <a href="#properties">Properties</a>
                          </li>
                        
                          <li data-name="Signing Up" class="ui_live_toc_major">
                            <a href="#signing-up">Signing Up</a>
                          </li>
                        
                          <li data-name="Logging In" class="ui_live_toc_major">
                            <a href="#logging-in">Logging In</a>
                          </li>
                        
                          <li data-name="Verifying Emails" class="ui_live_toc_major">
                            <a href="#verifying-emails">Verifying Emails</a>
                          </li>
                        
                          <li data-name="Current User" class="ui_live_toc_major">
                            <a href="#current-user">Current User</a>
                          </li>
                        
                          <li data-name="Anonymous Users" class="ui_live_toc_major">
                            <a href="#anonymous-users">Anonymous Users</a>
                          </li>
                        
                          <li data-name="Setting The Current User" class="ui_live_toc_major">
                            <a href="#setting-the-current-user">Setting The Current User</a>
                          </li>
                        
                          <li data-name="Security For User Objects" class="ui_live_toc_major">
                            <a href="#security-for-user-objects">Security For User Objects</a>
                          </li>
                        
                          <li data-name="Resetting Passwords" class="ui_live_toc_major">
                            <a href="#resetting-passwords">Resetting Passwords</a>
                          </li>
                        
                          <li data-name="Querying" class="ui_live_toc_major">
                            <a href="#querying">Querying</a>
                          </li>
                        
                          <li data-name="Associations" class="ui_live_toc_major">
                            <a href="#associations">Associations</a>
                          </li>
                        
                          <li data-name="Facebook Users" class="ui_live_toc_major">
                            <a href="#facebook-users">Facebook Users</a>
                          </li>
                        
                          <li data-name="Twitter Users" class="ui_live_toc_major">
                            <a href="#twitter-users">Twitter Users</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#sessions">Sessions</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="Properties" class="ui_live_toc_major">
                            <a href="#properties">Properties</a>
                          </li>
                        
                          <li data-name="Handling Invalid Session Token Error" class="ui_live_toc_major">
                            <a href="#handling-invalid-session-token-error">Handling Invalid Session Token Error</a>
                          </li>
                        
                          <li data-name="Security" class="ui_live_toc_major">
                            <a href="#security">Security</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#roles">Roles</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="Properties" class="ui_live_toc_major">
                            <a href="#properties">Properties</a>
                          </li>
                        
                          <li data-name="Security For Role Objects" class="ui_live_toc_major">
                            <a href="#security-for-role-objects">Security For Role Objects</a>
                          </li>
                        
                          <li data-name="Security For Others Objects" class="ui_live_toc_major">
                            <a href="#security-for-others-objects">Security For Others Objects</a>
                          </li>
                        
                          <li data-name="Role Hierarchy" class="ui_live_toc_major">
                            <a href="#role-hierarchy">Role Hierarchy</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#files">Files</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="The PFFile" class="ui_live_toc_major">
                            <a href="#the-pffile">The PFFile</a>
                          </li>
                        
                          <li data-name="Images" class="ui_live_toc_major">
                            <a href="#images">Images</a>
                          </li>
                        
                          <li data-name="Progress" class="ui_live_toc_major">
                            <a href="#progress">Progress</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#geopoints">GeoPoints</a>
                        <ul class="ui_live_toc_major_list">
                        
                          <li data-name="PFGeoPoint" class="ui_live_toc_major">
                            <a href="#pfgeopoint">PFGeoPoint</a>
                          </li>
                        
                          <li data-name="Geo Queries" class="ui_live_toc_major">
                            <a href="#geo-queries">Geo Queries</a>
                          </li>
                        
                          <li data-name="Caveats" class="ui_live_toc_major">
                            <a href="#caveats">Caveats</a>
                          </li>
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#local-datastore">Local Datastore</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#extensions">Extensions</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#push-notifications">Push Notifications</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#config">Config</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#analytics">Analytics</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#user-interface">User Interface</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#in-app-purchases">In-App Purchases</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#data">Data</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#relations">Relations</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#handling-errors">Handling Errors</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#security">Security</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#performance">Performance</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                      <li data-name="" class="ui_live_toc_main">
                        <a href="#errors">Errors</a>
                        <ul class="ui_live_toc_major_list">
                        
                        </ul>
                      </li>
                    
                    </ul>

                  </div>
                </div>

                <div class="wysiwyg-content">
                  
                    
                    <h1 id="getting-started">Getting Started</h1>

<p>If you haven’t installed the SDK yet, please <a href="/apps/quickstart#parse_data/mobile/ios/native/new">head over to the QuickStart guide</a> to get our SDK up and running in Xcode. Note that we support iOS 7.0 and higher. You can also check out our <a href="/docs/ios/api">iOS API Reference</a> and <a href="/docs/osx/api">OS X API Reference</a> for more detailed information about our SDK.</p>

<p>The Parse platform provides a complete backend solution for your mobile application. Our goal is to totally eliminate the need for writing server code or maintaining servers.</p>

<p>On Parse, you create an App for each of your mobile applications. Each App has its own application id and client key that you apply to your SDK install. Your account on Parse can accommodate multiple Apps. This is useful even if you have one application, since you can deploy different versions for test and production.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="objects">Objects</h1>

<h2 id="the-pfobject">The PFObject</h2>

<p>Storing data on Parse is built around the <code class="highlighter-rouge">%{ParseObject}</code>. Each <code class="highlighter-rouge">%{ParseObject}</code> contains key-value pairs of JSON-compatible data. This data is schemaless, which means that you don’t need to specify ahead of time what keys exist on each <code class="highlighter-rouge">%{ParseObject}</code>. You simply set whatever key-value pairs you want, and our backend will store it.</p>

<p>For example, let’s say you’re tracking high scores for a game. A single <code class="highlighter-rouge">%{ParseObject}</code> could contain:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">score</span><span class="err">:</span> <span class="mi">1337</span><span class="p">,</span> <span class="nx">playerName</span><span class="err">:</span> <span class="s2">"Sean Plott"</span><span class="p">,</span> <span class="nx">cheatMode</span><span class="err">:</span> <span class="kc">false</span>
</code></pre>
</div>

<p>Keys must be alphanumeric strings. Values can be strings, numbers, booleans, or even arrays and dictionaries - anything that can be JSON-encoded.</p>

<p>Each <code class="highlighter-rouge">%{ParseObject}</code> has a class name that you can use to distinguish different sorts of data. For example, we could call the high score object a <code class="highlighter-rouge">GameScore</code>. We recommend that you NameYourClassesLikeThis and nameYourKeysLikeThis, just to keep your code looking pretty.</p>

<h2 id="saving-objects">Saving Objects</h2>

<p>Let’s say you want to save the <code class="highlighter-rouge">GameScore</code> described above to the Parse Cloud. The interface is similar to a <code class="highlighter-rouge">NSMutableDictionary</code>, plus the <code class="highlighter-rouge">saveInBackground</code> method:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">@1337</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Sean Plott"</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The object has been saved.
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">gameScore</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Sean Plott"</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">gameScore</span><span class="o">.</span><span class="n">saveInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">success</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The object has been saved.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>After this code runs, you will probably be wondering if anything really happened. To make sure the data was saved, you can look at the Data Browser in your app on Parse. You should see something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">objectId</span><span class="err">:</span> <span class="s2">"xWMyZ4YEGZ"</span><span class="p">,</span> <span class="nx">score</span><span class="err">:</span> <span class="mi">1337</span><span class="p">,</span> <span class="nx">playerName</span><span class="err">:</span> <span class="s2">"Sean Plott"</span><span class="p">,</span> <span class="nx">cheatMode</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">createdAt</span><span class="err">:</span><span class="s2">"2011-06-10T18:33:42Z"</span><span class="p">,</span> <span class="nx">updatedAt</span><span class="err">:</span><span class="s2">"2011-06-10T18:33:42Z"</span>
</code></pre>
</div>

<p>There are two things to note here. You didn’t have to configure or set up a new Class called <code class="highlighter-rouge">GameScore</code> before running this code. Your Parse app lazily creates this Class for you when it first encounters it.</p>

<p>There are also a few fields you don’t need to specify that are provided as a convenience. <code class="highlighter-rouge">objectId</code> is a unique identifier for each saved object. <code class="highlighter-rouge">createdAt</code> and <code class="highlighter-rouge">updatedAt</code> represent the time that each object was created and last modified in the Parse Cloud. Each of these fields is filled in by Parse, so they don’t exist on a <code class="highlighter-rouge">%{ParseObject}</code> until a save operation has completed.</p>

<p>Note: You can use the <code class="highlighter-rouge">saveInBackgroundWithBlock</code> method to provide additional logic to run after the save completes.</p>

<h2 id="retrieving-objects">Retrieving Objects</h2>

<p>Saving data to the cloud is fun, but it’s even more fun to get that data out again. If you have the <code class="highlighter-rouge">objectId</code>, you can retrieve the whole <code class="highlighter-rouge">%{ParseObject}</code> using a <code class="highlighter-rouge">%{ParseQuery}</code>.  This is an asynchronous method, with variations for using either blocks or callback methods:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">getObjectInBackgroundWithId</span><span class="p">:</span><span class="s">@"xWMyZ4YEGZ"</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Do something with the returned PFObject in the gameScore variable.
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">gameScore</span><span class="p">)</span><span class="err">;</span>
<span class="p">}];</span>
<span class="c1">// The InBackground methods are asynchronous, so any code after this will run
// immediately.  Any code that depends on the query result should be moved
// inside the completion block above.
</span></code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">getObjectInBackgroundWithId</span><span class="p">(</span><span class="s">"xWMyZEGZ"</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">gameScore</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">&amp;&amp;</span> <span class="n">gameScore</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">gameScore</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To get the values out of the <code class="highlighter-rouge">%{ParseObject}</code>, you can use either the <code class="highlighter-rouge">objectForKey:</code> method or the <code class="highlighter-rouge">[]</code> subscripting operator:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="p">[[</span><span class="n">gameScore</span> <span class="nf">objectForKey</span><span class="p">:</span><span class="s">@"score"</span><span class="p">]</span> <span class="nf">intValue</span><span class="p">];</span>
<span class="n">NSString</span> <span class="o">*</span><span class="n">playerName</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">[</span><span class="s">@"playerName"</span><span class="p">];</span>
<span class="n">BOOL</span> <span class="n">cheatMode</span> <span class="o">=</span> <span class="p">[</span><span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="nf">boolValue</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">score</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">Int</span>
<span class="k">let</span> <span class="nv">playerName</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">[</span><span class="s">"playerName"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">String</span>
<span class="k">let</span> <span class="nv">cheatMode</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">Bool</span>
</code></pre>
</div>

<p>The three special values are provided as properties:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSString</span> <span class="o">*</span><span class="n">objectId</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">.</span><span class="n">objectId</span><span class="p">;</span>
<span class="n">NSDate</span> <span class="o">*</span><span class="n">updatedAt</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">.</span><span class="n">updatedAt</span><span class="p">;</span>
<span class="n">NSDate</span> <span class="o">*</span><span class="n">createdAt</span> <span class="o">=</span> <span class="n">gameScore</span><span class="p">.</span><span class="n">createdAt</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">objectId</span> <span class="o">=</span> <span class="n">gameScore</span><span class="o">.</span><span class="n">objectId</span>
<span class="k">let</span> <span class="nv">updatedAt</span> <span class="o">=</span> <span class="n">gameScore</span><span class="o">.</span><span class="n">updatedAt</span>
<span class="k">let</span> <span class="nv">createdAt</span> <span class="o">=</span> <span class="n">gameScore</span><span class="o">.</span><span class="n">createdAt</span>
</code></pre>
</div>

<p>If you need to refresh an object you already have with the latest data that
    is in the Parse Cloud, you can call the <code class="highlighter-rouge">fetch</code> method like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">myObject</span> <span class="nf">fetch</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">myObject</span><span class="o">.</span><span class="nf">fetch</span><span class="p">()</span>
</code></pre>
</div>

<p>Note: In a similar way to the <code class="highlighter-rouge">save</code> methods, you can use the <code class="highlighter-rouge">fetchInBackgroundWithBlock</code> or <code class="highlighter-rouge">fetchInBackgroundWithTarget:selector:</code> methods to provide additional logic which will run after fetching the object.</p>

<h2 id="the-local-datastore">The Local Datastore</h2>

<p>Parse also lets you store objects in a <a href="#local-datastore">local datastore</a> on the device itself. You can use this for data that doesn’t need to be saved to the cloud, but this is especially useful for temporarily storing data so that it can be synced later. To enable the datastore, add <code class="highlighter-rouge">libsqlite3.dylib</code> and call <code class="highlighter-rouge">[Parse enableLocalDatastore]</code> in your <code class="highlighter-rouge">AppDelegate</code> <code class="highlighter-rouge">application:didFinishLaunchWithOptions:</code> before calling <code class="highlighter-rouge">[Parse setApplicationId:clientKey:]</code>. Once the local datastore is enabled, you can store an object by pinning it.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1337</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Sean Plott"</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">pinInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">gameScore</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Sean Plott"</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">pinInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>As with saving, this recursively stores every object and file that <code class="highlighter-rouge">gameScore</code> points to, if it has been fetched from the cloud. Whenever you save changes to the object, or fetch new changes from Parse, the copy in the datastore will be automatically updated, so you don’t have to worry about it.</p>

<h3 id="retrieving-objects-from-the-local-datastore">Retrieving Objects from the Local Datastore</h3>

<p>Storing an object is only useful if you can get it back out. To get the data for a specific object, you can use a <code class="highlighter-rouge">%{ParseQuery}</code> just like you would while on the network, but using the <code class="highlighter-rouge">fromLocalDatastore</code> method to tell it where to get the data.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">fromLocalDatastore</span><span class="p">];</span>
<span class="p">[[</span><span class="n">query</span> <span class="nf">getObjectInBackgroundWithId</span><span class="p">:</span><span class="s">@"xWMyZ4YEGZ"</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// something went wrong;
</span>    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="c1">// task.result will be your game score
</span>  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">fromLocalDatastore</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">getObjectInBackgroundWithId</span><span class="p">(</span><span class="s">"xWMyZ4YEGZ"</span><span class="p">)</span><span class="o">.</span><span class="nf">continueWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="c1">// There was an error.</span>
      <span class="k">return</span> <span class="n">task</span>
  <span class="p">}</span>

  <span class="c1">// task.result will be your game score</span>
  <span class="k">return</span> <span class="n">task</span>
<span class="p">})</span>
</code></pre>
</div>

<p>If you already have an instance of the object, you can instead use the <code class="highlighter-rouge">fetchFromLocalDatastoreInBackground</code> method.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">objectId</span><span class="p">:</span><span class="s">@"xWMyZ4YEGZ"</span><span class="p">];</span>
<span class="p">[[</span><span class="n">object</span> <span class="nf">fetchFromLocalDatastoreInBackground</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// something went wrong
</span>    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="c1">// task.result will be your game score
</span>  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span><span class="s">"xWMyZ4YEGZ"</span><span class="p">)</span>
<span class="n">object</span><span class="o">.</span><span class="nf">fetchFromLocalDatastoreInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="c1">// There was an error.</span>
      <span class="k">return</span> <span class="n">task</span>
  <span class="p">}</span>

  <span class="c1">// task.result will be your game score</span>
  <span class="k">return</span> <span class="n">task</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="unpinning-objects">Unpinning Objects</h3>

<p>When you are done with the object and no longer need to keep it on the device, you can release it with <code class="highlighter-rouge">unpinInBackground</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">unpinInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">unpinInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="saving-objects-offline">Saving Objects Offline</h2>

<p>Most save functions execute immediately, and inform your app when the save is complete. If you don’t need to know when the save has finished, you can use <code class="highlighter-rouge">saveEventually</code> instead. The advantage is that if the user currently doesn’t have a network connection, <code class="highlighter-rouge">saveEventually</code> will store the update on the device until a network connection is re-established. If your app is closed before the connection is back, Parse will try again the next time the app is opened. All calls to <code class="highlighter-rouge">saveEventually</code> (and <code class="highlighter-rouge">deleteEventually</code>) are executed in the order they are called, so it is safe to call <code class="highlighter-rouge">saveEventually</code> on an object multiple times.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create the object.
</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">@1337</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Sean Plott"</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveEventually</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">gameScore</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Sean Plott"</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">saveEventually</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="updating-objects">Updating Objects</h2>

<p>Updating an object is simple. Just set some new data on it and call one of the save methods. Assuming you have saved the object and have the <code class="highlighter-rouge">objectId</code>, you can retrieve the <code class="highlighter-rouge">%{ParseObject}</code> using a <code class="highlighter-rouge">%{ParseQuery}</code> and update its data:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>

<span class="c1">// Retrieve the object by id
</span><span class="p">[</span><span class="n">query</span> <span class="nf">getObjectInBackgroundWithId</span><span class="p">:</span><span class="s">@"xWMyZ4YEGZ"</span>
                             <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Now let's update it with some new data. In this case, only cheatMode and score
</span>    <span class="c1">// will get sent to the cloud. playerName hasn't changed.
</span>    <span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@YES</span><span class="err">;</span>
    <span class="n">gameScore</span><span class="p">[</span><span class="s">@"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">@1338</span><span class="err">;</span>
    <span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveInBackground</span><span class="p">]</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">getObjectInBackgroundWithId</span><span class="p">(</span><span class="s">"xWMyZEGZ"</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">gameScore</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="k">let</span> <span class="nv">gameScore</span> <span class="o">=</span> <span class="n">gameScore</span> <span class="p">{</span>
    <span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1338</span>
    <span class="n">gameScore</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The client automatically figures out which data has changed so only “dirty” fields will be sent to Parse. You don’t need to worry about squashing data that you didn’t intend to update.</p>

<h3 id="counters">Counters</h3>

<p>The above example contains a common use case. The “score” field is a counter that we’ll need to continually update with the player’s latest score. Using the above method works but it’s cumbersome and can lead to problems if you have multiple clients trying to update the same counter.</p>

<p>To help with storing counter-type data, Parse provides methods that atomically increment (or decrement) any number field. So, the same update can be rewritten as:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">incrementKey</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The score key has been incremented
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">incrementKey</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="o">.</span><span class="n">saveInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">success</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The score key has been incremented</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can also increment by any amount using <code class="highlighter-rouge">incrementKey:byAmount:</code>.</p>

<h3 id="arrays">Arrays</h3>

<p>To help with storing array data, there are three operations that can be used to atomically change an array field:</p>

<ul>
  <li><code class="highlighter-rouge">addObject:forKey:</code> and <code class="highlighter-rouge">addObjectsFromArray:forKey:</code> append the given objects to the end of an array field.</li>
  <li><code class="highlighter-rouge">addUniqueObject:forKey:</code> and <code class="highlighter-rouge">addUniqueObjectsFromArray:forKey:</code> add only the given objects which aren’t already contained in an array field to that field. The position of the insert is not guaranteed.</li>
  <li><code class="highlighter-rouge">removeObject:forKey:</code> and <code class="highlighter-rouge">removeObjectsInArray:forKey:</code> remove all instances of each given object from an array field.</li>
</ul>

<p>For example, we can add items to the set-like “skills” field like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">addUniqueObjectsFromArray</span><span class="p">:@[</span><span class="s">@"flying"</span><span class="p">,</span> <span class="s">@"kungfu"</span><span class="p">]</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"skills"</span><span class="p">];</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">addUniqueObjectsFromArray</span><span class="p">([</span><span class="s">"flying"</span><span class="p">,</span> <span class="s">"kungfu"</span><span class="p">],</span> <span class="nv">forKey</span><span class="p">:</span><span class="s">"skills"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Note that it is not currently possible to atomically add and remove items from an array in the same save.
    You will have to call <code class="highlighter-rouge">save</code> in between every different kind of array operation.</p>

<h2 id="deleting-objects">Deleting Objects</h2>

<p>To delete an object from the cloud:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">deleteInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">deleteInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>If you want to run a callback when the delete is confirmed, you can use the <code class="highlighter-rouge">deleteInBackgroundWithBlock:</code> or <code class="highlighter-rouge">deleteInBackgroundWithTarget:selector:</code> methods. If you want to block the calling thread, you can use the <code class="highlighter-rouge">delete</code> method.</p>

<p>You can delete a single field from an object with the <code class="highlighter-rouge">removeObjectForKey</code> method:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// After this, the playerName field will be empty
</span><span class="p">[</span><span class="n">gameScore</span> <span class="nf">removeObjectForKey</span><span class="p">:</span><span class="s">@"playerName"</span><span class="p">];</span>

<span class="c1">// Saves the field deletion to the Parse Cloud
</span><span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// After this, the playerName field will be empty</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">removeObjectForKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">)</span>

<span class="c1">// Saves the field deletion to the Parse Cloud</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="relational-data">Relational Data</h2>

<p>Objects can have relationships with other objects. To model this behavior, any <code class="highlighter-rouge">%{ParseObject}</code> can be used as a value in other <code class="highlighter-rouge">%{ParseObject}</code>s. Internally, the Parse framework will store the referred-to object in just one place, to maintain consistency.</p>

<p>For example, each <code class="highlighter-rouge">Comment</code> in a blogging app might correspond to one <code class="highlighter-rouge">Post</code>. To create a new <code class="highlighter-rouge">Post</code> with a single <code class="highlighter-rouge">Comment</code>, you could write:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create the post
</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">myPost</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="n">myPost</span><span class="p">[</span><span class="s">@"title"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"I'm Hungry"</span><span class="p">;</span>
<span class="n">myPost</span><span class="p">[</span><span class="s">@"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Where should we go for lunch?"</span><span class="p">;</span>

<span class="c1">// Create the comment
</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">myComment</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span><span class="p">];</span>
<span class="n">myComment</span><span class="p">[</span><span class="s">@"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Let's do Sushirrito."</span><span class="p">;</span>

<span class="c1">// Add a relation between the Post and Comment
</span><span class="n">myComment</span><span class="p">[</span><span class="s">@"parent"</span><span class="p">]</span> <span class="o">=</span> <span class="n">myPost</span><span class="p">;</span>

<span class="c1">// This will save both myPost and myComment
</span><span class="p">[</span><span class="n">myComment</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create the post</span>
<span class="k">var</span> <span class="nv">myPost</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Post"</span><span class="p">)</span>
<span class="n">myPost</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"I'm Hungry"</span>
<span class="n">myPost</span><span class="p">[</span><span class="s">"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Where should we go for lunch?"</span>

<span class="c1">// Create the comment</span>
<span class="k">var</span> <span class="nv">myComment</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Comment"</span><span class="p">)</span>
<span class="n">myComment</span><span class="p">[</span><span class="s">"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Let's do Sushirrito."</span>

<span class="c1">// Add a relation between the Post and Comment</span>
<span class="n">myComment</span><span class="p">[</span><span class="s">"parent"</span><span class="p">]</span> <span class="o">=</span> <span class="n">myPost</span>

<span class="c1">// This will save both myPost and myComment</span>
<span class="n">myComment</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>You can also link objects using just their <code class="highlighter-rouge">objectId</code>s like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Add a relation between the Post with objectId "1zEcyElZ80" and the comment
</span><span class="n">myComment</span><span class="p">[</span><span class="s">@"parent"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"Post"</span> <span class="nf">objectId</span><span class="p">:</span><span class="s">@"1zEcyElZ80"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Add a relation between the Post with objectId "1zEcyElZ80" and the comment</span>
<span class="n">myComment</span><span class="p">[</span><span class="s">"parent"</span><span class="p">]</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span><span class="s">"Post"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span><span class="s">"1zEcyElZ80"</span><span class="p">)</span>
</code></pre>
</div>

<p>By default, when fetching an object, related <code class="highlighter-rouge">%{ParseObject}</code>s are not fetched.  These objects’ values cannot be retrieved until they have been fetched like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">post</span> <span class="o">=</span> <span class="n">fetchedComment</span><span class="p">[</span><span class="s">@"parent"</span><span class="p">];</span>
<span class="p">[</span><span class="n">post</span> <span class="nf">fetchIfNeededInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">post</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">NSString</span> <span class="o">*</span><span class="n">title</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s">@"title"</span><span class="p">]</span><span class="err">;</span>
  <span class="c1">// do something with your title variable
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">post</span> <span class="o">=</span> <span class="n">myComment</span><span class="p">[</span><span class="s">"parent"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">PFObject</span>
<span class="n">post</span><span class="o">.</span><span class="n">fetchIfNeededInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">post</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="n">post</span><span class="p">?[</span><span class="s">"title"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
  <span class="c1">// do something with your title variable</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can also model a many-to-many relation using the <code class="highlighter-rouge">PFRelation</code> object.  This works similar to an <code class="highlighter-rouge">NSArray</code> of <code class="highlighter-rouge">PFObjects</code>, except that you don’t need to download all the Objects in a relation at once.  This allows <code class="highlighter-rouge">PFRelation</code> to scale to many more objects than the <code class="highlighter-rouge">NSArray</code> of <code class="highlighter-rouge">%{ParseObject}</code> approach.  For example, a <code class="highlighter-rouge">User</code> may have many <code class="highlighter-rouge">Post</code>s that they might like.  In this case, you can store the set of <code class="highlighter-rouge">Post</code>s that a <code class="highlighter-rouge">User</code> likes using <code class="highlighter-rouge">relationForKey:</code>.  In order to add a post to the list, the code would look something like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">];</span>
<span class="n">PFRelation</span> <span class="o">*</span><span class="n">relation</span> <span class="o">=</span> <span class="p">[</span><span class="n">user</span> <span class="nf">relationForKey</span><span class="p">:</span><span class="s">@"likes"</span><span class="p">];</span>
<span class="p">[</span><span class="n">relation</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">post</span><span class="p">];</span>
<span class="p">[</span><span class="n">user</span> <span class="nf">saveInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The post has been added to the user's likes relation.
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">relation</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="nf">relationForKey</span><span class="p">(</span><span class="s">"likes"</span><span class="p">)</span>
<span class="n">relation</span><span class="o">.</span><span class="nf">addObject</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
<span class="n">user</span><span class="o">.</span><span class="n">saveInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">success</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The post has been added to the user's likes relation.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// There was a problem, check error.description</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can remove a post from the <code class="highlighter-rouge">PFRelation</code> with something like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">relation</span> <span class="nf">removeObject</span><span class="p">:</span><span class="n">post</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">relation</span><span class="o">.</span><span class="nf">removeObject</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
</code></pre>
</div>

<p>By default, the list of objects in this relation are not downloaded.  You can get the list of <code class="highlighter-rouge">Post</code>s by using calling <code class="highlighter-rouge">findObjectsInBackgroundWithBlock:</code> on the <code class="highlighter-rouge">%{ParseQuery}</code> returned by <code class="highlighter-rouge">query</code>.  The code would look like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[[</span><span class="n">relation</span> <span class="nf">query</span><span class="p">]</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// There was an error
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// objects has all the Posts the current user liked.
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">relation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
    <span class="c1">// There was an error</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// objects has all the Posts the current user liked.</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If you want only a subset of the <code class="highlighter-rouge">Post</code>s you can add extra constraints to the <code class="highlighter-rouge">%{ParseQuery}</code> returned by <code class="highlighter-rouge">query</code> like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">relation</span> <span class="nf">query</span><span class="p">];</span>
<span class="c1">// Add other query constraints.
</span></code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="c1">// Add other query constraints.</span>
</code></pre>
</div>

<p>For more details on <code class="highlighter-rouge">%{ParseQuery}</code> please look at the query portion of this guide.  A <code class="highlighter-rouge">PFRelation</code> behaves similar to an <code class="highlighter-rouge">NSArray</code> of <code class="highlighter-rouge">%{ParseObject}</code>, so any queries you can do on arrays of objects (other than <code class="highlighter-rouge">includeKey:</code>) you can do on <code class="highlighter-rouge">PFRelation</code>.</p>

<h2 id="data-types">Data Types</h2>

<p>So far we’ve used values with type <code class="highlighter-rouge">%{string}</code>, <code class="highlighter-rouge">%{integer}</code>, and <code class="highlighter-rouge">%{ParseObject}</code>. Parse also supports <code class="highlighter-rouge">%{date}</code>, <code class="highlighter-rouge">%{map}</code>, <code class="highlighter-rouge">%{array}</code>, and <code class="highlighter-rouge">%{null}</code>. You can nest <code class="highlighter-rouge">%{map}</code> and <code class="highlighter-rouge">%{array}</code> objects to store more structured data within a single <code class="highlighter-rouge">%{ParseObject}</code>. Overall, the following types are allowed for each field in your object:</p>

<ul>
  <li>String =&gt; <code class="highlighter-rouge">%{string}</code></li>
  <li>Number =&gt; <code class="highlighter-rouge">%{integer}</code></li>
  <li>Bool =&gt; <code class="highlighter-rouge">%{bool}</code></li>
  <li>Array =&gt; <code class="highlighter-rouge">%{array}</code></li>
  <li>Object =&gt; <code class="highlighter-rouge">%{map}</code></li>
  <li>Date =&gt; <code class="highlighter-rouge">%{date}</code></li>
  <li>File =&gt; <code class="highlighter-rouge">%{ParseFile}</code></li>
  <li>Pointer =&gt; other <code class="highlighter-rouge">%{ParseObject}</code></li>
  <li>Relation =&gt; <code class="highlighter-rouge">%{ParseRelation}</code></li>
  <li>Null =&gt; <code class="highlighter-rouge">%{null}</code></li>
</ul>

<p>Some examples:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSNumber</span> <span class="o">*</span><span class="n">number</span> <span class="o">=</span> <span class="mi">@42</span><span class="p">;</span>
<span class="n">NSNumber</span> <span class="o">*</span><span class="n">bool</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="n">NSString</span> <span class="o">*</span><span class="n">string</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"the number is %@"</span><span class="p">,</span> <span class="n">number</span><span class="p">];</span>
<span class="n">NSDate</span> <span class="o">*</span><span class="n">date</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSDate</span> <span class="nf">date</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">@[</span><span class="n">string</span><span class="p">,</span> <span class="n">number</span><span class="p">];</span>
<span class="n">NSDictionary</span> <span class="o">*</span><span class="n">dictionary</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span><span class="s">@"number"</span><span class="o">:</span> <span class="n">number</span><span class="p">,</span> <span class="s">@"string"</span><span class="o">:</span> <span class="n">string</span><span class="p">};</span>
<span class="n">NSNull</span> <span class="o">*</span><span class="n">null</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSNull</span> <span class="nf">null</span><span class="p">];</span>
<span class="n">PFObject</span> <span class="o">*</span><span class="n">pointer</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"MyClassName"</span> <span class="nf">objectId</span><span class="p">:</span><span class="s">@"xyz"</span><span class="p">];</span>

<span class="n">PFObject</span> <span class="o">*</span><span class="n">bigObject</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"BigObject"</span><span class="p">];</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myNumberKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">number</span><span class="p">;</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myBoolKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool</span><span class="p">;</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myStringKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">string</span><span class="p">;</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myDateKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span><span class="p">;</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myArrayKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">;</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">@"myObjectKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">;</span> <span class="c1">// shows up as 'object' in the Data Browser
</span><span class="n">bigObject</span><span class="p">[</span><span class="s">@"anyKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span> <span class="c1">// this value can only be saved to an existing key
</span><span class="n">bigObject</span><span class="p">[</span><span class="s">@"myPointerKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pointer</span><span class="p">;</span> <span class="c1">// shows up as Pointer &lt;MyClassName&gt; in the Data Browser
</span><span class="p">[</span><span class="n">bigObject</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">number</span> <span class="o">=</span> <span class="mi">42</span>
<span class="k">let</span> <span class="nv">bool</span> <span class="o">=</span> <span class="kc">false</span>
<span class="k">let</span> <span class="nv">string</span> <span class="o">=</span> <span class="s">"the number is </span><span class="se">\(</span><span class="n">number</span><span class="se">)</span><span class="s">"</span>
<span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="kt">NSDate</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span><span class="p">,</span> <span class="n">number</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">dictionary</span> <span class="o">=</span> <span class="p">[</span><span class="s">"number"</span><span class="p">:</span> <span class="n">number</span><span class="p">,</span> <span class="s">"string"</span><span class="p">:</span> <span class="n">string</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">null</span> <span class="o">=</span> <span class="kt">NSNull</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">pointer</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">"MyClassName"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span> <span class="s">"xyz"</span><span class="p">)</span>

<span class="k">var</span> <span class="nv">bigObject</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"BigObject"</span><span class="p">)</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myNumberKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">number</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myBooleanKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myStringKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">string</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myDateKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myArrayKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myObjectKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictionary</span> <span class="c1">// shows up as 'object' in the Data Browser</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"anyKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">null</span> <span class="c1">// this value can only be saved to an existing key</span>
<span class="n">bigObject</span><span class="p">[</span><span class="s">"myPointerKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pointer</span> <span class="c1">// shows up as Pointer &lt;MyClassName&gt; in the Data Browser</span>
<span class="n">bigObject</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>We do not recommend storing large pieces of binary data like images or documents on <code class="highlighter-rouge">%{ParseObject}</code>. <code class="highlighter-rouge">%{ParseObject}</code>s should not exceed 128 kilobytes in size. We recommend you use <code class="highlighter-rouge">%{ParseFile}</code>s to store images, documents, and other types of files. You can do so by instantiating a <code class="highlighter-rouge">%{ParseFile}</code> object and setting it on a field. See <a href="#files">Files</a> for more details.</p>

<p>For more information about how Parse handles data, check out our documentation on <a href="#data">Data</a>.</p>

<h2 id="subclasses">Subclasses</h2>

<p>Parse is designed to get you up and running as quickly as possible. You can access all of your data using the <code class="highlighter-rouge">%{ParseObject}</code> class and access any field with <code class="highlighter-rouge">objectForKey:</code> or the <code class="highlighter-rouge">[]</code> subscripting operator. In mature codebases, subclasses have many advantages, including terseness, extensibility, and support for autocomplete. Subclassing is completely optional, but can transform this code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">shield</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Armor"</span><span class="p">];</span>
<span class="n">shield</span><span class="p">[</span><span class="s">@"displayName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Wooden Shield"</span><span class="p">;</span>
<span class="n">shield</span><span class="p">[</span><span class="s">@"fireProof"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="n">shield</span><span class="p">[</span><span class="s">@"rupees"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">@50</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">shield</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Armor"</span><span class="p">)</span>
<span class="n">shield</span><span class="p">[</span><span class="s">"displayName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Wooden Shield"</span>
<span class="n">shield</span><span class="p">[</span><span class="s">"fireProof"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">shield</span><span class="p">[</span><span class="s">"rupees"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
</code></pre>
</div>

<p>Into this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">Armor</span> <span class="o">*</span><span class="n">shield</span> <span class="o">=</span> <span class="p">[</span><span class="n">Armor</span> <span class="nf">object</span><span class="p">];</span>
<span class="n">shield</span><span class="p">.</span><span class="n">displayName</span> <span class="o">=</span> <span class="s">@"Wooden Shield"</span><span class="p">;</span>
<span class="n">shield</span><span class="p">.</span><span class="n">fireProof</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
<span class="n">shield</span><span class="p">.</span><span class="n">rupees</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">shield</span> <span class="o">=</span> <span class="kt">Armor</span><span class="p">()</span>
<span class="n">shield</span><span class="o">.</span><span class="n">displayName</span> <span class="o">=</span> <span class="s">"Wooden Shield"</span>
<span class="n">shield</span><span class="o">.</span><span class="n">fireProof</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">shield</span><span class="o">.</span><span class="n">rupees</span> <span class="o">=</span> <span class="mi">50</span>
</code></pre>
</div>

<h3 id="subclassing-pfobject">Subclassing PFObject</h3>

<p>To create a <code class="highlighter-rouge">%{ParseObject}</code> subclass:</p>

<ol>
  <li>Declare a subclass which conforms to the <code class="highlighter-rouge">PFSubclassing</code> protocol.</li>
  <li>Implement the class method <code class="highlighter-rouge">parseClassName</code>. This is the string you would pass to <code class="highlighter-rouge">initWithClassName:</code> and makes all future class name references unnecessary.</li>
  <li>Import <code class="highlighter-rouge">PFObject+Subclass</code> in your .m file. This implements all methods in <code class="highlighter-rouge">PFSubclassing</code> beyond <code class="highlighter-rouge">parseClassName</code>.</li>
  <li>Call <code class="highlighter-rouge">[YourClass registerSubclass]</code> before Parse <code class="highlighter-rouge">setApplicationId:clientKey:</code>.</li>
</ol>

<p>An easy way to do this is with your class’ <a href="https://developer.apple.com/library/ios/documentation/cocoa/reference/foundation/classes/nsobject_class/reference/reference.html#//apple_ref/occ/clm/NSObject/load">+load</a> (Obj-C only) or with <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/#//apple_ref/occ/clm/NSObject/initialize">initialize</a> (both Obj-C and Swift) methods.</p>

<p>Please note that the <code class="highlighter-rouge">initialize</code> method is not called until the class receives its first message, meaning that you need to call any instance or class method on your subclass before it will be registered with Parse SDK.</p>

<p>The following code sucessfully declares, implements, and registers the <code class="highlighter-rouge">Armor</code> subclass of <code class="highlighter-rouge">%{ParseObject}</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Armor.h
</span><span class="k">@interface</span> <span class="nc">Armor</span> <span class="p">:</span> <span class="nc">PFObject</span><span class="o">&lt;</span><span class="n">PFSubclassing</span><span class="o">&gt;</span>
<span class="o">+</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">parseClassName</span><span class="p">;</span>
<span class="k">@end</span>

<span class="c1">// Armor.m
// Import this header to let Armor know that PFObject privately provides most
// of the methods for PFSubclassing.
</span><span class="cp">#import &lt;Parse/PFObject+Subclass.h&gt;
</span>
<span class="k">@implementation</span> <span class="nc">Armor</span>
<span class="k">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">load</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">self</span> <span class="nf">registerSubclass</span><span class="p">];</span>
<span class="p">}</span>

<span class="o">+</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">parseClassName</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s">@"Armor"</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Import this header into your Swift bridge header file to</span>
<span class="c1">// let Armor know that PFObject privately provides most of</span>
<span class="c1">// the methods for PFSubclassing.</span>
<span class="cp">#import &lt;Parse/PFObject+Subclass.h&gt;</span>

<span class="c1">// Armor.swift</span>

<span class="kd">class</span> <span class="kt">Armor</span> <span class="p">:</span> <span class="kt">PFObject</span><span class="p">,</span> <span class="kt">PFSubclassing</span> <span class="p">{</span>
  <span class="k">override</span> <span class="kd">class</span> <span class="kd">func</span> <span class="nf">initialize</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">struct</span> <span class="kt">Static</span> <span class="p">{</span>
      <span class="kd">static</span> <span class="k">var</span> <span class="nv">onceToken</span> <span class="p">:</span> <span class="n">dispatch_once_t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nf">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="kt">Static</span><span class="o">.</span><span class="n">onceToken</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">self</span><span class="o">.</span><span class="nf">registerSubclass</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="kd">func</span> <span class="nf">parseClassName</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">"Armor"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="properties--methods">Properties &amp; Methods</h3>

<p>Adding custom properties and methods to your <code class="highlighter-rouge">%{ParseObject}</code> subclass helps encapsulate logic about the class. With <code class="highlighter-rouge">PFSubclassing</code>, you can keep all your logic about a subject in one place rather than using separate classes for business logic and storage/transmission logic.</p>

<p><code class="highlighter-rouge">%{ParseObject}</code> supports dynamic synthesizers just like <code class="highlighter-rouge">NSManagedObject</code>. Declare a property as you normally would, but use <code class="highlighter-rouge">@dynamic</code> rather than <code class="highlighter-rouge">@synthesize</code> in your .m file. The following example creates a <code class="highlighter-rouge">displayName</code> property in the <code class="highlighter-rouge">Armor</code> class:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Armor.h
</span><span class="k">@interface</span> <span class="nc">Armor</span> <span class="p">:</span> <span class="nc">PFObject</span><span class="o">&lt;</span><span class="n">PFSubclassing</span><span class="o">&gt;</span>

<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">strong</span><span class="p">)</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">displayName</span><span class="p">;</span>

<span class="k">@end</span>


<span class="c1">// Armor.m
</span><span class="k">@implementation</span> <span class="nc">Armor</span>

<span class="k">@dynamic</span> <span class="n">displayName</span><span class="p">;</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Armor.swift</span>

<span class="kd">class</span> <span class="kt">Armor</span> <span class="p">:</span> <span class="kt">PFObject</span><span class="p">,</span> <span class="kt">PFSubclassing</span> <span class="p">{</span>

  <span class="kd">@NSManaged</span> <span class="k">var</span> <span class="nv">displayName</span><span class="p">:</span> <span class="kt">String</span>

<span class="p">}</span>
</code></pre>
</div>

<p>You can access the displayName property using <code class="highlighter-rouge">armor.displayName</code> or <code class="highlighter-rouge">[armor displayName]</code> and assign to it using <code class="highlighter-rouge">armor.displayName = @"Wooden Shield"</code> or <code class="highlighter-rouge">[armor setDisplayName:@"Wooden Sword"]</code>. Dynamic properties allow Xcode to provide autocomplete and catch typos.</p>

<p><code class="highlighter-rouge">NSNumber</code> properties can be implemented either as <code class="highlighter-rouge">NSNumber</code>s or as their primitive counterparts. Consider the following example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@property</span> <span class="n">BOOL</span> <span class="n">fireProof</span><span class="p">;</span>
<span class="k">@property</span> <span class="kt">int</span> <span class="n">rupees</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">@NSManaged</span> <span class="k">var</span> <span class="nv">fireProof</span><span class="p">:</span> <span class="kt">Boolean</span>
<span class="kd">@NSManaged</span> <span class="k">var</span> <span class="nv">rupees</span><span class="p">:</span> <span class="kt">Int</span>
</code></pre>
</div>

<p>In this case, <code class="highlighter-rouge">game[@"fireProof"]</code> will return an <code class="highlighter-rouge">NSNumber</code> which is accessed using <code class="highlighter-rouge">boolValue</code> and <code class="highlighter-rouge">game[@"rupees"]</code> will return an <code class="highlighter-rouge">NSNumber</code> which is accessed using <code class="highlighter-rouge">intValue</code>, but the <code class="highlighter-rouge">fireProof</code> property is an actual <code class="highlighter-rouge">BOOL</code> and the <code class="highlighter-rouge">rupees</code> property is an actual <code class="highlighter-rouge">int</code>. The dynamic getter will automatically extract the <code class="highlighter-rouge">BOOL</code> or <code class="highlighter-rouge">int</code> value and the dynamic setter will automatically wrap the value in an <code class="highlighter-rouge">NSNumber</code>. You are free to use either format. Primitive property types are easier to use but <code class="highlighter-rouge">NSNumber</code> property types support nil values more clearly.</p>

<p>If you need more complicated logic than simple property access, you can declare your own methods as well:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@dynamic</span> <span class="n">iconFile</span><span class="p">;</span>

<span class="k">-</span> <span class="p">(</span><span class="n">UIImageView</span> <span class="o">*</span><span class="p">)</span><span class="n">iconView</span> <span class="p">{</span>
  <span class="n">PFImageView</span> <span class="o">*</span><span class="n">view</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFImageView</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithImage</span><span class="p">:</span><span class="n">kPlaceholderImage</span><span class="p">];</span>
  <span class="n">view</span><span class="p">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">iconFile</span><span class="p">;</span>
  <span class="p">[</span><span class="n">view</span> <span class="nf">loadInBackground</span><span class="p">];</span>
  <span class="k">return</span> <span class="n">view</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">@NSManaged</span> <span class="k">var</span> <span class="nv">iconFile</span><span class="p">:</span> <span class="kt">PFFile</span>

<span class="kd">func</span> <span class="nf">iconView</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">UIImageView</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="kt">PFImageView</span><span class="p">(</span><span class="nv">imageView</span><span class="p">:</span> <span class="kt">PlaceholderImage</span><span class="p">)</span>
  <span class="n">view</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">iconFile</span>
  <span class="n">view</span><span class="o">.</span><span class="nf">loadInBackground</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">view</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="initializing-subclasses">Initializing Subclasses</h3>

<p>You should create new objects with the <code class="highlighter-rouge">object</code> class method. This constructs an autoreleased instance of your type and correctly handles further subclassing. To create a reference to an existing object, use <code class="highlighter-rouge">objectWithoutDataWithObjectId:</code>.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="queries">Queries</h1>

<p>We’ve already seen how a <code class="highlighter-rouge">%{ParseQuery}</code> with <code class="highlighter-rouge">getObjectInBackgroundWithId:block:</code> can retrieve a single <code class="highlighter-rouge">%{ParseObject}</code> from Parse. There are many other ways to retrieve data with <code class="highlighter-rouge">%{ParseQuery}</code> - you can retrieve many objects at once, put conditions on the objects you wish to retrieve, cache queries automatically to avoid writing that code yourself, and more.</p>

<h2 id="basic-queries">Basic Queries</h2>

<p>In many cases, <code class="highlighter-rouge">getObjectInBackgroundWithId:block:</code> isn’t powerful enough to specify which objects you want to retrieve. The <code class="highlighter-rouge">%{ParseQuery}</code> offers different ways to retrieve a list of objects rather than just a single object.</p>

<p>The general pattern is to create a <code class="highlighter-rouge">%{ParseQuery}</code>, put conditions on it, and then retrieve a <code class="highlighter-rouge">NSArray</code> of matching <code class="highlighter-rouge">%{ParseObject}</code>s using either <code class="highlighter-rouge">findObjectsInBackgroundWithBlock:</code> or <code class="highlighter-rouge">findObjectsInBackgroundWithTarget:selector:</code>. For example, to retrieve scores with a particular <code class="highlighter-rouge">playerName</code>, use the <code class="highlighter-rouge">whereKey:equalTo:</code> method to constrain the value for a key.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"Dan Stemkoski"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The find succeeded.
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Successfully retrieved %d scores."</span><span class="p">,</span> <span class="n">objects</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="err">;</span>
    <span class="c1">// Do something with the found objects
</span>    <span class="k">for</span> <span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span> <span class="k">in</span> <span class="n">objects</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">object</span><span class="p">.</span><span class="n">objectId</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Log details of the failure
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@ %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">])</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span><span class="s">"Sean Plott"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>

  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// The find succeeded.</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Successfully retrieved </span><span class="se">\(</span><span class="n">objects</span><span class="o">!.</span><span class="n">count</span><span class="se">)</span><span class="s"> scores."</span><span class="p">)</span>
    <span class="c1">// Do something with the found objects</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">objects</span> <span class="o">=</span> <span class="n">objects</span> <span class="p">{</span>
      <span class="k">for</span> <span class="n">object</span> <span class="k">in</span> <span class="n">objects</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">object</span><span class="o">.</span><span class="n">objectId</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Log details of the failure</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">error</span><span class="o">!</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">error</span><span class="o">!.</span><span class="n">userInfo</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Both <code class="highlighter-rouge">findObjectsInBackgroundWithBlock:</code> and <code class="highlighter-rouge">findObjectsInBackgroundWithTarget:selector:</code> work similarly in that they assure the network request is done without blocking, and run the block/callback in the main thread. There is a corresponding <code class="highlighter-rouge">findObjects</code> method that blocks the calling thread, if you are already in a background thread:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Only use this code if you are already running it in a background
// thread, or for testing purposes!
</span>
<span class="c1">// Using PFQuery
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"Dan Stemkoski"</span><span class="p">];</span>
<span class="n">NSArray</span><span class="o">*</span> <span class="n">scoreArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"playerName = 'Dan Stemkosk'"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
<span class="n">NSArray</span><span class="o">*</span> <span class="n">scoreArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"Dan Stemkoski"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">scoreArray</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">findObjects</span><span class="p">()</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span><span class="s">"playerName = 'Dan Stemkosk'"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">scoreArray</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">findObjects</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="specifying-constraints-with-nspredicate">Specifying Constraints with NSPredicate</h2>

<p>To get the most out of <code class="highlighter-rouge">%{ParseQuery}</code> we recommend using its methods listed below to add constraints. However, if you prefer using <code class="highlighter-rouge">NSPredicate</code>, a subset of the constraints can be specified by providing an <code class="highlighter-rouge">NSPredicate</code> when creating your <code class="highlighter-rouge">%{ParseQuery}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"playerName = 'Dan Stemkosk'"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"playerName = 'Dan Stemkosk'"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>These features are supported:</p>

<ul>
  <li>Simple comparisons such as <code class="highlighter-rouge">=</code>, <code class="highlighter-rouge">!=</code>, <code class="highlighter-rouge">&lt;</code>, <code class="highlighter-rouge">&gt;</code>, <code class="highlighter-rouge">&lt;=</code>, <code class="highlighter-rouge">&gt;=</code>, and <code class="highlighter-rouge">BETWEEN</code> with a key and a constant.</li>
  <li>Containment predicates, such as <code class="highlighter-rouge">x IN {1, 2, 3}</code>.</li>
  <li>Key-existence predicates, such as <code class="highlighter-rouge">x IN SELF</code>.</li>
  <li><code class="highlighter-rouge">BEGINSWITH</code> expressions.</li>
  <li>Compound predicates with <code class="highlighter-rouge">AND</code>, <code class="highlighter-rouge">OR</code>, and <code class="highlighter-rouge">NOT</code>.</li>
  <li>Sub-queries with <code class="highlighter-rouge">"key IN %@", subquery</code>.</li>
</ul>

<p>The following types of predicates are <strong>not</strong> supported:</p>

<ul>
  <li>Aggregate operations, such as <code class="highlighter-rouge">ANY</code>, <code class="highlighter-rouge">SOME</code>, <code class="highlighter-rouge">ALL</code>, or <code class="highlighter-rouge">NONE</code>.</li>
  <li>Regular expressions, such as <code class="highlighter-rouge">LIKE</code>, <code class="highlighter-rouge">MATCHES</code>, <code class="highlighter-rouge">CONTAINS</code>, or <code class="highlighter-rouge">ENDSWITH</code>.</li>
  <li>Predicates comparing one key to another.</li>
  <li>Complex predicates with many <code class="highlighter-rouge">OR</code>ed clauses.</li>
</ul>

<h2 id="query-constraints">Query Constraints</h2>

<p>There are several ways to put constraints on the objects found by a <code class="highlighter-rouge">%{ParseQuery}</code>. You can filter out objects with a particular key-value pair with <code class="highlighter-rouge">whereKey:notEqualTo</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">notEqualTo</span><span class="p">:</span><span class="s">@"Michael Yabuti"</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span>   <span class="s">@"playerName != 'Michael Yabuti'"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">notEqualTo</span><span class="p">:</span> <span class="s">"Michael Yabuti"</span><span class="p">)</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span><span class="s">"playerName != 'Michael Yabuti'"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>You can give multiple constraints, and objects will only be in the results if they match all of the constraints.  In other words, it’s like an AND of constraints.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">notEqualTo</span><span class="p">:</span><span class="s">@"Michael Yabuti"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerAge"</span> <span class="nf">greaterThan</span><span class="p">:</span><span class="mi">@18</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span>   <span class="s">@"playerName != 'Michael Yabuti' AND playerAge &gt; 18"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">notEqualTo</span><span class="p">:</span> <span class="s">"Michael Yabuti"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerAge"</span><span class="p">,</span> <span class="nv">greaterThan</span><span class="p">:</span> <span class="mi">18</span><span class="p">)</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span><span class="s">"playerName != 'Michael Yabuti' AND playerAge &gt; 18"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>You can limit the number of results by setting <code class="highlighter-rouge">limit</code>. By default, results are limited to 100, but anything from 1 to 1000 is a valid limit:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="p">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// limit to at most 10 results
</span></code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">// limit to at most 10 results</span>
</code></pre>
</div>

<p>If you want exactly one result, a more convenient alternative may be to use <code class="highlighter-rouge">getFirstObject</code> or <code class="highlighter-rouge">getFirstObjectInBackground</code> instead of using <code class="highlighter-rouge">findObject</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerEmail"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"dstemkoski@example.com"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">getFirstObjectInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">object</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"The getFirstObject request failed."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The find succeeded.
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Successfully retrieved the object."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerEmail"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"dstemkoski@example.com"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">getFirstObjectInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="o">||</span> <span class="n">object</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"The getFirstObject request failed."</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The find succeeded.</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Successfully retrieved the object."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can skip the first results by setting <code class="highlighter-rouge">skip</code>. This can be useful for pagination:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="p">.</span><span class="n">skip</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// skip the first 10 results
</span></code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre>
</div>

<p>For sortable types like numbers and strings, you can control the order in which results are returned:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Sorts the results in ascending order by the score field
</span><span class="p">[</span><span class="n">query</span> <span class="nf">orderByAscending</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>

<span class="c1">// Sorts the results in descending order by the score field
</span><span class="p">[</span><span class="n">query</span> <span class="nf">orderByDescending</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Sorts the results in ascending order by the score field</span>
<span class="n">query</span><span class="o">.</span><span class="nf">orderByAscending</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>

<span class="c1">// Sorts the results in descending order by the score field</span>
<span class="n">query</span><span class="o">.</span><span class="nf">orderByDescending</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>
</code></pre>
</div>

<p>You can add more sort keys to the query as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Sorts the results in ascending order by the score field if the previous sort keys are equal.
</span><span class="p">[</span><span class="n">query</span> <span class="nf">addAscendingOrder</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>

<span class="c1">// Sorts the results in descending order by the score field if the previous sort keys are equal.
</span><span class="p">[</span><span class="n">query</span> <span class="nf">addDescendingOrder</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Sorts the results in ascending order by the score field if the previous sort keys are equal.</span>
<span class="n">query</span><span class="o">.</span><span class="nf">addAscendingOrder</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>

<span class="c1">// Sorts the results in descending order by the score field if the previous sort keys are equal.</span>
<span class="n">query</span><span class="o">.</span><span class="nf">addDescendingOrder</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>
</code></pre>
</div>

<p>For sortable types, you can also use comparisons in queries:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Restricts to wins &lt; 50
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">lessThan</span><span class="p">:</span><span class="mi">@50</span><span class="p">];</span>
<span class="c1">// Or with NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"wins &lt; 50"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>

<span class="c1">// Restricts to wins &lt;= 50
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">lessThanOrEqualTo</span><span class="p">:</span><span class="mi">@50</span><span class="p">];</span>
<span class="c1">// Or with NSPredicate
</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"wins &lt;= 50"</span><span class="p">];</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">]</span>

<span class="c1">// Restricts to wins &gt; 50
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">greaterThan</span><span class="p">:</span><span class="mi">@50</span><span class="p">];</span>
<span class="c1">// Or with NSPredicate
</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"wins &gt; 50"</span><span class="p">];</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>

<span class="c1">// Restricts to wins &gt;= 50
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">greaterThanOrEqualTo</span><span class="p">:</span><span class="mi">@50</span><span class="p">];</span>
<span class="c1">// Or with NSPredicate
</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"wins &gt;= 50"</span><span class="p">];</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Restricts to wins &lt; 50</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">lessThan</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1">// Or with NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"wins &lt; 50"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>

<span class="c1">// Restricts to wins &lt;= 50</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">lessThanOrEqualTo</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1">// Or with NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"wins &lt;= 50"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>

<span class="c1">// Restricts to wins &gt; 50</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">greaterThan</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1">// Or with NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"wins &gt; 50"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>

<span class="c1">// Restricts to wins &gt;= 50</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">greaterThanOrEqualTo</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span>
<span class="c1">// Or with NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"wins &gt;= 50"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>If you want to retrieve objects matching several different values, you can use <code class="highlighter-rouge">whereKey:containedIn:</code>, providing an array of acceptable values. This is often useful to replace multiple queries with a single query. For example, if you want to retrieve scores made by any player in a particular list:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds scores from any of Jonathan, Dario, or Shawn
// Using PFQuery
</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="p">@[</span><span class="s">@"Jonathan Walsh"</span><span class="p">,</span> <span class="s">@"Dario Wunsch"</span><span class="p">,</span> <span class="s">@"Shawn Simon"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">containedIn</span><span class="p">:</span><span class="n">names</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="p">@[</span><span class="s">@"Jonathan Walsh"</span><span class="p">,</span> <span class="s">@"Dario Wunsch"</span><span class="p">,</span> <span class="s">@"Shawn Simon"</span><span class="p">];</span>
<span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span> <span class="s">@"playerName IN %@"</span><span class="p">,</span> <span class="n">names</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">pred</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds scores from any of Jonathan, Dario, or Shawn</span>
<span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Jonathan Walsh"</span><span class="p">,</span> <span class="s">"Dario Wunsch"</span><span class="p">,</span> <span class="s">"Shawn Simon"</span><span class="p">]</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">containedIn</span><span class="p">:</span> <span class="n">names</span><span class="p">)</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Jonathan Walsh"</span><span class="p">,</span> <span class="s">"Dario Wunsch"</span><span class="p">,</span> <span class="s">"Shawn Simon"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">pred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"playerName IN %@"</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>If you want to retrieve objects that do not match any of several values you can use <code class="highlighter-rouge">whereKey:notContainedIn:</code>, providing an array of acceptable values. For example, if you want to retrieve scores from players besides those in a list:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds scores from anyone who is neither Jonathan, Dario, nor Shawn
// Using PFQuery
</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="p">@[</span><span class="s">@"Jonathan Walsh"</span><span class="p">,</span> <span class="s">@"Dario Wunsch"</span><span class="p">,</span> <span class="s">@"Shawn Simon"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">notContainedIn</span><span class="p">:</span><span class="n">names</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="p">@[</span><span class="s">@"Jonathan Walsh"</span><span class="p">,</span> <span class="s">@"Dario Wunsch"</span><span class="p">,</span> <span class="s">@"Shawn Simon"</span><span class="p">];</span>
<span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span> <span class="s">@"NOT (playerName IN %@)"</span><span class="p">,</span> <span class="n">names</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">pred</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds scores from anyone who is neither Jonathan, Dario, nor Shawn</span>
<span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Jonathan Walsh"</span><span class="p">,</span> <span class="s">"Dario Wunsch"</span><span class="p">,</span> <span class="s">"Shawn Simon"</span><span class="p">]</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">notContainedIn</span><span class="p">:</span> <span class="n">names</span><span class="p">)</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Jonathan Walsh"</span><span class="p">,</span> <span class="s">"Dario Wunsch"</span><span class="p">,</span> <span class="s">"Shawn Simon"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">pred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"NOT (playerName IN %@)"</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>If you want to retrieve objects that have a particular key set, you can use <code class="highlighter-rouge">whereKeyExists</code>. Conversely, if you want to retrieve objects without a particular key set, you can use <code class="highlighter-rouge">whereKeyDoesNotExist</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds objects that have the score set
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKeyExists</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>
<span class="c1">// Or using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"score IN SELF"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>

<span class="c1">// Finds objects that don't have the score set
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKeyDoesNotExist</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>
<span class="c1">// Or using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"NOT (score IN SELF)"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds objects that have the score set</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKeyExists</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>
<span class="c1">// Or using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"score IN SELF"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>

<span class="c1">// Finds objects that don't have the score set</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKeyDoesNotExist</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>
<span class="c1">// Or using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"NOT (score IN SELF)"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>You can use the <code class="highlighter-rouge">whereKey:matchesKey:inQuery:</code> method to get objects where a key matches the value of a key in a set of objects resulting from another query.  For example, if you have a class containing sports teams and you store a user’s hometown in the user class, you can issue one query to find the list of users whose hometown teams have winning records.  The query would look like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">teamQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Team"</span><span class="p">];</span>
<span class="p">[</span><span class="n">teamQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"winPct"</span> <span class="nf">greaterThan</span><span class="p">:</span><span class="err">@</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">userQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryForUser</span><span class="p">];</span>
<span class="p">[</span><span class="n">userQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"hometown"</span> <span class="nf">matchesKey</span><span class="p">:</span><span class="s">@"city"</span> <span class="nf">inQuery</span><span class="p">:</span><span class="n">teamQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">userQuery</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">results</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// results will contain users with a hometown team with a winning record
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">teamQuery</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Team"</span><span class="p">)</span>
<span class="n">teamQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"winPct"</span><span class="p">,</span> <span class="nv">greaterThan</span><span class="p">:</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">userQuery</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">userQuery</span><span class="o">!.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"hometown"</span><span class="p">,</span> <span class="nv">matchesKey</span><span class="p">:</span><span class="s">"city"</span><span class="p">,</span> <span class="nv">inQuery</span><span class="p">:</span><span class="n">teamQuery</span><span class="p">)</span>
<span class="n">userQuery</span><span class="o">!.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">results</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// results will contain users with a hometown team with a winning record</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Conversely, to get objects where a key does not match the value of a key in a set of objects resulting from another query, use <code class="highlighter-rouge">whereKey:doesNotMatchKey:inQuery:</code>.  For example, to find users whose hometown teams have losing records:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">losingUserQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryForUser</span><span class="p">];</span>
<span class="p">[</span><span class="n">losingUserQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"hometown"</span> <span class="nf">doesNotMatchKey</span><span class="p">:</span><span class="s">@"city"</span> <span class="nf">inQuery</span><span class="p">:</span><span class="n">teamQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">losingUserQuery</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">results</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// results will contain users with a hometown team with a losing record
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">losingUserQuery</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">losingUserQuery</span><span class="o">!.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"hometown"</span><span class="p">,</span> <span class="nv">doesNotMatchKey</span><span class="p">:</span><span class="s">"city"</span><span class="p">,</span> <span class="nv">inQuery</span><span class="p">:</span><span class="n">teamQuery</span><span class="p">)</span>
<span class="n">losingUserQuery</span><span class="o">!.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">results</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="c1">// results will contain users with a hometown team with a losing records</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can restrict the fields returned by calling <code class="highlighter-rouge">selectKeys:</code> with an <code class="highlighter-rouge">NSArray</code> of keys. To retrieve documents that contain only the <code class="highlighter-rouge">score</code> and <code class="highlighter-rouge">playerName</code> fields (and also special built-in fields such as <code class="highlighter-rouge">objectId</code>, <code class="highlighter-rouge">createdAt</code>, and <code class="highlighter-rouge">updatedAt</code>):</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">selectKeys</span><span class="p">:@[</span><span class="s">@"playerName"</span><span class="p">,</span> <span class="s">@"score"</span><span class="p">]];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">results</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// objects in results will only contain the playerName and score fields
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">selectKeys</span><span class="p">([</span><span class="s">"playerName"</span><span class="p">,</span> <span class="s">"score"</span><span class="p">])</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// objects in results will only contain the playerName and score fields</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The remaining fields can be fetched later by calling one of the <code class="highlighter-rouge">fetchIfNeeded</code> variants on the returned objects:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFObject</span><span class="o">*</span><span class="p">)</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">[</span><span class="n">object</span> <span class="nf">fetchIfNeededInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// all fields of the object will now be available here.
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">object</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="kt">PFObject</span><span class="o">!</span>
<span class="n">object</span><span class="o">.</span><span class="n">fetchIfNeededInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="c1">// all fields of the object will now be available here.</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="queries-on-array-values">Queries on Array Values</h2>

<p>For keys with an array type, you can find objects where the key’s array value contains 2 by:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find objects where the array in arrayKey contains 2.
// Using PFQuery
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"arrayKey"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="mi">@2</span><span class="p">];</span>

<span class="c1">// Or using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"2 IN arrayKey"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"MyClass"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find objects where the array in arrayKey contains 2.</span>
<span class="c1">// Using PFQuery</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"arrayKey"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">// Or using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"2 IN arrayKey"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"MyClass"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>You can also find objects where the key’s array value contains each of the values 2, 3, and 4 with the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find objects where the array in arrayKey contains each of the
// elements 2, 3, and 4.
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"arrayKey"</span> <span class="nf">containsAllObjectsInArray</span><span class="p">:@[</span><span class="mi">@2</span><span class="p">,</span> <span class="mi">@3</span><span class="p">,</span> <span class="mi">@4</span><span class="p">]];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find objects where the array in arrayKey contains each of the</span>
<span class="c1">// elements 2, 3, and 4.</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"arrayKey"</span><span class="p">,</span> <span class="nv">containsAllObjectsInArray</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre>
</div>

<h2 id="queries-on-string-values">Queries on String Values</h2>

<div class="tip info"><div>
If you're trying to implement a generic search feature, we recommend taking a look at this blog post: [Implementing Scalable Search on a NoSQL Backend](http://blog.parse.com/learn/engineering/implementing-scalable-search-on-a-nosql-backend/).
</div></div>

<p>Use <code class="highlighter-rouge">whereKey:hasPrefix:</code> to restrict to string values that start with a particular string. Similar to a MySQL LIKE operator, this is indexed so it is efficient for large datasets:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds barbecue sauces that start with "Big Daddy".
// Using PFQuery
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"BarbecueSauce"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"name"</span> <span class="nf">hasPrefix</span><span class="p">:</span><span class="s">@"Big Daddy's"</span><span class="p">];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"name BEGINSWITH 'Big Daddy"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"BarbecueSauce"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">pred</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Finds barbecue sauces that start with "Big Daddy".</span>
<span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="s">"BarbecueSauce"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"name"</span><span class="p">,</span> <span class="nv">hasPrefix</span><span class="p">:</span> <span class="s">"Big Daddy's"</span><span class="p">)</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">pred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"name BEGINSWITH 'Big Daddy"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"BarbecueSauce"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>
</code></pre>
</div>

<p>The above example will match any <code class="highlighter-rouge">BarbecueSauce</code> objects where the value in the “name” String key starts with “Big Daddy’s”. For example, both “Big Daddy’s” and “Big Daddy’s BBQ” will match, but “big daddy’s” or “BBQ Sauce: Big Daddy’s” will not.</p>

<p>Queries that have regular expression constraints are very expensive. Refer to the <a href="#performance-regular-expressions">Performance Guide</a> for more details.</p>

<h2 id="relational-queries">Relational Queries</h2>

<p>There are several ways to issue queries for relational data. If you want to retrieve objects where a field matches a particular <code class="highlighter-rouge">%{ParseObject}</code>, you can use <code class="highlighter-rouge">whereKey:equalTo:</code> just like for other data types. For example, if each <code class="highlighter-rouge">Comment</code> has a <code class="highlighter-rouge">Post</code> object in its <code class="highlighter-rouge">post</code> field, you can fetch comments for a particular <code class="highlighter-rouge">Post</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Assume PFObject *myPost was previously created.
// Using PFQuery
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"post"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="n">myPost</span><span class="p">];</span>

<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for myPost
</span><span class="p">}];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"post = %@"</span><span class="p">,</span> <span class="n">myPost</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">];</span>

<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for myPost
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Assume PFObject *myPost was previously created.</span>
<span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"post"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="n">myPost</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for myPost</span>
<span class="p">}</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"post = %@"</span><span class="p">,</span> <span class="n">myPost</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">predicate</span><span class="p">)</span>

<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for myPost</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can also do relational queries by <code class="highlighter-rouge">objectId</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"post"</span> <span class="nf">equalTo</span><span class="p">:[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"Post"</span> <span class="nf">objectId</span><span class="p">:</span><span class="s">@"1zEcyElZ80"</span><span class="p">]];</span>

<span class="c1">// Using NSPredicate
</span><span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"post = %@"</span><span class="p">,</span>
    <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"Post"</span> <span class="nf">objectId</span><span class="p">:</span><span class="s">@"1zEcyElZ80"</span><span class="p">]];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"post"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span> <span class="s">"1zEcyElZ80"</span><span class="p">))</span>

<span class="c1">// Using NSPredicate</span>
<span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"post = %@"</span><span class="p">,</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span> <span class="s">"1zEcyElZ80"</span><span class="p">))</span>
</code></pre>
</div>

<p>If you want to retrieve objects where a field contains a <code class="highlighter-rouge">%{ParseObject}</code> that match a different query, you can use <code class="highlighter-rouge">whereKey:matchesQuery</code>. Note that the default limit of 100 and maximum limit of 1000 apply to the inner query as well, so with large data sets you may need to construct queries carefully to get the desired behavior. In order to find comments for posts with images, you can do:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">innerQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="p">[</span><span class="n">innerQuery</span> <span class="nf">whereKeyExists</span><span class="p">:</span><span class="s">@"image"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"post"</span> <span class="nf">matchesQuery</span><span class="p">:</span><span class="n">innerQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for posts with images
</span><span class="p">}];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">innerPred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"image IN SELF"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">innerQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Post"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">innerPred</span><span class="p">];</span>

<span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"post IN %@"</span><span class="p">,</span> <span class="n">innerQuery</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">pred</span><span class="p">];</span>

<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for posts with images
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">innerQuery</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">)</span>
<span class="n">innerQuery</span><span class="o">.</span><span class="nf">whereKeyExists</span><span class="p">(</span><span class="s">"image"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"post"</span><span class="p">,</span> <span class="nv">matchesQuery</span><span class="p">:</span> <span class="n">innerQuery</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for posts with images</span>
<span class="p">}</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">innerPred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"image IN SELF"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">innerQuery</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">innerPred</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">pred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"post IN %@"</span><span class="p">,</span> <span class="n">innerQuery</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">pred</span><span class="p">)</span>

<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for posts with images</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If you want to retrieve objects where a field contains a <code class="highlighter-rouge">%{ParseObject}</code> that does not match a different query, you can use <code class="highlighter-rouge">whereKey:doesNotMatchQuery</code>.  In order to find comments for posts without images, you can do:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">innerQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="p">[</span><span class="n">innerQuery</span> <span class="nf">whereKeyExists</span><span class="p">:</span><span class="s">@"image"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"post"</span> <span class="nf">doesNotMatchQuery</span><span class="p">:</span><span class="n">innerQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for posts without images
</span><span class="p">}];</span>

<span class="c1">// Using NSPredicate
</span><span class="n">NSPredicate</span> <span class="o">*</span><span class="n">innerPred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"image IN SELF"</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">innerQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Post"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">innerPred</span><span class="p">];</span>

<span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"NOT (post IN %@)"</span><span class="p">,</span> <span class="n">innerQuery</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span> <span class="nf">predicate</span><span class="p">:</span><span class="n">pred</span><span class="p">];</span>

<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// comments now contains the comments for posts without images
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Using PFQuery</span>
<span class="k">let</span> <span class="nv">innerQuery</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">)</span>
<span class="n">innerQuery</span><span class="o">.</span><span class="nf">whereKeyExists</span><span class="p">(</span><span class="s">"image"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"post"</span><span class="p">,</span> <span class="nv">doesNotMatchQuery</span><span class="p">:</span> <span class="n">innerQuery</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for posts with images</span>
<span class="p">}</span>

<span class="c1">// Using NSPredicate</span>
<span class="k">let</span> <span class="nv">innerPred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"image IN SELF"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">innerQuery</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Post"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">innerPred</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">pred</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"NOT (post IN %@)"</span><span class="p">,</span> <span class="n">innerQuery</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Comment"</span><span class="p">,</span> <span class="nv">predicate</span><span class="p">:</span> <span class="n">pred</span><span class="p">)</span>

<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="c1">// comments now contains the comments for posts with images</span>
<span class="p">}</span>
</code></pre>
</div>

<p>In some situations, you want to return multiple types of related objects in one query. You can do this with the <code class="highlighter-rouge">includeKey:</code> method. For example, let’s say you are retrieving the last ten comments, and you want to retrieve their related posts at the same time:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Comment"</span><span class="p">];</span>

<span class="c1">// Retrieve the most recent ones
</span><span class="p">[</span><span class="n">query</span> <span class="nf">orderByDescending</span><span class="p">:</span><span class="s">@"createdAt"</span><span class="p">];</span>

<span class="c1">// Only retrieve the last ten
</span><span class="n">query</span><span class="p">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// Include the post data with each comment
</span><span class="p">[</span><span class="n">query</span> <span class="nf">includeKey</span><span class="p">:</span><span class="s">@"post"</span><span class="p">];</span>

<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">comments</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Comments now contains the last ten comments, and the "post" field
</span>    <span class="c1">// has been populated. For example:
</span>    <span class="k">for</span> <span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">comment</span> <span class="k">in</span> <span class="n">comments</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">// This does not require a network access.
</span>         <span class="n">PFObject</span> <span class="o">*</span><span class="n">post</span> <span class="o">=</span> <span class="n">comment</span><span class="p">[</span><span class="s">@"post"</span><span class="p">]</span><span class="err">;</span>
         <span class="n">NSLog</span><span class="p">(</span><span class="s">@"retrieved related post: %@"</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Comment"</span><span class="p">)</span>

<span class="c1">// Retrieve the most recent ones</span>
<span class="n">query</span><span class="o">.</span><span class="nf">orderByDescending</span><span class="p">(</span><span class="s">"createdAt"</span><span class="p">)</span>

<span class="c1">// Only retrieve the last ten</span>
<span class="n">query</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1">// Include the post data with each comment</span>
<span class="n">query</span><span class="o">.</span><span class="nf">includeKey</span><span class="p">(</span><span class="s">"post"</span><span class="p">)</span>

<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">comments</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>

  <span class="c1">// Comments now contains the last ten comments, and the "post" field</span>
  <span class="c1">// has been populated. For example:</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">comments</span> <span class="o">=</span> <span class="n">comments</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]</span> <span class="p">{</span>
      <span class="k">for</span> <span class="n">comment</span> <span class="k">in</span> <span class="n">comments</span> <span class="p">{</span>
          <span class="c1">// This does not require a network access.</span>
          <span class="k">var</span> <span class="nv">post</span> <span class="o">=</span> <span class="n">comment</span><span class="p">[</span><span class="s">"post"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">PFObject</span>
          <span class="nf">print</span><span class="p">(</span><span class="s">"retrieved related post: </span><span class="se">\(</span><span class="n">post</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can also do multi level includes using dot notation.  If you wanted to include the post for a comment and the post’s author as well you can do:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">query</span> <span class="nf">includeKey</span><span class="p">:</span><span class="s">@"post.author"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="nf">includeKey</span><span class="p">(</span><span class="s">"post.author"</span><span class="p">)</span>
</code></pre>
</div>

<p>You can issue a query with multiple fields included by calling <code class="highlighter-rouge">includeKey:</code> multiple times. This functionality also works with PFQuery helpers like <code class="highlighter-rouge">getFirstObject</code> and <code class="highlighter-rouge">getObjectInBackground</code></p>

<h2 id="querying-the-local-datastore">Querying the Local Datastore</h2>

<p>If you have enabled the local datastore by calling <code class="highlighter-rouge">[Parse enableLocalDatastore]</code> before your call to <code class="highlighter-rouge">[Parse setApplicationId:clientKey:]</code>, then you can also query against the objects stored locally on the device. To do this, call the <code class="highlighter-rouge">fromLocalDatastore</code> method on the query.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">query</span> <span class="nf">fromLocalDatastore</span><span class="p">];</span>
<span class="p">[[</span><span class="n">query</span> <span class="nf">findObjectsInBackground</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// There was an error.
</span>    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="c1">// Results were successfully found from the local datastore.
</span>  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="nf">fromLocalDatastore</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">findObjectsInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">task</span><span class="p">?</span><span class="o">.</span><span class="n">error</span> <span class="p">{</span>
      <span class="c1">// There was an error.</span>
      <span class="k">return</span> <span class="n">task</span>
  <span class="p">}</span>

  <span class="c1">// Results were successfully found from the local datastore.</span>

  <span class="k">return</span> <span class="n">task</span>
<span class="p">})</span>
</code></pre>
</div>

<p>You can query from the local datastore using exactly the same kinds of queries you use over the network. The results will include every object that matches the query that’s been pinned to your device. The query even takes into account any changes you’ve made to the object that haven’t yet been saved to the cloud. For example, if you call <code class="highlighter-rouge">deleteEventually</code>, on an object, it will no longer be returned from these queries.</p>

<h2 id="caching-queries">Caching Queries</h2>

<p>It’s often useful to cache the result of a query on disk. This lets you show data when the user’s device is offline, or when the app has just started and network requests have not yet had time to complete. Parse takes care of automatically flushing the cache when it takes up too much space.</p>

<p>The default query behavior doesn’t use the cache, but you can enable caching by setting <code class="highlighter-rouge">query.cachePolicy</code>. For example, to try the network and then fall back to cached data if the network is not available:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="n">query</span><span class="p">.</span><span class="n">cachePolicy</span> <span class="o">=</span> <span class="n">kPFCachePolicyNetworkElseCache</span><span class="p">;</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Results were successfully found, looking first on the
</span>    <span class="c1">// network and then on disk.
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The network was inaccessible and we have no cached data for
</span>    <span class="c1">// this query.
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">cachePolicy</span> <span class="o">=</span> <span class="o">.</span><span class="kt">CacheElseNetwork</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// Results were successfully found, looking first on the</span>
    <span class="c1">// network and then on disk.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The network was inaccessible and we have no cached data for</span>
    <span class="c1">// this query.</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Parse provides several different cache policies:</p>

<ul>
  <li><code class="highlighter-rouge">IgnoreCache</code>: The query does not load from the cache or save results to the cache. <code class="highlighter-rouge">IgnoreCache</code> is the default cache policy.</li>
  <li><code class="highlighter-rouge">CacheOnly</code>: The query only loads from the cache, ignoring the network. If there are no cached results, that causes a <code class="highlighter-rouge">PFError</code>.</li>
  <li><code class="highlighter-rouge">NetworkOnly</code>: The query does not load from the cache, but it will save results to the cache.</li>
  <li><code class="highlighter-rouge">CacheElseNetwork</code>: The query first tries to load from the cache, but if that fails, it loads results from the network. If neither cache nor network succeed, there is a <code class="highlighter-rouge">PFError</code>.</li>
  <li><code class="highlighter-rouge">NetworkElseCache</code>:  The query first tries to load from the network, but if that fails, it loads results from the cache. If neither network nor cache succeed, there is a <code class="highlighter-rouge">PFError</code>.</li>
  <li><code class="highlighter-rouge">CacheThenNetwork</code>: The query first loads from the cache, then loads from the network. In this case, the callback will actually be called twice - first with the cached results, then with the network results. Since it returns two results at different times, this cache policy cannot be used synchronously with <code class="highlighter-rouge">findObjects</code>.</li>
</ul>

<p>If you need to control the cache’s behavior, you can use methods provided in PFQuery to interact with the cache.  You can do the following operations on the cache:</p>

<ul>
  <li>Check to see if there is a cached result for the query with:
<code class="highlighter-rouge">objc
BOOL isInCache = [query hasCachedResult];
</code>
<code class="highlighter-rouge">swift
let isInCache = query.hasCachedResult()
</code></li>
  <li>Remove any cached results for a query with:
<code class="highlighter-rouge">objc
[query clearCachedResult];
</code>
<code class="highlighter-rouge">swift
query.clearCachedResult()
</code></li>
  <li>Remove cached results for queries with:
<code class="highlighter-rouge">objc
[PFQuery clearAllCachedResults];
</code>
<code class="highlighter-rouge">swift
PFQuery.clearAllCachedResults()
</code></li>
</ul>

<p>Query caching also works with PFQuery helpers including <code class="highlighter-rouge">getFirstObject</code> and <code class="highlighter-rouge">getObjectInBackground</code>.</p>

<h2 id="counting-objects">Counting Objects</h2>

<p>Caveat: Count queries are rate limited to a maximum of 160 requests per minute.  They can also return inaccurate results for classes with more than 1,000 objects.  Thus, it is preferable to architect your application to avoid this sort of count operation (by using counters, for example.)</p>

<p>If you just need to count how many objects match a query, but you do not need to retrieve the objects that match, you can use <code class="highlighter-rouge">countObjects</code> instead of <code class="highlighter-rouge">findObjects</code>. For example, to count how many games have been played by a particular player:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playername"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"Sean Plott"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">countObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The count request succeeded. Log the count
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Sean has played %d games"</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The request failed
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span><span class="s">"Sean Plott"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">countObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">count</span><span class="p">:</span> <span class="kt">Int32</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Sean has played </span><span class="se">\(</span><span class="n">count</span><span class="se">)</span><span class="s"> games"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If you want to block the calling thread, you can also use the synchronous <code class="highlighter-rouge">countObjects</code> method.</p>

<h2 id="compound-queries">Compound Queries</h2>

<p>If you want to find objects that match one of several queries, you can use <code class="highlighter-rouge">orQueryWithSubqueries:</code> method.  For instance, if you want to find players with either have a lot of wins or a few wins, you can do:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">lotsOfWins</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Player"</span><span class="p">];</span>
<span class="p">[</span><span class="n">lotsOfWins</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">greaterThan</span><span class="p">:</span><span class="mi">@150</span><span class="p">];</span>

<span class="n">PFQuery</span> <span class="o">*</span><span class="n">fewWins</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Player"</span><span class="p">];</span>
<span class="p">[</span><span class="n">fewWins</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"wins"</span> <span class="nf">lessThan</span><span class="p">:</span><span class="mi">@5</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">orQueryWithSubqueries</span><span class="p">:@[</span><span class="n">fewWins</span><span class="p">,</span><span class="n">lotsOfWins</span><span class="p">]];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">results</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// results contains players with lots of wins or only a few wins.
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">lotsOfWins</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Player"</span><span class="p">)</span>
<span class="n">lotsOfWins</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">greaterThan</span><span class="p">:</span><span class="mi">150</span><span class="p">)</span>

<span class="k">var</span> <span class="nv">fewWins</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Player"</span><span class="p">)</span>
<span class="n">fewWins</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"wins"</span><span class="p">,</span> <span class="nv">lessThan</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>

<span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="o">.</span><span class="nf">orQueryWithSubqueries</span><span class="p">([</span><span class="n">lotsOfWins</span><span class="p">,</span> <span class="n">fewWins</span><span class="p">])</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">results</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// results contains players with lots of wins or only a few wins.</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can add additional constraints to the newly created <code class="highlighter-rouge">%{ParseQuery}</code> that act as an ‘and’ operator.</p>

<p>Note that we do not, however, support GeoPoint or non-filtering constraints (e.g. <code class="highlighter-rouge">nearGeoPoint</code>, <code class="highlighter-rouge">withinGeoBox...:</code>, <code class="highlighter-rouge">limit</code>, <code class="highlighter-rouge">skip</code>, <code class="highlighter-rouge">orderBy...:</code>, <code class="highlighter-rouge">includeKey:</code>) in the subqueries of the compound query.</p>

<h2 id="subclass-queries">Subclass Queries</h2>

<p>You can get a query for objects of a particular subclass using the class method <code class="highlighter-rouge">query</code>. The following example queries for armors that the user can afford:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">Armor</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"rupees"</span> <span class="nf">lessThanOrEqualTo</span><span class="p">:[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">][</span><span class="s">@"rupees"</span><span class="p">]];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">findObjectsInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">objects</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Armor</span> <span class="o">*</span><span class="n">firstArmor</span> <span class="o">=</span> <span class="p">[</span><span class="n">objects</span> <span class="nf">firstObject</span><span class="p">]</span><span class="err">;</span>
    <span class="c1">// ...
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Armor</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"rupees"</span><span class="p">,</span> <span class="nv">lessThanOrEqualTo</span><span class="p">:</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()[</span><span class="s">"rupees"</span><span class="p">])</span>
<span class="n">query</span><span class="o">.</span><span class="n">findObjectsInBackgroundWithBlock</span> <span class="p">{</span> <span class="p">(</span><span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">PFObject</span><span class="p">]?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">objects</span> <span class="o">=</span> <span class="n">objects</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">Armor</span><span class="p">],</span> <span class="n">firstArmor</span> <span class="o">=</span> <span class="n">objects</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
      <span class="c1">//...</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="users">Users</h1>

<p>At the core of many apps, there is a notion of user accounts that lets users access their information in a secure manner. We provide a specialized user class called <code class="highlighter-rouge">%{ParseUser}</code> that automatically handles much of the functionality required for user account management.</p>

<p>With this class, you’ll be able to add user account functionality in your app.</p>

<p><code class="highlighter-rouge">%{ParseUser}</code> is a subclass of <code class="highlighter-rouge">%{ParseObject}</code> and has all the same features, such as flexible schema, automatic persistence, and a key value interface. All the methods that are on <code class="highlighter-rouge">%{ParseObject}</code> also exist in <code class="highlighter-rouge">%{ParseUser}</code>. The difference is that PFUser has some special additions specific to user accounts.</p>

<h2 id="properties">Properties</h2>

<p><code class="highlighter-rouge">%{ParseUser}</code> has several properties that set it apart from <code class="highlighter-rouge">%{ParseObject}</code>:</p>

<ul>
  <li><strong>username</strong>: The username for the user (required).</li>
  <li><strong>password</strong>: The password for the user (required on signup).</li>
  <li><strong>email</strong>: The email address for the user (optional).</li>
</ul>

<p>We’ll go through each of these in detail as we run through the various use cases for users. Keep in mind that if you set <code class="highlighter-rouge">username</code> and <code class="highlighter-rouge">email</code> through these properties, you do not need to set it using the <code class="highlighter-rouge">setObject:forKey:</code> method — this is set for you automatically.</p>

<h2 id="signing-up">Signing Up</h2>

<p>The first thing your app will do is probably ask the user to sign up. The following code illustrates a typical sign up:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">myMethod</span> <span class="p">{</span>
    <span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">user</span><span class="p">];</span>
    <span class="n">user</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">@"my name"</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">password</span> <span class="o">=</span> <span class="s">@"my pass"</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">email</span> <span class="o">=</span> <span class="s">@"email@example.com"</span><span class="p">;</span>

    <span class="c1">// other fields can be set just like with PFObject
</span>    <span class="n">user</span><span class="p">[</span><span class="s">@"phone"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"415-392-0202"</span><span class="p">;</span>

    <span class="p">[</span><span class="n">user</span> <span class="nf">signUpInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// Hooray! Let them use the app now.
</span>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>   <span class="n">NSString</span> <span class="o">*</span><span class="n">errorString</span> <span class="o">=</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">][</span><span class="s">@"error"</span><span class="p">]</span><span class="err">;</span>   <span class="c1">// Show the errorString somewhere and let the user try again.
</span>      <span class="p">}</span>
    <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">myMethod</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="p">()</span>
  <span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">"myUsername"</span>
  <span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s">"myPassword"</span>
  <span class="n">user</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="s">"email@example.com"</span>
  <span class="c1">// other fields can be set just like with PFObject</span>
  <span class="n">user</span><span class="p">[</span><span class="s">"phone"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"415-392-0202"</span>

  <span class="n">user</span><span class="o">.</span><span class="n">signUpInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
      <span class="k">let</span> <span class="nv">errorString</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">userInfo</span><span class="p">[</span><span class="s">"error"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
      <span class="c1">// Show the errorString somewhere and let the user try again.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// Hooray! Let them use the app now.</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This call will asynchronously create a new user in your Parse App. Before it does this, it also checks to make sure that both the username and email are unique. Also, it securely hashes the password in the cloud using bcrypt. We never store passwords in plaintext, nor will we ever transmit passwords back to the client in plaintext.</p>

<p>Note that we used the <code class="highlighter-rouge">signUp</code> method, not the <code class="highlighter-rouge">save</code> method. New <code class="highlighter-rouge">%{ParseUser}</code>s should always be created using the <code class="highlighter-rouge">signUp</code> method. Subsequent updates to a user can be done by calling <code class="highlighter-rouge">save</code>.</p>

<p>The <code class="highlighter-rouge">signUp</code> method comes in various flavors, with the ability to pass back errors, and also synchronous versions. As usual, we highly recommend using the asynchronous versions when possible, so as not to block the UI in your app. You can read more about these specific methods in our <a href="/docs/ios/">API docs</a>.</p>

<p>If a signup isn’t successful, you should read the error object that is returned. The most likely case is that the username or email has already been taken by another user. You should clearly communicate this to your users, and ask them try a different username.</p>

<p>You are free to use an email address as the username. Simply ask your users to enter their email, but fill it in the username property — <code class="highlighter-rouge">%{ParseUser}</code> will work as normal. We’ll go over how this is handled in the reset password section.</p>

<h2 id="logging-in">Logging In</h2>

<p>Of course, after you allow users to sign up, you need to let them log in to their account in the future. To do this, you can use the class method <code class="highlighter-rouge">logInWithUsernameInBackground:password:</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFUser</span> <span class="nf">logInWithUsernameInBackground</span><span class="p">:</span><span class="s">@"myname"</span> <span class="nf">password</span><span class="p">:</span><span class="s">@"mypass"</span>
  <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Do stuff after successful login.
</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// The login failed. Check error to see why.
</span>    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFUser</span><span class="o">.</span><span class="nf">logInWithUsernameInBackground</span><span class="p">(</span><span class="s">"myname"</span><span class="p">,</span> <span class="nv">password</span><span class="p">:</span><span class="s">"mypass"</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">user</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// Do stuff after successful login.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The login failed. Check error to see why.</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="verifying-emails">Verifying Emails</h2>

<p>Enabling email verification in an application’s settings allows the application to reserve part of its experience for users with confirmed email addresses. Email verification adds the <code class="highlighter-rouge">emailVerified</code> key to the <code class="highlighter-rouge">%{ParseUser}</code> object. When a <code class="highlighter-rouge">%{ParseUser}</code>’s <code class="highlighter-rouge">email</code> is set or modified, <code class="highlighter-rouge">emailVerified</code> is set to <code class="highlighter-rouge">false</code>. Parse then emails the user a link which will set <code class="highlighter-rouge">emailVerified</code> to <code class="highlighter-rouge">true</code>.</p>

<p>There are three <code class="highlighter-rouge">emailVerified</code> states to consider:</p>

<ol>
  <li><code class="highlighter-rouge">true</code> - the user confirmed his or her email address by clicking on the link Parse emailed them. <code class="highlighter-rouge">PFUsers</code> can never have a <code class="highlighter-rouge">true</code> value when the user account is first created.</li>
  <li><code class="highlighter-rouge">false</code> - at the time the <code class="highlighter-rouge">%{ParseUser}</code> object was last refreshed, the user had not confirmed his or her email address. If <code class="highlighter-rouge">emailVerified</code> is <code class="highlighter-rouge">false</code>, consider calling <code class="highlighter-rouge">refresh:</code> on the <code class="highlighter-rouge">%{ParseUser}</code>.</li>
  <li><strong>missing</strong> - the <code class="highlighter-rouge">%{ParseUser}</code> was created when email verification was off or the <code class="highlighter-rouge">%{ParseUser}</code> does not have an <code class="highlighter-rouge">email</code>.</li>
</ol>

<h2 id="current-user">Current User</h2>

<p>It would be bothersome if the user had to log in every time they open your app. You can avoid this by using the cached <code class="highlighter-rouge">currentUser</code> object.</p>

<p>Whenever you use any signup or login methods, the user is cached on disk. You can treat this cache as a session, and automatically assume the user is logged in:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFUser</span> <span class="o">*</span><span class="n">currentUser</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="n">currentUser</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do stuff with the user
</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// show the signup or login screen
</span><span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">currentUser</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span>
<span class="k">if</span> <span class="n">currentUser</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
  <span class="c1">// Do stuff with the user</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// Show the signup or login screen</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can clear the current user by logging them out:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFUser</span> <span class="nf">logOut</span><span class="p">];</span>
<span class="n">PFUser</span> <span class="o">*</span><span class="n">currentUser</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">];</span> <span class="c1">// this will now be nil
</span></code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFUser</span><span class="o">.</span><span class="nf">logOut</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">currentUser</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span> <span class="c1">// this will now be nil</span>
</code></pre>
</div>

<h2 id="anonymous-users">Anonymous Users</h2>

<p>Being able to associate data and objects with individual users is highly valuable, but sometimes you want to be able to do this without forcing a user to specify a username and password.</p>

<p>An anonymous user is a user that can be created without a username and password but still has all of the same capabilities as any other <code class="highlighter-rouge">%{ParseUser}</code>. After logging out, an anonymous user is abandoned, and its data is no longer accessible.</p>

<p>You can create an anonymous user using <code class="highlighter-rouge">PFAnonymousUtils</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFAnonymousUtils</span> <span class="nf">logInWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Anonymous login failed."</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Anonymous user logged in."</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFAnonymousUtils</span><span class="o">.</span><span class="n">logInWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="o">||</span> <span class="n">user</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Anonymous login failed."</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Anonymous user logged in."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can convert an anonymous user into a regular user by setting the username and password, then calling <code class="highlighter-rouge">signUp</code>, or by logging in or linking with a service like <a href="#fbusers">Facebook</a> or <a href="#twitterusers">Twitter</a>. The converted user will retain all of its data.  To determine whether the current user is an anonymous user, you can check <code class="highlighter-rouge">PFAnonymousUtils isLinkedWithUser</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="p">([</span><span class="n">PFAnonymousUtils</span> <span class="nf">isLinkedWithUser</span><span class="p">:[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]])</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">enableSignUpButton</span><span class="p">];</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">enableLogOutButton</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="kt">PFAnonymousUtils</span><span class="o">.</span><span class="nf">isLinkedWithUser</span><span class="p">(</span><span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">())</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">enableSignUpButton</span><span class="p">()</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">enableLogOutButton</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Anonymous users can also be automatically created for you without requiring a network request, so that you can begin working with your user immediately when your application starts.  When you enable automatic anonymous user creation at application startup, <code class="highlighter-rouge">[PFUser currentUser]</code> will never be <code class="highlighter-rouge">nil</code>. The user will automatically be created in the cloud the first time the user or any object with a relation to the user is saved.  Until that point, the user’s object ID will be <code class="highlighter-rouge">nil</code>.  Enabling automatic user creation makes associating data with your users painless.  For example, in your <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code> function, you might write:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFUser</span> <span class="nf">enableAutomaticUser</span><span class="p">];</span>
<span class="p">[[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]</span> <span class="nf">incrementKey</span><span class="p">:</span><span class="s">@"RunCount"</span><span class="p">];</span>
<span class="p">[[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFUser</span><span class="o">.</span><span class="nf">enableAutomaticUser</span><span class="p">()</span>
<span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="nf">incrementKey</span><span class="p">(</span><span class="s">"RunCount"</span><span class="p">)</span>
<span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="setting-the-current-user">Setting the Current User</h2>

<p>If you’ve created your own authentication routines, or otherwise logged in a user on the server side, you can now pass the session token to the client and use the <code class="highlighter-rouge">become</code> method. This method will ensure the session token is valid before setting the current user.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFUser</span> <span class="nf">becomeInBackground</span><span class="p">:</span><span class="s">@"session-token-here"</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The token could not be validated.
</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The current user is now set to user.
</span>  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFUser</span><span class="o">.</span><span class="nf">becomeInBackground</span><span class="p">(</span><span class="s">"session-token-here"</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// The token could not be validated.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// The current user is now set to user.</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h2 id="security-for-user-objects">Security For User Objects</h2>

<p>The <code class="highlighter-rouge">%{ParseUser}</code> class is secured by default. Data stored in a <code class="highlighter-rouge">%{ParseUser}</code> can only be modified by that user. By default, the data can still be read by any client. Thus, some <code class="highlighter-rouge">%{ParseUser}</code> objects are authenticated and can be modified, whereas others are read-only.</p>

<p>Specifically, you are not able to invoke any of the <code class="highlighter-rouge">save</code> or <code class="highlighter-rouge">delete</code> methods unless the <code class="highlighter-rouge">%{ParseUser}</code> was obtained using an authenticated method, like <code class="highlighter-rouge">logIn</code> or <code class="highlighter-rouge">signUp</code>. This ensures that only the user can alter their own data.</p>

<p>The following illustrates this security policy:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">logInWithUsername</span><span class="p">:</span><span class="s">@"my_username"</span> <span class="nf">password</span><span class="p">:</span><span class="s">@"my_password"</span><span class="p">];</span>
<span class="n">user</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">"my_new_username"</span><span class="p">;</span> <span class="c1">// attempt to change username
</span><span class="p">[</span><span class="n">user</span> <span class="nf">save</span><span class="p">];</span> <span class="c1">// This succeeds, since the user was authenticated on the device
</span>
<span class="c1">// Get the user from a non-authenticated method
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">query</span><span class="p">];</span>
<span class="n">PFUser</span> <span class="o">*</span><span class="n">userAgain</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="p">)[</span><span class="n">query</span> <span class="nf">getObjectWithId</span><span class="p">:</span><span class="n">user</span><span class="p">.</span><span class="n">objectId</span><span class="p">];</span>

<span class="n">userAgain</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">"another_username"</span><span class="p">;</span>

<span class="c1">// This will throw an exception, since the PFUser is not authenticated
</span><span class="p">[</span><span class="n">userAgain</span> <span class="nf">save</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">logInWithUsername</span><span class="p">(</span><span class="s">"my_username"</span><span class="p">,</span> <span class="nv">password</span><span class="p">:</span><span class="s">"my_password"</span><span class="p">)</span>
<span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">"my_new_username"</span> <span class="c1">// attempt to change username</span>
<span class="n">user</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span> <span class="c1">// This succeeds, since the user was authenticated on the device</span>

<span class="c1">// Get the user from a non-authenticated method</span>
<span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">userAgain</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">getObjectWithId</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">objectId</span><span class="p">)</span> <span class="k">as</span> <span class="kt">PFUser</span>

<span class="n">userAgain</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">"another_username"</span>

<span class="c1">// This will crash, since the PFUser is not authenticated</span>
<span class="n">userAgain</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">%{ParseUser}</code> obtained from <code class="highlighter-rouge">currentUser</code> will always be authenticated.</p>

<p>If you need to check if a <code class="highlighter-rouge">%{ParseUser}</code> is authenticated, you can invoke the <code class="highlighter-rouge">isAuthenticated</code> method. You do not need to check <code class="highlighter-rouge">isAuthenticated</code> with <code class="highlighter-rouge">%{ParseUser}</code> objects that are obtained via an authenticated method.</p>

<h2 id="security-for-other-objects">Security For Other Objects</h2>

<p>The same security model that applies to the <code class="highlighter-rouge">%{ParseUser}</code> can be applied to other objects. For any object, you can specify which users are allowed to read the object, and which users are allowed to modify an object. To support this type of security, each object has an <a href="http://en.wikipedia.org/wiki/Access_control_list">access control list</a>, implemented by the <code class="highlighter-rouge">PFACL</code> class.</p>

<p>The simplest way to use a <code class="highlighter-rouge">PFACL</code> is to specify that an object may only be read or written by a single user. To create such an object, there must first be a logged in <code class="highlighter-rouge">%{ParseUser}</code>. Then, the <code class="highlighter-rouge">ACLWithUser</code> method generates a <code class="highlighter-rouge">PFACL</code> that limits access to that user. An object’s ACL is updated when the object is saved, like any other property. Thus, to create a private note that can only be accessed by the current user:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">privateNote</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Note"</span><span class="p">];</span>
<span class="n">privateNote</span><span class="p">[</span><span class="s">@"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"This note is private!"</span><span class="p">;</span>
<span class="n">privateNote</span><span class="p">.</span><span class="n">ACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACLWithUser</span><span class="p">:[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]];</span>
<span class="p">[</span><span class="n">privateNote</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">privateNote</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Note"</span><span class="p">)</span>
<span class="n">privateNote</span><span class="p">[</span><span class="s">"content"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"This note is private!"</span>
<span class="n">privateNote</span><span class="o">.</span><span class="kt">ACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACLWithUser</span><span class="p">(</span><span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">())</span>
<span class="n">privateNote</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>This note will then only be accessible to the current user, although it will be accessible to any device where that user is signed in. This functionality is useful for applications where you want to enable access to user data across multiple devices, like a personal todo list.</p>

<p>Permissions can also be granted on a per-user basis. You can add permissions individually to a <code class="highlighter-rouge">PFACL</code> using <code class="highlighter-rouge">setReadAccess:forUser:</code> and <code class="highlighter-rouge">setWriteAccess:forUser:</code>. For example, let’s say you have a message that will be sent to a group of several users, where each of them have the rights to read and delete that message:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">groupMessage</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Message"</span><span class="p">];</span>
<span class="n">PFACL</span> <span class="o">*</span><span class="n">groupACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>

<span class="c1">// userList is an NSArray with the users we are sending this message to.
</span><span class="k">for</span> <span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="k">in</span> <span class="n">userList</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">groupACL</span> <span class="nf">setReadAccess</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">forUser</span><span class="p">:</span><span class="n">user</span><span class="p">];</span>
    <span class="p">[</span><span class="n">groupACL</span> <span class="nf">setWriteAccess</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">forUser</span><span class="p">:</span><span class="n">user</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">groupMessage</span><span class="p">.</span><span class="n">ACL</span> <span class="o">=</span> <span class="n">groupACL</span><span class="p">;</span>
<span class="p">[</span><span class="n">groupMessage</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">groupMessage</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Message"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">groupACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>

<span class="c1">// userList is an NSArray with the users we are sending this message to.</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">user</span> <span class="p">:</span> <span class="kt">PFUser</span> <span class="k">in</span> <span class="n">userList</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">groupACL</span><span class="o">.</span><span class="nf">setReadAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">forUser</span><span class="p">:</span><span class="n">user</span><span class="p">)</span>
    <span class="n">groupACL</span><span class="o">.</span><span class="nf">setWriteAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">forUser</span><span class="p">:</span><span class="n">user</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">groupMessage</span><span class="o">.</span><span class="kt">ACL</span> <span class="o">=</span> <span class="n">groupACL</span>
<span class="n">groupMessage</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>You can also grant permissions to all users at once using <code class="highlighter-rouge">setPublicReadAccess:</code> and <code class="highlighter-rouge">setPublicWriteAccess:</code>. This allows patterns like posting comments on a message board. For example, to create a post that can only be edited by its author, but can be read by anyone:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">publicPost</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="n">PFACL</span> <span class="o">*</span><span class="n">postACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACLWithUser</span><span class="p">:[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]];</span>
<span class="p">[</span><span class="n">postACL</span> <span class="nf">setPublicReadAccess</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="n">publicPost</span><span class="p">.</span><span class="n">ACL</span> <span class="o">=</span> <span class="n">postACL</span><span class="p">;</span>
<span class="p">[</span><span class="n">publicPost</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">publicPost</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Post"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">postACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACLWithUser</span><span class="p">(</span><span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">())</span>
<span class="n">postACL</span><span class="o">.</span><span class="nf">setPublicReadAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="n">publicPost</span><span class="o">.</span><span class="kt">ACL</span> <span class="o">=</span> <span class="n">postACL</span>
<span class="n">publicPost</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>To help ensure that your users’ data is secure by default, you can set a default ACL to be applied to all newly-created <code class="highlighter-rouge">PFObjects</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFACL</span> <span class="nf">setDefaultACL</span><span class="p">:</span><span class="n">defaultACL</span> <span class="nf">withAccessForCurrentUser</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFACL</span><span class="o">.</span><span class="nf">setDefaultACL</span><span class="p">(</span><span class="n">defaultACL</span><span class="p">,</span> <span class="nv">withAccessForCurrentUser</span><span class="p">:</span><span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<p>In the code above, the second parameter to setDefaultACL tells Parse to ensure that the default ACL assigned at the time of object creation allows read and write access to the current user at that time.  Without this setting, you would need to reset the defaultACL every time a user logs in or out so that the current user would be granted access appropriately.  With this setting, you can ignore changes to the current user until you explicitly need to grant different kinds of access.</p>

<p>Default ACLs make it easy to create apps that follow common access patterns. An application like Twitter, for example, where user content is generally visible to the world, might set a default ACL such as:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFACL</span> <span class="o">*</span><span class="n">defaultACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>
<span class="p">[</span><span class="n">defaultACL</span> <span class="nf">setPublicReadAccess</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="p">[</span><span class="n">PFACL</span> <span class="nf">setDefaultACL</span><span class="p">:</span><span class="n">defaultACL</span> <span class="nf">withAccessForCurrentUser</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">defaultACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>
<span class="n">defaultACL</span><span class="o">.</span><span class="nf">setPublicReadAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="kt">PFACL</span><span class="o">.</span><span class="nf">setDefaultACL</span><span class="p">(</span><span class="n">defaultACL</span><span class="p">,</span> <span class="nv">withAccessForCurrentUser</span><span class="p">:</span><span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<p>For an app like Dropbox, where a user’s data is only accessible by the user itself unless explicit permission is given, you would provide a default ACL where only the current user is given access:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFACL</span> <span class="nf">setDefaultACL</span><span class="p">:[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">]</span> <span class="nf">withAccessForCurrentUser</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFACL</span><span class="o">.</span><span class="nf">setDefaultACL</span><span class="p">(</span><span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">(),</span> <span class="nv">withAccessForCurrentUser</span><span class="p">:</span><span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<p>For an application that logs data to Parse but doesn’t provide any user access to that data, you would deny access to the current user while providing a restrictive ACL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFACL</span> <span class="nf">setDefaultACL</span><span class="p">:[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">]</span> <span class="nf">withAccessForCurrentUser</span><span class="p">:</span><span class="nb">NO</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFACL</span><span class="o">.</span><span class="nf">setDefaultACL</span><span class="p">(</span><span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">(),</span> <span class="nv">withAccessForCurrentUser</span><span class="p">:</span><span class="kc">false</span><span class="p">)</span>
</code></pre>
</div>

<p>Operations that are forbidden, such as deleting an object that you do not have write access to, result in a <code class="highlighter-rouge">kPFErrorObjectNotFound</code> error code. For security purposes, this prevents clients from distinguishing which object ids exist but are secured, versus which object ids do not exist at all.</p>

<h2 id="resetting-passwords">Resetting Passwords</h2>

<p>It’s a fact that as soon as you introduce passwords into a system, users will forget them. In such cases, our library provides a way to let them securely reset their password.</p>

<p>To kick off the password reset flow, ask the user for their email address, and call:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFUser</span> <span class="nf">requestPasswordResetForEmailInBackground</span><span class="p">:</span><span class="s">@"email@example.com"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFUser</span><span class="o">.</span><span class="nf">requestPasswordResetForEmailInBackground</span><span class="p">(</span><span class="s">"email@example.com"</span><span class="p">)</span>
</code></pre>
</div>

<p>This will attempt to match the given email with the user’s email or username field, and will send them a password reset email. By doing this, you can opt to have users use their email as their username, or you can collect it separately and store it in the email field.</p>

<p>The flow for password reset is as follows:</p>

<ol>
  <li>User requests that their password be reset by typing in their email.</li>
  <li>Parse sends an email to their address, with a special password reset link.</li>
  <li>User clicks on the reset link, and is directed to a special Parse page that will allow them type in a new password.</li>
  <li>User types in a new password. Their password has now been reset to a value they specify.</li>
</ol>

<p>Note that the messaging in this flow will reference your app by the name that you specified when you created this app on Parse.</p>

<h2 id="querying">Querying</h2>

<p>To query for users, you need to use the special user query:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"gender"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"female"</span><span class="p">];</span> <span class="c1">// find all the women
</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">girls</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"gender"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span><span class="s">"female"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">girls</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">findObjects</span><span class="p">()</span>
</code></pre>
</div>

<p>In addition, you can use <code class="highlighter-rouge">getUserObjectWithId:objectId</code> to get a <code class="highlighter-rouge">%{ParseUser}</code> by id.</p>

<h2 id="associations">Associations</h2>

<p>Associations involving a <code class="highlighter-rouge">%{ParseUser}</code> work right out of the box. For example, let’s say you’re making a blogging app. To store a new post for a user and retrieve all their posts:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">];</span>

<span class="c1">// Make a new post
</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">post</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="n">post</span><span class="p">[</span><span class="s">@"title"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"My New Post"</span><span class="p">;</span>
<span class="n">post</span><span class="p">[</span><span class="s">@"body"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"This is some great content."</span><span class="p">;</span>
<span class="n">post</span><span class="p">[</span><span class="s">@"user"</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span><span class="p">;</span>
<span class="p">[</span><span class="n">post</span> <span class="nf">save</span><span class="p">];</span>

<span class="c1">// Find all posts by the current user
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Post"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"user"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="n">user</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class="n">usersPosts</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span>

<span class="c1">// Make a new post</span>
<span class="k">var</span> <span class="nv">post</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"Post"</span><span class="p">)</span>
<span class="n">post</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"My New Post"</span>
<span class="n">post</span><span class="p">[</span><span class="s">"body"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"This is some great content."</span>
<span class="n">post</span><span class="p">[</span><span class="s">"user"</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
<span class="n">post</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="facebook-users">Facebook Users</h2>

<p>Parse provides an easy way to integrate Facebook with your application. The Facebook SDK can be used with our SDK, and is integrated with the <code class="highlighter-rouge">%{ParseUser}</code> class to make linking your users to their Facebook identities easy.</p>

<div class="tip info"><div>
  Learn how to use Parse with the Facebook API to create a profile viewer application. The [Integrating Facebook in iOS tutorial](/tutorials/integrating-facebook-in-ios) will teach you how to create and login `PFUsers` through Facebook and make queries to the Facebook Graph API.
</div></div>

<p>Using our Facebook integration, you can associate an authenticated Facebook user with a <code class="highlighter-rouge">%{ParseUser}</code>. With just a few lines of code, you’ll be able to provide a “log in with Facebook” option in your app, and be able to save the user’s data to Parse.</p>

<p><strong>Note:</strong> Parse SDK is compatible both with Facebook SDK 3.x and 4.x for iOS. These instructions are for Facebook SDK 4.x.</p>

<h3 id="setup">Setup</h3>

<p>To start using Facebook with Parse, you need to:</p>

<ol>
  <li><a href="https://developers.facebook.com/apps">Set up a Facebook app</a>, if you haven’t already.</li>
  <li>Add your application’s Facebook Application ID on your Parse application’s settings page.</li>
  <li>Follow Facebook’s instructions for <a href="https://developers.facebook.com/docs/ios/getting-started">getting started with the Facebook SDK</a> to create an app linked to the Facebook SDK. Double-check that you have added FacebookAppID and URL Scheme values to your application’s .plist file.</li>
  <li>Download and unzip <a href="/downloads/ios/parse-library/latest">Parse iOS SDK</a>, if you haven’t already.</li>
  <li>Add <code class="highlighter-rouge">ParseFacebookUtils.framework</code> to your Xcode project, by dragging it into your project folder target.</li>
</ol>

<p>There’s also two code changes you’ll need to make. First, add the following to your <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code> method, after you’ve initialized the Parse SDK.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// AppDelegate.m
</span><span class="cp">#import &lt;FBSDKCoreKit/FBSDKCoreKit.h&gt;
#import &lt;ParseFacebookUtilsV4/PFFacebookUtils.h&gt;
</span>
<span class="k">@implementation</span> <span class="nc">AppDelegate</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">Parse</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"parseAppId"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"parseClientKey"</span><span class="p">];</span>
  <span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">initializeFacebookWithApplicationLaunchOptions</span><span class="p">:</span><span class="n">launchOptions</span><span class="p">];</span>
<span class="p">}</span>

</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">FBSDKCoreKit</span>
<span class="kd">import</span> <span class="kt">ParseFacebookUtilsV4</span>

<span class="c1">// AppDelegate.swift</span>
<span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
  <span class="kt">Parse</span><span class="o">.</span><span class="nf">setApplicationId</span><span class="p">(</span><span class="s">"parseAppId"</span><span class="p">,</span> <span class="nv">clientKey</span><span class="p">:</span><span class="s">"parseClientKey"</span><span class="p">)</span>
  <span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">initializeFacebookWithApplicationLaunchOptions</span><span class="p">(</span><span class="n">launchOptions</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Next, add the following handlers in your app delegate.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span>
            <span class="nf">openURL</span><span class="p">:(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nv">url</span>
  <span class="nf">sourceApplication</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">sourceApplication</span>
         <span class="nf">annotation</span><span class="p">:(</span><span class="n">id</span><span class="p">)</span><span class="nv">annotation</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">[[</span><span class="n">FBSDKApplicationDelegate</span> <span class="nf">sharedInstance</span><span class="p">]</span> <span class="nf">application</span><span class="p">:</span><span class="n">application</span>
                                                        <span class="nf">openURL</span><span class="p">:</span><span class="n">url</span>
                                              <span class="nf">sourceApplication</span><span class="p">:</span><span class="n">sourceApplication</span>
                                                     <span class="nf">annotation</span><span class="p">:</span><span class="n">annotation</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationDidBecomeActive</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">FBSDKAppEvents</span> <span class="nf">activateApp</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
                 <span class="n">openURL</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">NSURL</span><span class="p">,</span>
                 <span class="nv">sourceApplication</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
                 <span class="nv">annotation</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kt">FBSDKApplicationDelegate</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">application</span><span class="p">(</span><span class="n">application</span><span class="p">,</span>
                                                             <span class="nv">openURL</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
                                                             <span class="nv">sourceApplication</span><span class="p">:</span> <span class="n">sourceApplication</span><span class="p">,</span>
                                                             <span class="nv">annotation</span><span class="p">:</span> <span class="n">annotation</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1">//Make sure it isn't already declared in the app delegate (possible redefinition of func error)</span>
<span class="kd">func</span> <span class="nf">applicationDidBecomeActive</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">FBSDKAppEvents</span><span class="o">.</span><span class="nf">activateApp</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
</div>

<p>There are two main ways to use Facebook with your Parse users: (1) to log in (or sign up) as a Facebook user and creating a <code class="highlighter-rouge">%{ParseUser}</code>, or (2) linking Facebook to an existing <code class="highlighter-rouge">%{ParseUser}</code>.</p>

<div class="tip info"><div>
  It is up to you to record any data that you need from the Facebook user after they authenticate. To accomplish this, you'll need to [do a graph query via Facebook's SDK](https://parse.com/questions/how-can-i-find-parse-users-that-are-facebook-friends-with-the-current-user).
</div></div>

<h3 id="log-in--sign-up">Log In &amp; Sign Up</h3>

<p><code class="highlighter-rouge">%{ParseUser}</code> provides a way to allow your users to log in or sign up through Facebook. This is done by using the <code class="highlighter-rouge">logInInBackgroundWithReadPermissions</code> method like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">logInInBackgroundWithReadPermissions</span><span class="p">:</span><span class="n">permissions</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh. The user cancelled the Facebook login."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">isNew</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User signed up and logged in through Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User logged in through Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">logInInBackgroundWithReadPermissions</span><span class="p">(</span><span class="n">permissions</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="n">user</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">isNew</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User signed up and logged in through Facebook!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User logged in through Facebook!"</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh. The user cancelled the Facebook login."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>When this code is run, the following happens:</p>

<ol>
  <li>The user is shown the Facebook login dialog.</li>
  <li>The user authenticates via Facebook, and your app receives a callback using <code class="highlighter-rouge">handleOpenURL</code>.</li>
  <li>Our SDK receives the user’s Facebook access data and saves it to a <code class="highlighter-rouge">%{ParseUser}</code>. If no <code class="highlighter-rouge">%{ParseUser}</code> exists with the same Facebook ID, then a new <code class="highlighter-rouge">%{ParseUser}</code> is created.</li>
  <li>Your code block is called with the user.</li>
  <li>The current user reference will be updated to this user.</li>
</ol>

<p>The permissions argument is an array of strings that specifies what permissions your app requires from the Facebook user. These permissions must only include read permissions. The <code class="highlighter-rouge">%{ParseUser}</code> integration doesn’t require any permissions to work out of the box. <a href="https://developers.facebook.com/docs/reference/api/permissions/">Read more permissions on Facebook’s developer guide.</a></p>

<p>To acquire publishing permissions for a user so that your app can, for example, post status updates on their behalf, you must call <code class="highlighter-rouge">[PFFacebookUtils logInInBackgroundWithPublishPermissions:]</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">logInInBackgroundWithPublishPermissions</span><span class="p">:@[</span> <span class="s">@"publish_actions"</span> <span class="p">]</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh. The user cancelled the Facebook login."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User now has publish permissions!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">logInInBackgroundWithPublishPermissions</span><span class="p">([</span><span class="s">"publish_actions"</span><span class="p">],</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">user</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// Your app now has publishing permissions for the user</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="linking">Linking</h3>

<p>If you want to associate an existing <code class="highlighter-rouge">%{ParseUser}</code> to a Facebook account, you can link it like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">isLinkedWithUser</span><span class="p">:</span><span class="n">user</span><span class="p">])</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">linkUserInBackground</span><span class="p">:</span><span class="n">user</span> <span class="nf">withReadPermissions</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Woohoo, user is linked with Facebook!"</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
  <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="o">!</span><span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">isLinkedWithUser</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">linkUserInBackground</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="nv">withReadPermissions</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">succeeded</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"Woohoo, the user is linked with Facebook!"</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The steps that happen when linking are very similar to log in. The difference is that on successful login, the existing <code class="highlighter-rouge">%{ParseUser}</code> is updated with the Facebook information. Future logins via Facebook will now log in the user to their existing account.</p>

<p>If you want to unlink Facebook from a user, simply do this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">unlinkUserInBackground</span><span class="p">:</span><span class="n">user</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"The user is no longer associated with their Facebook account."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">unlinkUserInBackground</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">succeeded</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"The user is no longer associated with their Facebook account."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="log-in--link-via-token">Log In / Link via Token</h3>

<p>In the previous sections, you’ve seen how <code class="highlighter-rouge">PFFacebookUtils</code> can be used to log in with the Facebook SDK and create a <code class="highlighter-rouge">%{ParseUser}</code> or link with existing ones. If you have already integrated the Facebook SDK and have a <code class="highlighter-rouge">FBSDKAccessToken</code>, there is an option to directly log in or link the users like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">FBSDKAccessToken</span> <span class="o">*</span><span class="n">accessToken</span> <span class="o">=</span> <span class="p">...;</span> <span class="c1">// Use existing access token.
</span>
<span class="c1">// Log In (create/update currentUser) with FBSDKAccessToken
</span><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">logInInBackgroundWithAccessToken</span><span class="p">:</span><span class="n">accessToken</span>
                                            <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh. There was an error logging in."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User logged in through Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>

<span class="c1">//
// or
//
</span>
<span class="c1">// Link PFUser with FBSDKAccessToken
</span><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">linkUserInBackground</span><span class="p">:</span><span class="n">user</span>
                      <span class="nf">withAccessToken</span><span class="p">:</span><span class="n">accessToken</span>
                                <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Woohoo, the user is linked with Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">accessToken</span><span class="p">:</span> <span class="kt">FBSDKAccessToken</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span> <span class="c1">// Use existing access token.</span>

<span class="c1">// Log In (create/update currentUser) with FBSDKAccessToken</span>
<span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">logInInBackgroundWithAccessToken</span><span class="p">(</span><span class="n">accessToken</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">user</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"User logged in through Facebook!"</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh. There was an error logging in."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="c1">//</span>
<span class="c1">// or</span>
<span class="c1">//</span>

<span class="c1">// Link PFUser with FBSDKAccessToken</span>
<span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">linkUserInBackground</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="nv">withAccessToken</span><span class="p">:</span> <span class="n">accessToken</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">succeeded</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Woohoo, the user is linked with Facebook!"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="additional-permissions">Additional Permissions</h3>

<p>Since Facebook SDK v4.0 - it is required to request <strong>read</strong> and <strong>publish</strong> permissions separately. With Parse SDK integration you can do that by logging in with read permissions first, and later, when the user wants to post to Facebook - linking a user with new set of publish permissions. This also works the other way around: logging in with publish permissions and linking with additional read permissions.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Log In with Read Permissions
</span><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">logInInBackgroundWithReadPermissions</span><span class="p">:</span><span class="n">permissions</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh. The user cancelled the Facebook login."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">isNew</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User signed up and logged in through Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User logged in through Facebook!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>

<span class="c1">// Request new Publish Permissions
</span><span class="p">[</span><span class="n">PFFacebookUtils</span> <span class="nf">linkUserInBackground</span><span class="p">:[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">]</span>
                <span class="nf">withPublishPermissions</span><span class="p">:@[</span> <span class="s">@"publish_actions"</span><span class="p">]</span>
                                <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User now has read and publish permissions!"</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Log In with Read Permissions</span>
<span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">logInInBackgroundWithReadPermissions</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="n">user</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">isNew</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User signed up and logged in through Facebook!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User logged in through Facebook!"</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh. The user cancelled the Facebook login."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="c1">// Request new Publish Permissions</span>
<span class="kt">PFFacebookUtils</span><span class="o">.</span><span class="nf">linkUserInBackground</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="nv">withPublishPermissions</span><span class="p">:</span> <span class="p">[</span><span class="s">"publish_actions"</span><span class="p">],</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">succeeded</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"User now has read and publish permissions!"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="facebook-sdk-and-parse">Facebook SDK and Parse</h3>

<p>The Facebook iOS SDK provides a number of helper classes for interacting with Facebook’s API. Generally, you will use the <code class="highlighter-rouge">FBSDKGraphRequest</code> class to interact with Facebook on behalf of your logged-in user. <a href="https://developers.facebook.com/docs/reference/ios/current">You can read more about the Facebook SDK here</a>.</p>

<p>To access the user’s Facebook access token, you can simply call <code class="highlighter-rouge">[FBSDKAccessToken currentAccessToken]</code> to access the <code class="highlighter-rouge">FBSDKAccessToken</code> instance, which can be passed to <code class="highlighter-rouge">FBSDKGraphRequest</code>s.&lt;/p&gt;</p>

<h2 id="twitter-users">Twitter Users</h2>

<p>As with Facebook, Parse also provides an easy way to integrate Twitter authentication into your application. The Parse SDK provides a straightforward way to authorize and link a Twitter account to your <code class="highlighter-rouge">%{ParseUser}</code>s. With just a few lines of code, you’ll be able to provide a “log in with Twitter” option in your app, and be able to save their data to Parse.</p>

<h3 id="setup-1">Setup</h3>

<p>To start using Twitter with Parse, you need to:</p>

<ol>
  <li><a href="https://dev.twitter.com/apps">Set up a Twitter app</a>, if you haven’t already.</li>
  <li>Add your application’s Twitter consumer key on your Parse application’s settings page.</li>
  <li>When asked to specify a “Callback URL” for your Twitter app, please insert a valid URL. This value will not be used by your iOS or Android application, but is necessary in order to enable authentication through Twitter.</li>
  <li>Add the <code class="highlighter-rouge">Accounts.framework</code> and <code class="highlighter-rouge">Social.framework</code> libraries to your Xcode project.</li>
  <li>Add the following where you initialize the Parse SDK, such as in <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code>.
<code class="highlighter-rouge">objc
[PFTwitterUtils initializeWithConsumerKey:@"YOUR CONSUMER KEY"
                       consumerSecret:@"YOUR CONSUMER SECRET"];
</code>
<code class="highlighter-rouge">swift
PFTwitterUtils.initializeWithConsumerKey("YOUR CONSUMER KEY",  consumerSecret:"YOUR CONSUMER SECRET")
</code></li>
</ol>

<p>If you encounter any issues that are Twitter-related, a good resource is the <a href="https://dev.twitter.com/docs">official Twitter documentation</a>.</p>

<p>There are two main ways to use Twitter with your Parse users: (1) logging in as a Twitter user and creating a <code class="highlighter-rouge">%{ParseUser}</code>, or (2) linking Twitter to an existing <code class="highlighter-rouge">%{ParseUser}</code>.</p>

<h3 id="login--signup">Login &amp; Signup</h3>

<p><code class="highlighter-rouge">PFTwitterUtils</code> provides a way to allow your <code class="highlighter-rouge">%{ParseUser}</code>s to log in or sign up through Twitter. This is accomplished using the <code class="highlighter-rouge">logInWithBlock</code> or <code class="highlighter-rouge">logInWithTarget</code> messages:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFTwitterUtils</span> <span class="nf">logInWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh. The user cancelled the Twitter login."</span><span class="p">)</span><span class="err">;</span>
      <span class="k">return</span><span class="err">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">isNew</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User signed up and logged in with Twitter!"</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"User logged in with Twitter!"</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="n">logInWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="n">user</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">isNew</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User signed up and logged in with Twitter!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"User logged in with Twitter!"</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh. The user cancelled the Twitter login."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>When this code is run, the following happens:</p>

<ol>
  <li>The user is shown the Twitter login dialog.</li>
  <li>The user authenticates via Twitter, and your app receives a callback.</li>
  <li>Our SDK receives the Twitter data and saves it to a <code class="highlighter-rouge">%{ParseUser}</code>. If it’s a new user based on the Twitter handle, then that user is created.</li>
  <li>Your <code class="highlighter-rouge">block</code> is called with the user.</li>
</ol>

<h3 id="twitter-linking">Twitter Linking</h3>

<p>If you want to associate an existing <code class="highlighter-rouge">%{ParseUser}</code> with a Twitter account, you can link it like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">PFTwitterUtils</span> <span class="nf">isLinkedWithUser</span><span class="p">:</span><span class="n">user</span><span class="p">])</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">PFTwitterUtils</span> <span class="nf">linkUser</span><span class="p">:</span><span class="n">user</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">PFTwitterUtils</span> <span class="nf">isLinkedWithUser</span><span class="p">:</span><span class="n">user</span><span class="p">])</span> <span class="p">{</span>
          <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Woohoo, user logged in with Twitter!"</span><span class="p">)</span><span class="err">;</span>
        <span class="p">}</span>
    <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="o">!</span><span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="nf">isLinkedWithUser</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="nf">linkUser</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="k">if</span> <span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="nf">isLinkedWithUser</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">print</span><span class="p">(</span><span class="s">"Woohoo, user logged in with Twitter!"</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The steps that happen when linking are very similar to log in. The difference is that on successful login, the existing <code class="highlighter-rouge">%{ParseUser}</code> is updated with the Twitter information. Future logins via Twitter will now log the user into their existing account.</p>

<p>If you want to unlink Twitter from a user, simply do this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFTwitterUtils</span> <span class="nf">unlinkUserInBackground</span><span class="p">:</span><span class="n">user</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span> <span class="o">&amp;&amp;</span> <span class="n">succeeded</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"The user is no longer associated with their Twitter account."</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="nf">unlinkUserInBackground</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">&amp;&amp;</span> <span class="n">succeeded</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"The user is no longer associated with their Twitter account."</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre>
</div>

<h3 id="twitter-api-calls">Twitter API Calls</h3>

<p>Our SDK provides a straightforward way to sign your API HTTP requests to the <a href="https://dev.twitter.com/docs/api">Twitter REST API</a> when your app has a Twitter-linked <code class="highlighter-rouge">%{ParseUser}</code>.  To make a request through our API, you can use the <code class="highlighter-rouge">PF_Twitter</code> singleton provided by <code class="highlighter-rouge">PFTwitterUtils</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSURL</span> <span class="o">*</span><span class="n">verify</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSURL</span> <span class="nf">URLWithString</span><span class="p">:</span><span class="s">@"https://api.twitter.com/1.1/account/verify_credentials.json"</span><span class="p">];</span>
<span class="n">NSMutableURLRequest</span> <span class="o">*</span><span class="n">request</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableURLRequest</span> <span class="nf">requestWithURL</span><span class="p">:</span><span class="n">verify</span><span class="p">];</span>
<span class="p">[[</span><span class="n">PFTwitterUtils</span> <span class="nf">twitter</span><span class="p">]</span> <span class="nf">signRequest</span><span class="p">:</span><span class="n">request</span><span class="p">];</span>
<span class="n">NSURLSessionDataTask</span> <span class="o">*</span><span class="n">task</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSURLSession</span> <span class="nf">sharedSession</span><span class="p">]</span> <span class="nf">dataTaskWithRequest</span><span class="p">:</span><span class="n">request</span>
                                                             <span class="nf">completionHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSData</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">NSURLResponse</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Check for error
</span>  <span class="c1">// Data will contain the response data
</span><span class="p">}];</span>
<span class="p">[</span><span class="n">task</span> <span class="nf">resume</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">verify</span> <span class="o">=</span> <span class="kt">NSURL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://api.twitter.com/1.1/account/verify_credentials.json"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">NSMutableURLRequest</span><span class="p">(</span><span class="kt">URL</span><span class="p">:</span> <span class="n">verify</span><span class="o">!</span><span class="p">)</span>
<span class="kt">PFTwitterUtils</span><span class="o">.</span><span class="nf">twitter</span><span class="p">()</span><span class="o">!.</span><span class="nf">signRequest</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">task</span> <span class="o">=</span> <span class="kt">NSURLSession</span><span class="o">.</span><span class="nf">sharedSession</span><span class="p">()</span><span class="o">.</span><span class="nf">dataTaskWithRequest</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="p">{</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
  <span class="c1">// Check for error</span>
  <span class="c1">// Data will contain the response data</span>
<span class="p">}</span>
<span class="n">task</span><span class="o">.</span><span class="nf">resume</span><span class="p">()</span>
</code></pre>
</div>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="roles">Roles</h1>

<p>As your app grows in scope and user-base, you may find yourself needing more coarse-grained control over access to pieces of your data than user-linked ACLs can provide. To address this requirement, Parse supports a form of <a href="http://en.wikipedia.org/wiki/Role-based_access_control">Role-based Access Control</a>. Roles provide a logical way of grouping users with common access privileges to your Parse data. Roles are named objects that contain users and other roles.  Any permission granted to a role is implicitly granted to its users as well as to the users of any roles that it contains.</p>

<p>For example, in your application with curated content, you may have a number of users that are considered “Moderators” and can modify and delete content created by other users.  You may also have a set of users that are “Administrators” and are allowed all of the same privileges as Moderators, but can also modify the global settings for the application. By adding users to these roles, you can ensure that new users can be made moderators or administrators, without having to manually grant permission to every resource for each user.</p>

<p>We provide a specialized class called <code class="highlighter-rouge">%{ParseRole}</code> that represents these role objects in your client code.  <code class="highlighter-rouge">%{ParseRole}</code> is a subclass of <code class="highlighter-rouge">%{ParseObject}</code>, and has all of the same features, such as a flexible schema, automatic persistence, and a key value interface.  All the methods that are on <code class="highlighter-rouge">%{ParseObject}</code> also exist on <code class="highlighter-rouge">%{ParseRole}</code>.  The difference is that <code class="highlighter-rouge">%{ParseRole}</code> has some additions specific to management of roles.</p>

<h2 id="properties">Properties</h2>

<p><code class="highlighter-rouge">%{ParseRole}</code> has several properties that set it apart from <code class="highlighter-rouge">%{ParseObject}</code>:</p>

<ul>
  <li>name: The name for the role.  This value is required, and can only be set once as a role is being created.  The name must consist of alphanumeric characters, spaces, -, or _.  This name will be used to identify the Role without needing its objectId.</li>
  <li>users: A <a href="#objects-pointers">relation</a> to the set of users that will inherit permissions granted to the containing role.</li>
  <li>roles: A <a href="#objects-pointers">relation</a> to the set of roles whose users and roles will inherit permissions granted to the containing role.</li>
</ul>

<h2 id="security-for-role-objects">Security for Role Objects</h2>

<p>The <code class="highlighter-rouge">%{ParseRole}</code> uses the same security scheme (ACLs) as all other objects on Parse, except that it requires an ACL to be set explicitly. Generally, only users with greatly elevated privileges (e.g. a master user or Administrator) should be able to create or modify a Role, so you should define its ACLs accordingly.  Remember, if you give write-access to a <code class="highlighter-rouge">%{ParseRole}</code> to a user, that user can add other users to the role, or even delete the role altogether.</p>

<p>To create a new <code class="highlighter-rouge">%{ParseRole}</code>, you would write:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// By specifying no write privileges for the ACL, we can ensure the role cannot be altered.
</span><span class="n">PFACL</span> <span class="o">*</span><span class="n">roleACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>
<span class="p">[</span><span class="n">roleACL</span> <span class="nf">setPublicReadAccess</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="n">PFRole</span> <span class="o">*</span><span class="n">role</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFRole</span> <span class="nf">roleWithName</span><span class="p">:</span><span class="s">@"Administrator"</span> <span class="nf">acl</span><span class="p">:</span><span class="n">roleACL</span><span class="p">];</span>
<span class="p">[</span><span class="n">role</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// By specifying no write privileges for the ACL, we can ensure the role cannot be altered.</span>
<span class="k">var</span> <span class="nv">roleACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>
<span class="n">roleACL</span><span class="o">.</span><span class="nf">setPublicReadAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">role</span> <span class="o">=</span> <span class="kt">PFRole</span><span class="o">.</span><span class="nf">roleWithName</span><span class="p">(</span><span class="s">"Administrator"</span><span class="p">,</span> <span class="nv">acl</span><span class="p">:</span><span class="n">roleACL</span><span class="p">)</span>
<span class="n">role</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>You can add users and roles that should inherit your new role’s permissions through the “users” and “roles” relations on <code class="highlighter-rouge">%{ParseRole}</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFRole</span> <span class="o">*</span><span class="n">role</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFRole</span> <span class="nf">roleWithName</span><span class="p">:</span><span class="n">roleName</span> <span class="nf">acl</span><span class="p">:</span><span class="n">roleACL</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="k">in</span> <span class="n">usersToAddToRole</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">role</span><span class="p">.</span><span class="n">users</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">user</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="n">PFRole</span> <span class="o">*</span><span class="n">childRole</span> <span class="k">in</span> <span class="n">rolesToAddToRole</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">role</span><span class="p">.</span><span class="n">roles</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">childRole</span><span class="p">];</span>
<span class="p">}</span>
<span class="p">[</span><span class="n">role</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">role</span> <span class="o">=</span> <span class="kt">PFRole</span><span class="o">.</span><span class="nf">roleWithName</span><span class="p">(</span><span class="n">roleName</span><span class="p">,</span> <span class="nv">acl</span><span class="p">:</span><span class="n">roleACL</span><span class="p">)</span>
<span class="k">for</span> <span class="n">user</span> <span class="k">in</span> <span class="n">usersToAddToRole</span> <span class="p">{</span>
  <span class="n">role</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="nf">addObject</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">childRole</span> <span class="k">in</span> <span class="n">rolesToAddToRole</span> <span class="p">{</span>
  <span class="n">role</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="nf">addObject</span><span class="p">(</span><span class="n">childRole</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">role</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Take great care when assigning ACLs to your roles so that they can only be modified by those who should have permissions to modify them.</p>

<h2 id="security-for-other-objects">Security for Other Objects</h2>

<p>Now that you have created a set of roles for use in your application, you can use them with ACLs to define the privileges that their users will receive. Each <code class="highlighter-rouge">%{ParseObject}</code> can specify a <code class="highlighter-rouge">PFACL</code>, which provides an access control list that indicates which users and roles should be granted read or write access to the object.</p>

<p>Giving a role read or write permission to an object is straightforward.  You can either use the <code class="highlighter-rouge">%{ParseRole}</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFRole</span> <span class="o">*</span><span class="n">moderators</span> <span class="o">=</span> <span class="cm">/* Query for some PFRole */</span><span class="p">;</span>
<span class="n">PFObject</span> <span class="o">*</span><span class="n">wallPost</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"WallPost"</span><span class="p">];</span>
<span class="n">PFACL</span> <span class="o">*</span><span class="n">postACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>
<span class="p">[</span><span class="n">postACL</span> <span class="nf">setWriteAccess</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">forRole</span><span class="p">:</span><span class="n">moderators</span><span class="p">];</span>
<span class="n">wallPost</span><span class="p">.</span><span class="n">ACL</span> <span class="o">=</span> <span class="n">postACL</span><span class="p">;</span>
<span class="p">[</span><span class="n">wallPost</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">moderators</span> <span class="o">=</span> <span class="cm">/* Query for some PFRole */</span>
<span class="k">var</span> <span class="nv">wallPost</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"WallPost"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">postACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>
<span class="n">postACL</span><span class="o">.</span><span class="nf">setWriteAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">forRole</span><span class="p">:</span><span class="n">moderators</span><span class="p">)</span>
<span class="n">wallPost</span><span class="o">.</span><span class="kt">ACL</span> <span class="o">=</span> <span class="n">postACL</span>
<span class="n">wallPost</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>You can avoid querying for a role by specifying its name for the ACL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">wallPost</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"WallPost"</span><span class="p">];</span>
<span class="n">PFACL</span> <span class="o">*</span><span class="n">postACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>
<span class="p">[</span><span class="n">postACL</span> <span class="nf">setWriteAccess</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">forRoleWithName</span><span class="p">:</span><span class="s">@"Moderators"</span><span class="p">];</span>
<span class="n">wallPost</span><span class="p">.</span><span class="n">ACL</span> <span class="o">=</span> <span class="n">postACL</span><span class="p">;</span>
<span class="p">[</span><span class="n">wallPost</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">wallPost</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"WallPost"</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">postACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>
<span class="n">postACL</span><span class="o">.</span><span class="nf">setWriteAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">forRoleWithName</span><span class="p">:</span><span class="s">"Moderators"</span><span class="p">)</span>
<span class="n">wallPost</span><span class="o">.</span><span class="kt">ACL</span> <span class="o">=</span> <span class="n">postACL</span>
<span class="n">wallPost</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Role-based <code class="highlighter-rouge">PFACL</code>s can also be used when specifying default ACLs for your application, making it easy to protect your users’ data while granting access to users with additional privileges.  For example, a moderated forum application might specify a default ACL like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFACL</span> <span class="o">*</span><span class="n">defaultACL</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFACL</span> <span class="nf">ACL</span><span class="p">];</span>
<span class="c1">// Everybody can read objects created by this user
</span><span class="p">[</span><span class="n">defaultACL</span> <span class="nf">setPublicReadAccess</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="c1">// Moderators can also modify these objects
</span><span class="p">[</span><span class="n">defaultACL</span> <span class="nf">setWriteAccess</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">forRoleWithName</span><span class="p">:</span><span class="s">@"Moderators"</span><span class="p">];</span>
<span class="c1">// And the user can read and modify its own objects
</span><span class="p">[</span><span class="n">PFACL</span> <span class="nf">setDefaultACL</span><span class="p">:</span><span class="n">defaultACL</span> <span class="nf">withAccessForCurrentUser</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">defaultACL</span> <span class="o">=</span> <span class="kt">PFACL</span><span class="o">.</span><span class="kt">ACL</span><span class="p">()</span>
<span class="c1">// Everybody can read objects created by this user</span>
<span class="n">defaultACL</span><span class="o">.</span><span class="nf">setPublicReadAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="c1">// Moderators can also modify these objects</span>
<span class="n">defaultACL</span><span class="o">.</span><span class="nf">setWriteAccess</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">forRoleWithName</span><span class="p">:</span><span class="s">"Moderators"</span><span class="p">)</span>
<span class="c1">// And the user can read and modify its own objects</span>
<span class="kt">PFACL</span><span class="o">.</span><span class="nf">setDefaultACL</span><span class="p">(</span><span class="n">defaultACL</span><span class="p">,</span> <span class="nv">withAccessForCurrentUser</span><span class="p">:</span><span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="role-hierarchy">Role Hierarchy</h2>

<p>As described above, one role can contain another, establishing a parent-child relationship between the two roles. The consequence of this relationship is that any permission granted to the parent role is implicitly granted to all of its child roles.</p>

<p>These types of relationships are commonly found in applications with user-managed content, such as forums. Some small subset of users are “Administrators”, with the highest level of access to tweaking the application’s settings, creating new forums, setting global messages, and so on. Another set of users are “Moderators”, who are responsible for ensuring that the content created by users remains appropriate. Any user with Administrator privileges should also be granted the permissions of any Moderator. To establish this relationship, you would make your “Administrators” role a child role of “Moderators”, like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFRole</span> <span class="o">*</span><span class="n">administrators</span> <span class="o">=</span> <span class="cm">/* Your "Administrators" role */</span><span class="p">;</span>
<span class="n">PFRole</span> <span class="o">*</span><span class="n">moderators</span> <span class="o">=</span> <span class="cm">/* Your "Moderators" role */</span><span class="p">;</span>
<span class="p">[</span><span class="n">moderators</span><span class="p">.</span><span class="n">roles</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">administrators</span><span class="p">];</span>
<span class="p">[</span><span class="n">moderators</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">administrators</span> <span class="o">=</span> <span class="cm">/* Your "Administrators" role */</span>
<span class="k">var</span> <span class="nv">moderators</span> <span class="o">=</span> <span class="cm">/* Your "Moderators" role */</span>
<span class="n">moderators</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="nf">addObject</span><span class="p">(</span><span class="n">administrators</span><span class="p">)</span>
<span class="n">moderators</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="files">Files</h1>

<h2 id="the-pffile">The PFFile</h2>

<p><code class="highlighter-rouge">%{ParseFile}</code> lets you store application files in the cloud that would otherwise be too large or cumbersome to fit into a regular <code class="highlighter-rouge">%{ParseObject}</code>. The most common use case is storing images but you can also use it for documents, videos, music, and any other binary data (up to 10 megabytes).</p>

<div class="tip info"><div>
  Learn how to make an app that allows the user to take photos and upload it directly to Parse in our [Saving Images tutorial](/tutorials/saving-images).
</div></div>

<p>Getting started with <code class="highlighter-rouge">%{ParseFile}</code> is easy. First, you’ll need to have the data in <code class="highlighter-rouge">NSData</code> form and then create a <code class="highlighter-rouge">%{ParseFile}</code> with it. In this example, we’ll just use a string:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s">@"Working at Parse is great!"</span> <span class="nf">dataUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="n">PFFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFFile</span> <span class="nf">fileWithName</span><span class="p">:</span><span class="s">@"resume.txt"</span> <span class="nf">data</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"Working at Parse is great!"</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="nf">dataUsingEncoding</span><span class="p">(</span><span class="kt">NSUTF8StringEncoding</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">file</span> <span class="o">=</span> <span class="kt">PFFile</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span><span class="s">"resume.txt"</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span><span class="n">data</span><span class="p">)</span>
</code></pre>
</div>

<p>Notice in this example that we give the file a name of <code class="highlighter-rouge">resume.txt</code>. There’s two things to note here:</p>

<ul>
  <li>You don’t need to worry about filename collisions. Each upload gets a unique identifier so there’s no problem with uploading multiple files named <code class="highlighter-rouge">resume.txt</code>.</li>
  <li>It’s important that you give a name to the file that has a file extension. This lets Parse figure out the file type and handle it accordingly. So, if you’re storing PNG images, make sure your filename ends with <code class="highlighter-rouge">.png</code>.</li>
</ul>

<p>Next you’ll want to save the file up to the cloud. As with <code class="highlighter-rouge">%{ParseObject}</code>, there are many variants of the <code class="highlighter-rouge">save</code> method you can use depending on what sort of callback and error handling suits you.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">file</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">file</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Finally, after the save completes, you can associate a <code class="highlighter-rouge">%{ParseFile}</code> onto a <code class="highlighter-rouge">%{ParseObject}</code> just like any other piece of data:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">jobApplication</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"JobApplication"</span><span class="p">]</span>
<span class="n">jobApplication</span><span class="p">[</span><span class="s">@"applicantName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Joe Smith"</span><span class="p">;</span>
<span class="n">jobApplication</span><span class="p">[</span><span class="s">@"applicantResumeFile"</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span><span class="p">;</span>
<span class="p">[</span><span class="n">jobApplication</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">jobApplication</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"JobApplication"</span><span class="p">)</span>
<span class="n">jobApplication</span><span class="p">[</span><span class="s">"applicantName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Joe Smith"</span>
<span class="n">jobApplication</span><span class="p">[</span><span class="s">"applicantResumeFile"</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span>
<span class="n">jobApplication</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Retrieving it back involves calling one of the <code class="highlighter-rouge">getData</code> variants on the <code class="highlighter-rouge">%{ParseFile}</code>. Here we retrieve the resume file off another JobApplication object:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFFile</span> <span class="o">*</span><span class="n">applicantResume</span> <span class="o">=</span> <span class="n">anotherApplication</span><span class="p">[</span><span class="s">@"applicantResumeFile"</span><span class="p">];</span>
<span class="n">NSData</span> <span class="o">*</span><span class="n">resumeData</span> <span class="o">=</span> <span class="p">[</span><span class="n">applicantResume</span> <span class="nf">getData</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">applicantResume</span> <span class="o">=</span> <span class="n">annotherApplication</span><span class="p">[</span><span class="s">"applicationResumeFile"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">PFFile</span>
<span class="k">let</span> <span class="nv">resumeData</span> <span class="o">=</span> <span class="n">applicantResume</span><span class="o">.</span><span class="nf">getData</span><span class="p">()</span>
</code></pre>
</div>

<p>Just like on <code class="highlighter-rouge">%{ParseObject}</code>, you will most likely want to use the background version of <code class="highlighter-rouge">getData</code>.</p>

<h2 id="images">Images</h2>

<p>You can easily store images by converting them to <code class="highlighter-rouge">NSData</code> and then using <code class="highlighter-rouge">%{ParseFile}</code>. Suppose you have a <code class="highlighter-rouge">UIImage</code> named <code class="highlighter-rouge">image</code> that you want to save as a <code class="highlighter-rouge">%{ParseFile}</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSData</span> <span class="o">*</span><span class="n">imageData</span> <span class="o">=</span> <span class="n">UIImagePNGRepresentation</span><span class="p">(</span><span class="n">image</span><span class="p">);</span>
<span class="n">PFFile</span> <span class="o">*</span><span class="n">imageFile</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFFile</span> <span class="nf">fileWithName</span><span class="p">:</span><span class="s">@"image.png"</span> <span class="nf">data</span><span class="p">:</span><span class="n">imageData</span><span class="p">];</span>

<span class="n">PFObject</span> <span class="o">*</span><span class="n">userPhoto</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"UserPhoto"</span><span class="p">];</span>
<span class="n">userPhoto</span><span class="p">[</span><span class="s">@"imageName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"My trip to Hawaii!"</span><span class="p">;</span>
<span class="n">userPhoto</span><span class="p">[</span><span class="s">@"imageFile"</span><span class="p">]</span> <span class="o">=</span> <span class="n">imageFile</span><span class="p">;</span>
<span class="p">[</span><span class="n">userPhoto</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">imageData</span> <span class="o">=</span> <span class="kt">UIImagePNGRepresentation</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">imageFile</span> <span class="o">=</span> <span class="kt">PFFile</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span><span class="s">"image.png"</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span><span class="n">imageData</span><span class="p">)</span>

<span class="k">var</span> <span class="nv">userPhoto</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"UserPhoto"</span><span class="p">)</span>
<span class="n">userPhoto</span><span class="p">[</span><span class="s">"imageName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"My trip to Hawaii!"</span>
<span class="n">userPhoto</span><span class="p">[</span><span class="s">"imageFile"</span><span class="p">]</span> <span class="o">=</span> <span class="n">imageFile</span>
<span class="n">userPhoto</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Your <code class="highlighter-rouge">%{ParseFile}</code> will be uploaded as part of the save operation on the <code class="highlighter-rouge">userPhoto</code> object. It’s also possible to track a <code class="highlighter-rouge">%{ParseFile}</code>’s <a href="#files-progress">upload and download progress</a>.</p>

<p>Retrieving the image back involves calling one of the <code class="highlighter-rouge">getData</code> variants on the <code class="highlighter-rouge">%{ParseFile}</code>. Here we retrieve the image file off another <code class="highlighter-rouge">UserPhoto</code> named <code class="highlighter-rouge">anotherPhoto</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFFile</span> <span class="o">*</span><span class="n">userImageFile</span> <span class="o">=</span> <span class="n">anotherPhoto</span><span class="p">[</span><span class="s">@"imageFile"</span><span class="p">];</span>
<span class="p">[</span><span class="n">userImageFile</span> <span class="nf">getDataInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSData</span> <span class="o">*</span><span class="n">imageData</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageWithData</span><span class="p">:</span><span class="n">imageData</span><span class="p">]</span><span class="err">;</span>
    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">userImageFile</span> <span class="o">=</span> <span class="n">anotherPhoto</span><span class="p">[</span><span class="s">"imageFile"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">PFFile</span>
<span class="n">userImageFile</span><span class="o">.</span><span class="n">getDataInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">imageData</span><span class="p">:</span> <span class="kt">NSData</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">imageData</span> <span class="o">=</span> <span class="n">imageData</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span><span class="n">imageData</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre>
</div>

<h2 id="progress">Progress</h2>

<p>It’s easy to get the progress of both uploads and downloads using <code class="highlighter-rouge">%{ParseFile}</code> using <code class="highlighter-rouge">saveInBackgroundWithBlock:progressBlock:</code> and <code class="highlighter-rouge">getDataInBackgroundWithBlock:progressBlock:</code> respectively. For example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s">@"Working at Parse is great!"</span> <span class="nf">dataUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="n">PFFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFFile</span> <span class="nf">fileWithName</span><span class="p">:</span><span class="s">@"resume.txt"</span> <span class="nf">data</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
<span class="p">[</span><span class="n">file</span> <span class="nf">saveInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Handle success or failure here ...
</span><span class="p">}</span> <span class="nf">progressBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">int</span> <span class="n">percentDone</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Update your progress spinner here. percentDone will be between 0 and 100.
</span><span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">str</span> <span class="o">=</span> <span class="s">"Working at Parse is great!"</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="nf">dataUsingEncoding</span><span class="p">(</span><span class="kt">NSUTF8StringEncoding</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">file</span> <span class="o">=</span> <span class="kt">PFFile</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span><span class="s">"resume.txt"</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span><span class="n">data</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="nf">saveInBackgroundWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">succeeded</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="c1">// Handle success or failure here ...</span>
<span class="p">},</span> <span class="nv">progressBlock</span><span class="p">:</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">percentDone</span><span class="p">:</span> <span class="kt">Int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="c1">// Update your progress spinner here. percentDone will be between 0 and 100.</span>
<span class="p">})</span>
</code></pre>
</div>

<p>You can delete files that are referenced by objects using the <a href="/docs/rest/guide#files-deleting-files">REST API</a>. You will need to provide the master key in order to be allowed to delete a file.</p>

<p>If your files are not referenced by any object in your app, it is not possible to delete them through the REST API. You may request a cleanup of unused files in your app’s Settings page. Keep in mind that doing so may break functionality which depended on accessing unreferenced files through their URL property. Files that are currently associated with an object will not be affected.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="geopoints">GeoPoints</h1>

<p>Parse allows you to associate real-world latitude and longitude coordinates with an object.  Adding a <code class="highlighter-rouge">PFGeoPoint</code> to a <code class="highlighter-rouge">%{ParseObject}</code> allows queries to take into account the proximity of an object to a reference point. This allows you to easily do things like find out what user is closest to another user or which places are closest to a user.</p>

<div class="tip info"><div>
  Explore the use of `PFGeoPoints` and `%{ParseUser}` in a real application with our [Anywall tutorial](/tutorials/anywall). You'll learn everything from implementing a basic user management workflow to tracking GPS location with Core Location.
</div></div>

<h2 id="pfgeopoint">PFGeoPoint</h2>

<p>To associate a point with an object you first need to create a <code class="highlighter-rouge">PFGeoPoint</code>. For example, to create a point with latitude of 40.0 degrees and -30.0 degrees longitude:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFGeoPoint</span> <span class="o">*</span><span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFGeoPoint</span> <span class="nf">geoPointWithLatitude</span><span class="p">:</span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span> <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">0</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">point</span> <span class="o">=</span> <span class="kt">PFGeoPoint</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span><span class="mf">40.0</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span><span class="o">-</span><span class="mf">30.0</span><span class="p">)</span>
</code></pre>
</div>

<p>This point is then stored in the object as a regular field.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">placeObject</span><span class="p">[</span><span class="s">@"location"</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">placeObject</span><span class="p">[</span><span class="s">"location"</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span>
</code></pre>
</div>

<p>Note: Currently only one key in a class may be a <code class="highlighter-rouge">PFGeoPoint</code>.</p>

<h3 id="getting-the-users-current-location">Getting the User’s Current Location</h3>

<p><code class="highlighter-rouge">PFGeoPoint</code> also provides a helper method for fetching the user’s current location. This is accomplished via <code class="highlighter-rouge">geoPointForCurrentLocationInBackground</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFGeoPoint</span> <span class="nf">geoPointForCurrentLocationInBackground</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFGeoPoint</span> <span class="o">*</span><span class="n">geoPoint</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// do something with the new geoPoint
</span>    <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFGeoPoint</span><span class="o">.</span><span class="n">geoPointForCurrentLocationInBackground</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">geoPoint</span><span class="p">:</span> <span class="kt">PFGeoPoint</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="c1">// do something with the new geoPoint</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>When this code is run, the following happens:</p>

<ol>
  <li>An internal <code class="highlighter-rouge">CLLocationManager</code> starts listening for location updates (via <code class="highlighter-rouge">startsUpdatingLocation</code>).</li>
  <li>Once a location is received, the location manager stops listening for location updates (via <code class="highlighter-rouge">stopsUpdatingLocation</code>) and a <code class="highlighter-rouge">PFGeoPoint</code> is created from the new location. If the location manager errors out, it still stops listening for updates, and returns an <code class="highlighter-rouge">NSError</code> instead.</li>
  <li>Your <code class="highlighter-rouge">block</code> is called with the <code class="highlighter-rouge">PFGeoPoint</code>.</li>
</ol>

<p>For those who choose to use <code class="highlighter-rouge">CLLocationManager</code> directly, we also provide a <code class="highlighter-rouge">+geoPointWithLocation:</code> constructor to transform <code class="highlighter-rouge">CLLocation</code>s directly into <code class="highlighter-rouge">PFGeoPoint</code>s - great for apps that require constant polling.</p>

<h2 id="geo-queries">Geo Queries</h2>

<p>Now that you have a bunch of objects with spatial coordinates, it would be nice to find out which objects are closest to a point. This can be done by adding another restriction to <code class="highlighter-rouge">%{ParseQuery}</code> using <code class="highlighter-rouge">whereKey:nearGeoPoint:</code>. Getting a list of ten places that are closest to a user may look something like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// User's location
</span><span class="n">PFGeoPoint</span> <span class="o">*</span><span class="n">userGeoPoint</span> <span class="o">=</span> <span class="n">userObject</span><span class="p">[</span><span class="s">@"location"</span><span class="p">];</span>
<span class="c1">// Create a query for places
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"PlaceObject"</span><span class="p">];</span>
<span class="c1">// Interested in locations near user.
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"location"</span> <span class="nf">nearGeoPoint</span><span class="p">:</span><span class="n">userGeoPoint</span><span class="p">];</span>
<span class="c1">// Limit what could be a lot of points.
</span><span class="n">query</span><span class="p">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="c1">// Final list of objects
</span><span class="n">placesObjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// User's location</span>
<span class="k">let</span> <span class="nv">userGeoPoint</span> <span class="o">=</span> <span class="n">userObject</span><span class="p">[</span><span class="s">"location"</span><span class="p">]</span> <span class="k">as</span> <span class="kt">PFGeoPoint</span>
<span class="c1">// Create a query for places</span>
<span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"PlaceObject"</span><span class="p">)</span>
<span class="c1">// Interested in locations near user.</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nv">nearGeoPoint</span><span class="p">:</span><span class="n">userGeoPoint</span><span class="p">)</span>
<span class="c1">// Limit what could be a lot of points.</span>
<span class="n">query</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1">// Final list of objects</span>
<span class="n">placesObjects</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">findObjects</span><span class="p">()</span>
</code></pre>
</div>

<p>At this point <code class="highlighter-rouge">placesObjects</code> will be an array of objects ordered by distance (nearest to farthest) from <code class="highlighter-rouge">userGeoPoint</code>. Note that if an additional <code class="highlighter-rouge">orderByAscending:</code>/<code class="highlighter-rouge">orderByDescending:</code> constraint is applied, it will take precedence over the distance ordering.</p>

<p>To limit the results using distance check out <code class="highlighter-rouge">whereKey:nearGeoPoint:withinMiles</code>, <code class="highlighter-rouge">whereKey:nearGeoPoint:withinKilometers</code>, and <code class="highlighter-rouge">whereKey:nearGeoPoint:withinRadians</code>.</p>

<p>It’s also possible to query for the set of objects that are contained within a particular area. To find the objects in a rectangular bounding box, add the <code class="highlighter-rouge">whereKey:withinGeoBoxFromSouthwest:toNortheast:</code> restriction to your <code class="highlighter-rouge">%{ParseQuery}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFGeoPoint</span> <span class="o">*</span><span class="n">swOfSF</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFGeoPoint</span> <span class="nf">geoPointWithLatitude</span><span class="p">:</span><span class="mi">37</span><span class="p">.</span><span class="mi">708813</span> <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">122</span><span class="p">.</span><span class="mi">526398</span><span class="p">];</span>
<span class="n">PFGeoPoint</span> <span class="o">*</span><span class="n">neOfSF</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFGeoPoint</span> <span class="nf">geoPointWithLatitude</span><span class="p">:</span><span class="mi">37</span><span class="p">.</span><span class="mi">822802</span> <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">122</span><span class="p">.</span><span class="mi">373962</span><span class="p">];</span>
<span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"PizzaPlaceObject"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"location"</span> <span class="nf">withinGeoBoxFromSouthwest</span><span class="p">:</span><span class="n">swOfSF</span> <span class="nf">toNortheast</span><span class="p">:</span><span class="n">neOfSF</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class="n">pizzaPlacesInSF</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span> <span class="nf">findObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">swOfSF</span> <span class="o">=</span> <span class="kt">PFGeoPoint</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span><span class="mf">37.708813</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span><span class="o">-</span><span class="mf">122.526398</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">neOfSF</span> <span class="o">=</span> <span class="kt">PFGeoPoint</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span><span class="mf">37.822802</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span><span class="o">-</span><span class="mf">122.373962</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"PizzaPlaceObject"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nv">withinGeoBoxFromSouthwest</span><span class="p">:</span><span class="n">swOfSF</span><span class="p">,</span> <span class="nv">toNortheast</span><span class="p">:</span><span class="n">neOfSF</span><span class="p">)</span>
<span class="k">var</span> <span class="nv">pizzaPlacesInSF</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="nf">findObjects</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="caveats">Caveats</h2>

<p>At the moment there are a couple of things to watch out for:</p>

<ol>
  <li>Each <code class="highlighter-rouge">%{ParseObject}</code> class may only have one key with a <code class="highlighter-rouge">PFGeoPoint</code> object.</li>
  <li>Using the <code class="highlighter-rouge">nearGeoPoint</code> constraint will also limit results to within 100 miles.</li>
  <li>Points should not equal or exceed the extreme ends of the ranges. Latitude should not be -90.0 or 90.0. Longitude should not be -180.0 or 180.0. Attempting to set latitude or longitude out of bounds will cause an error.</li>
</ol>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="local-datastore">Local Datastore</h1>

<p>The Parse iOS/OS X SDK provides a local datastore which can be used to store and retrieve <code class="highlighter-rouge">%{ParseObject}</code>s, even when the network is unavailable. To enable this functionality, add <code class="highlighter-rouge">libsqlite3.dylib</code> and call <code class="highlighter-rouge">[Parse enableLocalDatastore]</code> before your call to <code class="highlighter-rouge">setApplicationId:clientKey:</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@implementation</span> <span class="nc">AppDelegate</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchWithOptions</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">options</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">Parse</span> <span class="nf">enableLocalDatastore</span><span class="p">];</span>
  <span class="p">[</span><span class="n">Parse</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"parseAppId"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"parseClientKey"</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">@UIApplicationMain</span>
<span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIApplicationDelegate</span> <span class="p">{</span>

  <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="kt">Parse</span><span class="o">.</span><span class="nf">enableLocalDatastore</span><span class="p">()</span>
    <span class="kt">Parse</span><span class="o">.</span><span class="nf">setApplicationId</span><span class="p">(</span><span class="s">"parseAppId"</span><span class="p">,</span> <span class="nv">clientKey</span><span class="p">:</span> <span class="s">"parseClientKey"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>There are a couple of side effects of enabling the local datastore that you should be aware of. When enabled, there will only be one instance of any given <code class="highlighter-rouge">%{ParseObject}</code>. For example, imagine you have an instance of the <code class="highlighter-rouge">"GameScore"</code> class with an <code class="highlighter-rouge">objectId</code> of <code class="highlighter-rouge">"xWMyZ4YEGZ"</code>, and then you issue a <code class="highlighter-rouge">%{ParseQuery}</code> for all instances of <code class="highlighter-rouge">"GameScore"</code> with that <code class="highlighter-rouge">objectId</code>. The result will be the same instance of the object you already have in memory.</p>

<p>Another side effect is that the current user and current installation will be stored in the local datastore, so you can persist unsaved changes to these objects between runs of your app using the methods below.</p>

<p>Calling the <code class="highlighter-rouge">saveEventually</code> method on a <code class="highlighter-rouge">%{ParseObject}</code> will cause the object to be pinned in the local datastore until the save completes. So now, if you change the current <code class="highlighter-rouge">%{ParseUser}</code> and call <code class="highlighter-rouge">[[PFUser currentUser] saveEventually]</code>, your app will always see the changes that you have made.</p>

<h2 id="pinning">Pinning</h2>

<p>You can store a <code class="highlighter-rouge">%{ParseObject}</code> in the local datastore by pinning it. Pinning a <code class="highlighter-rouge">%{ParseObject}</code> is recursive, just like saving, so any objects that are pointed to by the one you are pinning will also be pinned. When an object is pinned, every time you update it by fetching or saving new data, the copy in the local datastore will be updated automatically. You don’t need to worry about it at all.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFObject</span> <span class="o">*</span><span class="n">gameScore</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">@1337</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">@"Sean Plott"</span><span class="p">;</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">@"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">@NO</span><span class="p">;</span>
<span class="p">[</span><span class="n">gameScore</span> <span class="nf">pinInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">gameScore</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"playerName"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Sean Plott"</span>
<span class="n">gameScore</span><span class="p">[</span><span class="s">"cheatMode"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">gameScore</span><span class="o">.</span><span class="nf">pinInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>If you have multiple objects, you can pin them all at once with the <code class="highlighter-rouge">pinAllInBackground</code> convenience method.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFObject</span> <span class="nf">pinAllInBackground</span><span class="p">:</span><span class="n">listOfObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFObject</span><span class="o">.</span><span class="nf">pinAllInBackground</span><span class="p">(</span><span class="n">listOfObjects</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="retrieving-objects">Retrieving Objects</h2>

<p>Storing objects is great, but it’s only useful if you can then get the objects back out later. Retrieving an object from the local datastore works just like retrieving one over the network. The only difference is calling the <code class="highlighter-rouge">fromLocalDatastore</code> method to tell the <code class="highlighter-rouge">%{ParseQuery}</code> where to look for its results.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">fromLocalDatastore</span><span class="p">];</span>
<span class="p">[[</span><span class="n">query</span> <span class="nf">getObjectInBackgroundWithId</span><span class="p">:</span><span class="s">@"xWMyZ4YE"</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Something went wrong.
</span>    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="c1">// task.result will be your game score
</span>  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">fromLocalDatastore</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">getObjectInBackgroundWithId</span><span class="p">(</span><span class="s">"xWMyZ4YE"</span><span class="p">)</span><span class="o">.</span><span class="n">continueWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">error</span> <span class="p">{</span>
        <span class="c1">// Something went wrong.</span>
        <span class="k">return</span> <span class="n">task</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// task.result will be your game score</span>
    <span class="k">return</span> <span class="n">task</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="querying">Querying</h2>

<p>Often, you’ll want to find a whole list of objects that match certain criteria, instead of getting a single object by id. To do that, you can use a <a href="#queries">PFQuery</a>. Any <code class="highlighter-rouge">%{ParseQuery}</code> can be used with the local datastore just as with the network. The results will include any object you have pinned that matches the query. Any unsaved changes you have made to the object will be considered when evaluating the query. So you can find a local object that matches, even if it was never returned from the server for this particular query.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">fromLocalDatastore</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"playerName"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"Joe Bob"</span><span class="p">];</span>
<span class="p">[[</span><span class="n">query</span> <span class="nf">findObjectsInBackground</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span><span class="err">;</span>
    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Retrieved %d"</span><span class="p">,</span> <span class="n">task</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="err">;</span>
  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">fromLocalDatastore</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"playerName"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"Joe Bob"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">findObjectsInBackground</span><span class="p">()</span><span class="o">.</span><span class="n">continueWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span> <span class="k">in</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">error</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">task</span>
    <span class="p">}</span>

    <span class="nf">print</span><span class="p">(</span><span class="s">"Retrieved </span><span class="se">\(</span><span class="n">task</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">task</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="security">Security</h2>

<p>The same security model that applies to objects in Parse applies to objects in the Local Datastore. Read-write permissions are defined by <code class="highlighter-rouge">PFACL</code>s and a user cannot access or modify anything they don’t have permission to.</p>

<p>The only difference is that you won’t be able to access any data protected by Role based ACLs due to the fact that the Roles are stored on the server. To access this data protected by Role based ACLs, you will need to ignore ACLs when executing a Local Datastore query:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Note"</span><span class="p">]</span>
                   <span class="nf">fromLocalDatastore</span><span class="p">]</span>
                  <span class="nf">ignoreACLs</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Note"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">fromLocalDatastore</span>
    <span class="o">.</span><span class="n">ignoreACLs</span>
</code></pre>
</div>

<h2 id="unpinning">Unpinning</h2>

<p>When you are done with an object and no longer need it to be in the local datastore, you can simply unpin it. This will free up disk space on the device and keep your queries on the local datastore running quickly.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">unpinInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">unpinInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>There’s also a method to unpin several objects at once.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFObject</span> <span class="nf">unpinAllInBackground</span><span class="p">:</span><span class="n">listOfObjects</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFObject</span><span class="o">.</span><span class="nf">unpinAllInBackground</span><span class="p">(</span><span class="n">listOfObjects</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="pinning-with-labels">Pinning with Labels</h2>

<p>Manually pinning and unpinning each object individual is a bit like using <code class="highlighter-rouge">malloc</code> and <code class="highlighter-rouge">free</code>. It is a very powerful tool, but it can be difficult to manage what objects get stored in complex scenarios. For example, imagine you are making a game with separate high score lists for global high scores and your friends’ high scores. If one of your friends happens to have a globally high score, you need to make sure you don’t unpin them completely when you remove them from one of the cached queries. To make these scenarios easier, you can also pin with a label. Labels indicate a group of objects that should be stored together.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Add several objects with a label.
</span><span class="p">[</span><span class="n">PFObject</span> <span class="nf">pinAllInBackground</span><span class="p">:</span><span class="n">someGameScores</span> <span class="nf">withName</span><span class="p">:</span><span class="s">@"MyScores"</span><span class="p">];</span>

<span class="c1">// Add another object with the same label.
</span><span class="p">[</span><span class="n">anotherGameScore</span> <span class="nf">pinInBackgroundWithName</span><span class="p">:</span><span class="s">@"MyScores"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Add several objects with a label.</span>
<span class="kt">PFObject</span><span class="o">.</span><span class="nf">pinAllInBackground</span><span class="p">(</span><span class="nv">objects</span><span class="p">:</span><span class="n">someGameScores</span> <span class="nv">withName</span><span class="p">:</span><span class="s">"MyScores"</span><span class="p">)</span>

<span class="c1">// Add another object with the same label.</span>
<span class="n">anotherGameScore</span><span class="o">.</span><span class="nf">pinInBackgroundWithName</span><span class="p">(</span><span class="s">"MyScores"</span><span class="p">)</span>
</code></pre>
</div>

<p>To unpin all of the objects with the same label at the same time, you can pass a label to the unpin methods. This saves you from having to manually track which objects are in each group you care about.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFObject</span> <span class="nf">unpinAllObjectsInBackgroundWithName</span><span class="p">:</span><span class="s">@"MyScores"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFObject</span><span class="o">.</span><span class="nf">unpinAllObjectsInBackgroundWithName</span><span class="p">(</span><span class="s">"MyScores"</span><span class="p">)</span>
</code></pre>
</div>

<p>Any object will stay in the datastore as long as it is pinned with any label. In other words, if you pin an object with two different labels, and then unpin it with one label, the object will stay in the datastore until you also unpin it with the other label.</p>

<h2 id="caching-query-results">Caching Query Results</h2>

<p>Pinning with labels makes it easy to cache the results of queries. You can use one label to pin the results of each different query. To get new results from the network, just do a query and update the pinned objects.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">orderByDescending</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>

<span class="c1">// Query for new results from the network
</span><span class="p">[[</span><span class="n">query</span> <span class="nf">findObjectsInBackground</span><span class="p">]</span> <span class="nf">continueWithSuccessBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">[[</span><span class="n">PFObject</span> <span class="nf">unpinAllObjectsInBackgroundWithName</span><span class="p">:</span><span class="s">@"HighScores"</span><span class="p">]</span> <span class="nf">continueWithSuccessBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">ignored</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Cache the new results.
</span>    <span class="n">NSArray</span> <span class="o">*</span><span class="n">scores</span> <span class="o">=</span> <span class="n">task</span><span class="p">.</span><span class="n">result</span><span class="err">;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">pinAllInBackground</span><span class="p">:</span><span class="n">scores</span> <span class="nf">withName</span><span class="p">:</span><span class="s">@"HighScores"</span><span class="p">]</span><span class="err">;</span>
  <span class="p">}]</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">orderByDescending</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>

<span class="c1">// Query for new results from the network</span>
<span class="n">query</span><span class="o">.</span><span class="nf">findObjectsInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithSuccessBlock</span><span class="p">({</span>
    <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>

    <span class="k">return</span> <span class="kt">PFObject</span><span class="o">.</span><span class="nf">unpinAllObjectsInBackgroundWithName</span><span class="p">(</span><span class="s">"HighScores"</span><span class="p">)</span><span class="o">.</span><span class="nf">continueWithSuccessBlock</span><span class="p">({</span>
        <span class="p">(</span><span class="nv">ignored</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>

        <span class="c1">// Cache new results</span>
        <span class="k">let</span> <span class="nv">scores</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span> <span class="k">as?</span> <span class="kt">NSArray</span>
        <span class="k">return</span> <span class="kt">PFObject</span><span class="o">.</span><span class="nf">pinAllInBackground</span><span class="p">(</span><span class="n">scores</span> <span class="k">as</span> <span class="p">[</span><span class="kt">AnyObject</span><span class="p">],</span> <span class="nv">withName</span><span class="p">:</span> <span class="s">"HighScores"</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre>
</div>

<p>When you want to get the cached results for the query, you can then
      run the same query against the local datastore.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">fromLocalDatastore</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">orderByDescending</span><span class="p">:</span><span class="s">@"score"</span><span class="p">];</span>

<span class="p">[[</span><span class="n">query</span> <span class="nf">findObjectsInBackground</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Something went wrong.
</span>    <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="c1">// Yay! Cached scores!
</span>  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">fromLocalDatastore</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">orderByDescending</span><span class="p">(</span><span class="s">"score"</span><span class="p">)</span>

<span class="n">query</span><span class="o">.</span><span class="nf">findObjectsInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="c1">// There was an error.</span>
        <span class="k">return</span> <span class="n">task</span>
    <span class="p">}</span>

    <span class="c1">// Yay! Cached scores!</span>
    <span class="k">return</span> <span class="n">task</span>
<span class="p">})</span>
</code></pre>
</div>

<h2 id="syncing-local-changes">Syncing Local Changes</h2>

<p>Once you’ve saved some changes locally, there are a few different ways you can save those changes back to Parse over the network. The easiest way to do this is with <code class="highlighter-rouge">saveEventually</code>. When you call <code class="highlighter-rouge">saveEventually</code> on a <code class="highlighter-rouge">%{ParseObject}</code>, it will be pinned until it can be saved. The SDK will make sure to save the object the next time the network is available.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">gameScore</span> <span class="nf">saveEventually</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">gameScore</span><span class="o">.</span><span class="nf">saveEventually</span><span class="p">()</span>
</code></pre>
</div>

<p>If you’d like to have more control over the way objects are synced, you can keep them in the local datastore until you are ready to save them yourself using <code class="highlighter-rouge">saveInBackground</code>. To manage the set of objects that need to be saved, you can again use a label. The <code class="highlighter-rouge">fromPinWithName:</code> method on <code class="highlighter-rouge">%{ParseQuery}</code> makes it easy to fetch just the objects you care about.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"GameScore"</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">fromPinWithName</span><span class="p">:</span><span class="s">@"MyChanges"</span><span class="p">];</span>
<span class="p">[[</span><span class="n">query</span> <span class="nf">findObjectsInBackground</span><span class="p">]</span> <span class="nf">continueWithBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">NSArray</span> <span class="o">*</span><span class="n">scores</span> <span class="o">=</span> <span class="n">task</span><span class="p">.</span><span class="n">result</span><span class="err">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">score</span> <span class="k">in</span> <span class="n">scores</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[[</span><span class="n">score</span> <span class="nf">saveInBackground</span><span class="p">]</span> <span class="nf">continueWithSuccessBlock</span><span class="p">:</span><span class="o">^</span><span class="n">id</span><span class="p">(</span><span class="n">BFTask</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">score</span> <span class="nf">unpinInBackground</span><span class="p">]</span><span class="err">;</span>
    <span class="p">}]</span><span class="err">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">task</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span><span class="s">"GameScore"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">fromPinWithName</span><span class="p">(</span><span class="s">"MyChanges"</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="nf">findObjectsInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithBlock</span><span class="p">({</span>
  <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
  <span class="k">let</span> <span class="nv">scores</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span> <span class="k">as</span> <span class="kt">NSArray</span>
  <span class="k">for</span> <span class="n">score</span> <span class="k">in</span> <span class="n">scores</span> <span class="p">{</span>
    <span class="n">score</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span><span class="o">.</span><span class="nf">continueWithSuccessBlock</span><span class="p">({</span>
      <span class="p">(</span><span class="nv">task</span><span class="p">:</span> <span class="kt">BFTask</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">AnyObject</span><span class="o">!</span> <span class="k">in</span>
      <span class="k">return</span> <span class="n">score</span><span class="o">.</span><span class="nf">unpinInBackground</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">task</span>
<span class="p">})</span>
</code></pre>
</div>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="app-extensions">App Extensions</h1>

<p>Local data sharing in Parse SDKs allows you do share persistent local data between your main application and extensions that it contains, including Keyboard, Share/Today/Photo/Action extensions and Document Providers.</p>

<h2 id="shared-local-data">Shared Local Data</h2>

<p>All local data that is persistent can be shared between apps and multiple extensions:</p>

<ul>
  <li><code class="highlighter-rouge">PFUser currentUser</code></li>
  <li>Facebook/Twitter authentication attached to <code class="highlighter-rouge">currentUser</code></li>
  <li><code class="highlighter-rouge">PFInstallation currentInstallation</code></li>
  <li><code class="highlighter-rouge">installationId</code> which is used for Analytics events</li>
  <li><code class="highlighter-rouge">saveEventually</code> and <code class="highlighter-rouge">deleteEventually</code> pending operations</li>
  <li>Pinned objects in Local Datastore</li>
</ul>

<p>We do not recommend storing large pieces of data inside these persistent objects, both with and without data sharing enabled, as it might impact the performance of how fast this data is saved and loaded.</p>

<p>Furthermore, if you are using Local Datastore with data sharing - we recommend that you divide your objects amongst multiple pins, as querying and persisting data in a smaller pin is usually faster.</p>

<h2 id="enable-data-sharing">Enable Data Sharing</h2>

<p>To share your local data between app and extensions you need to do the following:</p>

<ul>
  <li>Enable <strong>App Groups</strong> and <strong>Keychain Sharing</strong> in <strong>both</strong> your app and extension capabilities in Xcode.
Please note, that App Group identifier and Keychain Group should be the same between your app and all extensions for data sharing to work.
<img src="https://parse.com/images/docs/extensions/capabilities.png" alt="" /></li>
  <li>Add the following before you initialize Parse in your Main App:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Enable data sharing in main app.
</span><span class="p">[</span><span class="n">Parse</span> <span class="nf">enableDataSharingWithApplicationGroupIdentifier</span><span class="p">:</span><span class="s">@"group.com.parse.parseuidemo"</span><span class="p">];</span>
<span class="c1">// Setup Parse
</span><span class="p">[</span><span class="n">Parse</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"&lt;ParseAppId&gt;"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"&lt;ClientKey&gt;"</span><span class="p">];</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Enable data sharing in main app.</span>
<span class="kt">Parse</span><span class="o">.</span><span class="nf">enableDataSharingWithApplicationGroupIdentifier</span><span class="p">(</span><span class="s">"group.com.parse.parseuidemo"</span><span class="p">)</span>
<span class="c1">// Setup Parse</span>
<span class="kt">Parse</span><span class="o">.</span><span class="nf">setApplicationId</span><span class="p">(</span><span class="s">"&lt;ParseAppId&gt;"</span><span class="p">,</span> <span class="nv">clientKey</span><span class="p">:</span> <span class="s">"&lt;ClientKey&gt;"</span><span class="p">)</span>
</code></pre>
</div>

<ul>
  <li>Add the following before you initialize Parse in your App Extension:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Enable data sharing in app extensions.
</span><span class="p">[</span><span class="n">Parse</span> <span class="nf">enableDataSharingWithApplicationGroupIdentifier</span><span class="p">:</span><span class="s">@"group.com.parse.parseuidemo"</span>
                                 <span class="nf">containingApplication</span><span class="p">:</span><span class="s">@"com.parse.parseuidemo"</span><span class="p">];</span>
<span class="c1">// Setup Parse
</span><span class="p">[</span><span class="n">Parse</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"&lt;ParseAppId&gt;"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"&lt;ClientKey&gt;"</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Enable data sharing in main app.</span>
<span class="kt">Parse</span><span class="o">.</span><span class="nf">enableDataSharingWithApplicationGroupIdentifier</span><span class="p">(</span><span class="s">"group.com.parse.parseuidemo"</span><span class="p">,</span>
                            <span class="nv">containingApplicaiton</span><span class="p">:</span> <span class="s">"com.parse.parseuidemo"</span><span class="p">)</span>
<span class="c1">// Setup Parse</span>
<span class="kt">Parse</span><span class="o">.</span><span class="nf">setApplicationId</span><span class="p">(</span><span class="s">"&lt;ParseAppId&gt;"</span><span class="p">,</span> <span class="nv">clientKey</span><span class="p">:</span> <span class="s">"&lt;ClientKey&gt;"</span><span class="p">)</span>
</code></pre>
</div>

<p>As you might have noticed - there are few pieces of information that need to be in sync for this to work and be enabled:</p>

<ul>
  <li><strong>Application Group Identifier</strong> - is the identifier of a shared container that Parse SDK is going to use to persist data locally and share the data.</li>
  <li><strong>Keychain Sharing</strong> means that your app and extension can access data that is securely stored in the keychain.</li>
  <li><strong>Containing Application Identifier</strong> is your main apps bundle identifier. This is required for app extensions to know which application to talk to.</li>
</ul>

<p>This process is required to be completed for both your main application and any extension.</p>

<p>After all these steps are done, you are all set and all data will be shared between your app and any app extension that the app contains.</p>

<p>If you have an existing app using the Parse SDK, when users upgrade to your latest app version (with data sharing enabled), the Parse SDK will automatically move the main app’s local persistent data (Local Datastore, current <code class="highlighter-rouge">%{ParseUser}</code>, current <code class="highlighter-rouge">%{ParseInstallation}</code>, etc) from the app’s sandbox container to the shared container.
This migration is irreversible; if you later release another app version with data sharing disabled,
we will not move the shared container’s data back into the main app’s sandbox container.
For more about the app/extension shared container, please see Apple’s <a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple_ref/doc/uid/TP40014214-CH21-SW6">documentation</a>.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="push-notifications">Push Notifications</h1>

<p>Push Notifications are a great way to keep your users engaged and informed about your app. You can reach your entire user base quickly and effectively. This guide will help you through the setup process and the general usage of Parse to send push notifications.</p>

<p>If you haven’t installed the SDK yet, please <a href="https://github.com/ParsePlatform/parse-server/wiki/Push#quick-start">head over to the Push QuickStart</a> to get our SDK up and running.</p>

<h2 id="setting-up-push">Setting Up Push</h2>

<p>If you want to start using push, start by completing the <a href="https://github.com/ParsePlatform/parse-server/wiki/Push#quick-start">Push Notifications QuickStart</a> to learn how to configure your app. Come back to this guide afterwards to learn more about the push features offered by Parse.</p>

<h2 id="installations">Installations</h2>

<p>Every Parse application installed on a device registered for push notifications has an associated %{ParseInstallation} object. The %{ParseInstallation} object is where you store all the data needed to target push notifications. For example, in a baseball app, you could store the teams a user is interested in to send updates about their performance. Saving the %{ParseInstallation} object is also required for tracking push-related app open events.</p>

<p>In iOS or OS X, <code class="highlighter-rouge">Installation</code> objects are available through the <code class="highlighter-rouge">%{ParseInstallation}</code> class, a subclass of <code class="highlighter-rouge">%{ParseObject}</code>. It uses the <a href="#objects">same API</a> for storing and retrieving data. To access the current <code class="highlighter-rouge">Installation</code> object from your app, use the <code class="highlighter-rouge">[PFInstallation currentInstallation]</code> method. The first time you save a <code class="highlighter-rouge">%{ParseInstallation}</code>, Parse will add it to your <code class="highlighter-rouge">Installation</code> class, and it will be available for targeting push notifications as long as its <code class="highlighter-rouge">deviceToken</code> field is set.</p>

<p>First, make your app register for remote notifications by adding the following in your <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code> method (if you haven’t already):</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">UIUserNotificationType</span> <span class="n">userNotificationTypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">UIUserNotificationTypeAlert</span> <span class="o">|</span> <span class="n">UIUserNotificationTypeBadge</span> <span class="o">|</span> <span class="n">UIUserNotificationTypeSound</span><span class="p">);</span>
<span class="n">UIUserNotificationSettings</span> <span class="o">*</span><span class="n">settings</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIUserNotificationSettings</span> <span class="nf">settingsForTypes</span><span class="p">:</span><span class="n">userNotificationTypes</span>  <span class="nf">categories</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">[</span><span class="n">application</span> <span class="nf">registerUserNotificationSettings</span><span class="p">:</span><span class="n">settings</span><span class="p">];</span>
<span class="p">[</span><span class="n">application</span> <span class="nf">registerForRemoteNotifications</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">userNotificationTypes</span><span class="p">:</span> <span class="kt">UIUserNotificationType</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="kt">Alert</span><span class="p">,</span> <span class="o">.</span><span class="kt">Badge</span><span class="p">,</span> <span class="o">.</span><span class="kt">Sound</span><span class="p">]</span>

<span class="k">let</span> <span class="nv">settings</span> <span class="o">=</span> <span class="kt">UIUserNotificationSettings</span><span class="p">(</span><span class="nv">forTypes</span><span class="p">:</span> <span class="n">userNotificationTypes</span><span class="p">,</span> <span class="nv">categories</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="n">application</span><span class="o">.</span><span class="nf">registerUserNotificationSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="n">application</span><span class="o">.</span><span class="nf">registerForRemoteNotifications</span><span class="p">()</span>
</code></pre>
</div>

<p>We will then update our <code class="highlighter-rouge">%{ParseInstallation}</code> with the <code class="highlighter-rouge">deviceToken</code> once the device is registered for push notifications:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didRegisterForRemoteNotificationsWithDeviceToken</span><span class="p">:(</span><span class="n">NSData</span> <span class="o">*</span><span class="p">)</span><span class="nv">deviceToken</span> <span class="p">{</span>
  <span class="c1">// Store the deviceToken in the current Installation and save it to Parse
</span>  <span class="n">PFInstallation</span> <span class="o">*</span><span class="n">currentInstallation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
  <span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">setDeviceTokenFromData</span><span class="p">:</span><span class="n">deviceToken</span><span class="p">];</span>
  <span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">saveInBackground</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didRegisterForRemoteNotificationsWithDeviceToken</span> <span class="nv">deviceToken</span><span class="p">:</span> <span class="kt">NSData</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Store the deviceToken in the current Installation and save it to Parse</span>
  <span class="k">let</span> <span class="nv">installation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
  <span class="n">installation</span><span class="o">.</span><span class="nf">setDeviceTokenFromData</span><span class="p">(</span><span class="n">deviceToken</span><span class="p">)</span>
  <span class="n">installation</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
</div>

<p>While it is possible to modify a <code class="highlighter-rouge">%{ParseInstallation}</code> just like you would a <code class="highlighter-rouge">%{ParseObject}</code>, there are several special fields that help manage and target devices.</p>

<ul>
  <li><strong><code class="highlighter-rouge">channels</code></strong>: An array of the channels to which a device is currently subscribed.</li>
  <li><strong><code class="highlighter-rouge">badge</code></strong>: The current value of the icon badge for iOS/OS X apps. Changing this value on the <code class="highlighter-rouge">%{ParseInstallation}</code> will update the badge value on the app icon. Changes should be saved to the server so that they will be used for future badge-increment push notifications.</li>
  <li><strong><code class="highlighter-rouge">installationId</code></strong>: Unique Id for the device used by Parse <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">deviceType</code></strong>: The type of device, “ios”, “osx”, “android”, “winrt”, “winphone”, “dotnet”, or “embedded”. On iOS and OS X devices, this field will be set to “ios” and “osx”, respectively <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">deviceToken</code></strong>: The Apple generated token used for iOS/OS X devices. On Android devices, this is the token used by GCM to keep track of registration ID <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">appName</code></strong>: The display name of the client application to which this installation belongs. In iOS/OS X, this value is obtained from <code class="highlighter-rouge">kCFBundleNameKey</code>. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">appVersion</code></strong>: The version string of the client application to which this installation belongs. In iOS/OS X, this value is obtained from <code class="highlighter-rouge">kCFBundleVersionKey</code>. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">appIdentifier</code></strong>: A unique identifier for this installation’s client application. In iOS/OS X, this value is obtained from <code class="highlighter-rouge">kCFBundleIdentifierKey</code>. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">parseVersion</code></strong>: The version of the Parse SDK which this installation uses. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">timeZone</code></strong>: The current time zone where the target device is located. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">localeIdentifier</code></strong>: The locale identifier of the device in the format [language code]-[COUNTRY CODE]. The language codes are two-letter lowercase ISO language codes (such as “en”) as defined by <a href="http://en.wikipedia.org/wiki/ISO_639-1">ISO 639-1</a>. The country codes are two-letter uppercase ISO country codes (such as “US”) as defined by <a href="&quot;http://en.wikipedia.org/wiki/ISO_3166-1_alpha-3&quot;">ISO 3166-1</a>. This value is synchronized every time an <code class="highlighter-rouge">%{ParseInstallation}</code> object is saved from the device <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">pushType</code></strong>: This field is reserved for directing Parse to the push delivery network to be used for Android devices. This parameter is not supported in iOS/OS X devices <em>(readonly)</em>.</li>
  <li><strong><code class="highlighter-rouge">GCMSenderId</code></strong>: This field only has meaning for Android <code class="highlighter-rouge">%{ParseInstallation}</code>s that use the GCM push type. This parameter is not supported in iOS/OS X devices.</li>
  <li><strong><code class="highlighter-rouge">channelUris</code></strong>: The Microsoft-generated push URIs for Windows devices <em>(readonly)</em>.</li>
</ul>

<p>The Parse SDK will avoid making unnecessary requests. If a <code class="highlighter-rouge">%{ParseInstallation}</code> is saved on the device, a request to the Parse servers will only be made if one of the <code class="highlighter-rouge">%{ParseInstallation}</code>’s fields has been explicitly updated.</p>

<h2 id="sending-pushes">Sending Pushes</h2>

<p>There are two ways to send push notifications using Parse: <a href="#push-notifications-using-channels">channels</a> and <a href="#push-notifications-using-advanced-targeting">advanced targeting</a>. Channels offer a simple and easy to use model for sending pushes, while advanced targeting offers a more powerful and flexible model. Both are fully compatible with each other and will be covered in this section.</p>

<p>Sending notifications is often done from the Parse.com push console, the <a href="/docs/rest/guide#push-notifications-sending-pushes">REST API</a> or from <a href="/docs/js/guide#push-notifications-sending-pushes">Cloud Code</a>. However, push notifications can also be triggered by the existing client SDKs. If you decide to send notifications from the client SDKs, you will need to set <strong>Client Push Enabled</strong> in the Push Notifications settings of your Parse app.</p>

<p>However, be sure you understand that enabling Client Push can  lead to a security vulnerability in your app, as outlined <a href="http://blog.parse.com/2014/09/03/the-dangerous-world-of-client-push/">on our blog</a>.  We recommend that you enable Client Push for testing purposes only,  and move your push notification logic into Cloud Code  when your app is ready to go into production.</p>

<p><img src="https://parse.com/images/docs/client_push_settings.png" alt="" /></p>

<p>You can view your past push notifications on the Parse.com push console for up to 30 days after creating your push.  For pushes scheduled in the future, you can delete the push on the push console as long as no sends have happened yet. After you send the push, the push console shows push analytics graphs.</p>

<h3 id="using-channels">Using Channels</h3>

<p>The simplest way to start sending notifications is using channels. This allows you to use a publisher-subscriber model for sending pushes. Devices start by subscribing to one or more channels, and notifications can later be sent to these subscribers. The channels subscribed to by a given <code class="highlighter-rouge">Installation</code> are stored in the <code class="highlighter-rouge">channels</code> field of the <code class="highlighter-rouge">Installation</code> object.</p>

<h4 id="subscribing-to-channels">Subscribing to Channels</h4>

<p>A channel is identified by a string that starts with a letter and consists of alphanumeric characters, underscores, and dashes. It doesn’t need to be explicitly created before it can be used and each <code class="highlighter-rouge">Installation</code> can subscribe to any number of channels at a time.</p>

<p>Adding a channel subscription can be done using the <code class="highlighter-rouge">addUniqueObject:</code> method in <code class="highlighter-rouge">%{ParseObject}</code>. For example, in a baseball score app, we could do:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// When users indicate they are Giants fans, we subscribe them to that channel.
</span><span class="n">PFInstallation</span> <span class="o">*</span><span class="n">currentInstallation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
<span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">addUniqueObject</span><span class="p">:</span><span class="s">@"Giants"</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"channels"</span><span class="p">];</span>
<span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// When users indicate they are Giants fans, we subscribe them to that channel.</span>
<span class="k">let</span> <span class="nv">currentInstallation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
<span class="n">currentInstallation</span><span class="o">.</span><span class="nf">addUniqueObject</span><span class="p">(</span><span class="s">"Giants"</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"channels"</span><span class="p">)</span>
<span class="n">currentInstallation</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Once subscribed to the “Giants” channel, your <code class="highlighter-rouge">Installation</code> object should have an updated <code class="highlighter-rouge">channels</code> field.</p>

<p><img src="https://parse.com/images/docs/installation_channel.png" alt="" /></p>

<p>Unsubscribing from a channel is just as easy:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// When users indicate they are no longer Giants fans, we unsubscribe them.
</span><span class="n">PFInstallation</span> <span class="o">*</span><span class="n">currentInstallation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
<span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">removeObject</span><span class="p">:</span><span class="s">@"Giants"</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"channels"</span><span class="p">];</span>
<span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// When users indicate they are Giants fans, we subscribe them to that channel.</span>
<span class="k">let</span> <span class="nv">currentInstallation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
<span class="n">currentInstallation</span><span class="o">.</span><span class="nf">removeObject</span><span class="p">(</span><span class="s">"Giants"</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"channels"</span><span class="p">)</span>
<span class="n">currentInstallation</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>The set of subscribed channels is cached in the <code class="highlighter-rouge">currentInstallation</code> object:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSArray</span> <span class="o">*</span><span class="n">subscribedChannels</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">].</span><span class="n">channels</span><span class="p">;</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">subscribedChannels</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span><span class="o">.</span><span class="n">channels</span>
</code></pre>
</div>

<p>If you plan on changing your channels from Cloud Code or the data browser, note that you’ll need to call some form of <code class="highlighter-rouge">fetch</code> prior to this line in order to get the most recent channels.</p>

<h4 id="sending-pushes-to-channels">Sending Pushes to Channels</h4>

<p>In the iOS/OS X SDK, the following code can be used to alert all subscribers of the “Giants” channel that their favorite team just scored. This will display a notification center alert to iOS/OS X users and a system tray notification to Android users.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Send a notification to all devices subscribed to the "Giants" channel.
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setChannel</span><span class="p">:</span><span class="s">@"Giants"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"The Giants just scored!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Send a notification to all devices subscribed to the "Giants" channel.</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setChannel</span><span class="p">(</span><span class="s">"Giants"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"The Giants just scored!"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>If you want to target multiple channels with a single push notification, you can use an <code class="highlighter-rouge">NSArray</code> of channels.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSArray</span> <span class="o">*</span><span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSArray</span> <span class="nf">arrayWithObjects</span><span class="p">:</span><span class="s">@"Giants"</span><span class="p">,</span> <span class="s">@"Mets"</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>

<span class="c1">// Be sure to use the plural 'setChannels'.
</span><span class="p">[</span><span class="n">push</span> <span class="nf">setChannels</span><span class="p">:</span><span class="n">channels</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"The Giants won against the Mets 2-3."</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">channels</span> <span class="o">=</span> <span class="p">[</span> <span class="s">"Giants"</span><span class="p">,</span> <span class="s">"Mets"</span> <span class="p">];</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>

<span class="c1">// Be sure to use the plural 'setChannels'.</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"The Giants won against the Mets 2-3."</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="using-advanced-targeting">Using Advanced Targeting</h3>

<p>While channels are great for many applications, sometimes you need more precision when targeting the recipients of your pushes. Parse allows you to write a query for any subset of your <code class="highlighter-rouge">Installation</code> objects using the <a href="#queries">querying API</a> and to send them a push.</p>

<p>Since <code class="highlighter-rouge">%{ParseInstallation}</code> is a subclass of <code class="highlighter-rouge">%{ParseObject}</code>, you can save any data you want and even create relationships between <code class="highlighter-rouge">Installation</code> objects and your other objects. This allows you to send pushes to a very customized and dynamic segment of your user base.</p>

<h4 id="saving-installation-data">Saving Installation Data</h4>

<p>Storing data on an <code class="highlighter-rouge">Installation</code> object is just as easy as storing <a href="#objects">any other data</a> on Parse. In our Baseball app, we could allow users to get pushes about game results, scores and injury reports.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Store app language and version
</span><span class="n">PFInstallation</span> <span class="o">*</span><span class="n">installation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
<span class="p">[</span><span class="n">installation</span> <span class="nf">setObject</span><span class="p">:</span><span class="nb">@YES</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"scores"</span><span class="p">];</span>
<span class="p">[</span><span class="n">installation</span> <span class="nf">setObject</span><span class="p">:</span><span class="nb">@YES</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"gameResults"</span><span class="p">];</span>
<span class="p">[</span><span class="n">installation</span> <span class="nf">setObject</span><span class="p">:</span><span class="nb">@YES</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"injuryReports"</span><span class="p">];</span>
<span class="p">[</span><span class="n">installation</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Store app language and version</span>
<span class="k">let</span> <span class="nv">installation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
<span class="n">installation</span><span class="p">[</span><span class="s">"scores"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">installation</span><span class="p">[</span><span class="s">"gameResults"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">installation</span><span class="p">[</span><span class="s">"injuryReports"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
<span class="n">installation</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>You can even create relationships between your <code class="highlighter-rouge">Installation</code> objects and other classes saved on Parse. To associate a PFInstallation with a particular user, for example, you can simply store the current user on the <code class="highlighter-rouge">%{ParseInstallation}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Associate the device with a user
</span><span class="n">PFInstallation</span> <span class="o">*</span><span class="n">installation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
<span class="n">installation</span><span class="p">[</span><span class="s">@"user"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">];</span>
<span class="p">[</span><span class="n">installation</span> <span class="nf">saveInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Associate the device with a user</span>
<span class="k">let</span> <span class="nv">installation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
<span class="n">installation</span><span class="p">[</span><span class="s">"user"</span><span class="p">]</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span>
<span class="n">installation</span><span class="o">.</span><span class="nf">saveInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h4 id="sending-pushes-to-queries">Sending Pushes to Queries</h4>

<p>Once you have your data stored on your <code class="highlighter-rouge">Installation</code> objects, you can use a <code class="highlighter-rouge">%{ParseQuery}</code> to target a subset of these devices. <code class="highlighter-rouge">Installation</code> queries work just like any other <a href="#queries">Parse query</a>, but we use the special static method <code class="highlighter-rouge">[PFInstallation query]</code> to create it. We set this query on our <code class="highlighter-rouge">PFPush</code> object, before sending the notification.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create our Installation query
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">pushQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">pushQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"injuryReports"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="nb">@YES</span><span class="p">];</span>

<span class="c1">// Send push notification to query
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">pushQuery</span><span class="p">];</span> <span class="c1">// Set our Installation query
</span><span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Willie Hayes injured by own pop fly."</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create our Installation query</span>
<span class="k">let</span> <span class="nv">pushQuery</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">pushQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"injuryReports"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>

<span class="c1">// Send push notification to query</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">pushQuery</span><span class="p">)</span> <span class="c1">// Set our Installation query</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Willie Hayes injured by own pop fly."</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>We can even use channels with our query. To send a push to all subscribers of the “Giants” channel but filtered by those who want score update, we can do the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create our Installation query
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">pushQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">pushQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"channels"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"Giants"</span><span class="p">];</span> <span class="c1">// Set channel
</span><span class="p">[</span><span class="n">pushQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"scores"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="nb">@YES</span><span class="p">];</span>

<span class="c1">// Send push notification to query
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">pushQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Giants scored against the A's! It's now 2-2."</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create our Installation query</span>
<span class="k">let</span> <span class="nv">pushQuery</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">pushQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"channels"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span><span class="s">"Giants"</span><span class="p">)</span> <span class="c1">// Set channel</span>
<span class="n">pushQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"scores"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span><span class="kc">true</span><span class="p">)</span>

<span class="c1">// Send push notification to query</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">pushQuery</span><span class="p">)</span> <span class="c1">// Set our Installation query</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Giants scored against the A's! It's now 2-2."</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>If we store relationships to other objects in our <code class="highlighter-rouge">Installation</code> class, we can also use those in our query. For example, we could send a push notification to all users near a given location like this.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find users near a given location
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">userQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">userQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"location"</span>    <span class="nf">nearGeoPoint</span><span class="p">:</span><span class="n">stadiumLocation</span> <span class="nf">withinMiles</span><span class="p">:</span><span class="mi">@1</span><span class="p">]</span>

<span class="c1">// Find devices associated with these users
</span><span class="n">PFQuery</span> <span class="o">*</span><span class="n">pushQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">pushQuery</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"user"</span> <span class="nf">matchesQuery</span><span class="p">:</span><span class="n">userQuery</span><span class="p">];</span>

<span class="c1">// Send push notification to query
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">pushQuery</span><span class="p">];</span> <span class="c1">// Set our Installation query
</span><span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Free hotdogs at the Parse concession stand!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Find users near a given location</span>
<span class="k">let</span> <span class="nv">userQuery</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">userQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"location"</span><span class="p">,</span> <span class="nv">nearGeoPoint</span><span class="p">:</span> <span class="n">stadiumLocation</span><span class="p">,</span> <span class="nv">withinMiles</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">// Find devices associated with these users</span>
<span class="k">let</span> <span class="nv">pushQuery</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="n">pushQuery</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span> <span class="nv">matchesQuery</span><span class="p">:</span> <span class="n">userQuery</span><span class="p">)</span>

<span class="c1">// Send push notification to query</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">pushQuery</span><span class="p">)</span> <span class="c1">// Set our Installation query</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Free hotdogs at the Parse concession stand!"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="sending-options">Sending Options</h2>

<p>Push notifications can do more than just send a message. On iOS/OS X, pushes can also include the sound to be played, the badge number to display as well as any custom data you wish to send. An expiration date can also be set for the notification in case it is time sensitive.</p>

<h3 id="customizing-your-notifications">Customizing your Notifications</h3>

<p>If you want to send more than just a message, you will need to use an <code class="highlighter-rouge">NSDictionary</code> to package all of the data. There are some reserved fields that have a special meaning.</p>

<ul>
  <li><strong><code class="highlighter-rouge">alert</code></strong>:   the notification’s message.</li>
  <li><strong><code class="highlighter-rouge">badge</code></strong>: <em>(iOS/OS X only)</em>   the value indicated in the top right corner of the app icon.   This can be set to a value   or to <code class="highlighter-rouge">Increment</code> in order to increment the current value by 1.</li>
  <li><strong><code class="highlighter-rouge">sound</code></strong>: <em>(iOS/OS X only)</em>   the name of a sound file in the application bundle.</li>
  <li><strong><code class="highlighter-rouge">content-available</code></strong>: <em>(iOS only)</em> If you are a writing a <a href="http://developer.apple.com/library/iOS/#technotes/tn2280/_index.html">Newsstand</a> app, or an app using the Remote Notification Background Mode <a href="https://developer.apple.com/library/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS7.html#//apple_ref/doc/uid/TP40013162-SW10"> introduced in iOS7</a> (a.k.a. “Background Push”), set this value to 1 to trigger a background download.</li>
  <li><strong><code class="highlighter-rouge">category</code></strong>: <em>(iOS only)</em> the identifier of th   <a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIUserNotificationCategory_class/index.html#//apple_ref/occ/cl/UIUserNotificationCategory">   <code class="highlighter-rouge">UIUserNotificationCategory</code></a> for this push notification.</li>
  <li><strong><code class="highlighter-rouge">uri</code></strong>: <em>(Android only)</em>   an optional field that contains a URI. When the   notification is opened, an <code class="highlighter-rouge">Activity</code> associate   with opening the URI is launched.</li>
  <li><strong><code class="highlighter-rouge">title</code></strong>: <em>(Android, Windows 8, and Windows Phone 8 only)</em>   the value displayed in the Android system tray or Windows toast notification.</li>
</ul>

<p>For example, to send a notification that increases the current badge number by 1 and plays a custom sound, you can do the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSDictionary</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span>
  <span class="s">@"alert"</span> <span class="o">:</span> <span class="s">@"The Mets scored! The game is now tied 1-1!"</span><span class="p">,</span>
  <span class="s">@"badge"</span> <span class="o">:</span> <span class="s">@"Increment"</span><span class="p">,</span>
  <span class="s">@"sounds"</span> <span class="o">:</span> <span class="s">@"cheering.caf"</span>
<span class="p">};</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setChannels</span><span class="p">:@[</span> <span class="s">@"Mets"</span> <span class="p">]];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setData</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s">"alert"</span> <span class="p">:</span> <span class="s">"The Mets scored! The game is now tied 1-1!"</span><span class="p">,</span>
  <span class="s">"badge"</span> <span class="p">:</span> <span class="s">"Increment"</span><span class="p">,</span>
  <span class="s">"sounds"</span> <span class="p">:</span> <span class="s">"cheering.caf"</span>
<span class="p">]</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setChannels</span><span class="p">([</span><span class="s">"Mets"</span><span class="p">])</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>It is also possible to specify your own data in this dictionary. As we’ll see in the <a href="#push-notifications-receiving-pushes">Receiving Notifications</a> section, you will have access to this data only when the user opens your app via the notification. This can be useful for displaying a different view controller when a user opens certain notifications.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSDictionary</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span>
  <span class="s">@"alert"</span> <span class="o">:</span> <span class="s">@"Ricky Vaughn was injured in last night's game!"</span><span class="p">,</span>
  <span class="s">@"name"</span> <span class="o">:</span> <span class="s">@"Vaughn"</span><span class="p">,</span>
  <span class="s">@"newsItem"</span> <span class="o">:</span> <span class="s">@"Man bites dog"</span>
<span class="p">};</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">injuryReportsQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setChannel</span><span class="p">:</span><span class="s">@"Indians"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setData</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s">"alert"</span> <span class="p">:</span> <span class="s">"Ricky Vaughn was injured in last night's game!"</span><span class="p">,</span>
  <span class="s">"name"</span> <span class="p">:</span> <span class="s">"Vaughn"</span><span class="p">,</span>
  <span class="s">"newsItem"</span> <span class="p">:</span> <span class="s">"Man bites dog"</span>
<span class="p">]</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">injuryReportsdata</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setChannel</span><span class="p">(</span><span class="s">"Indians"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>Whether your push notifications increment the app’s badge or set it to a specific value, your app will eventually need to clear its badge. This is covered in <a href="#push-notifications-receiving-pushes">Clearing the Badge</a>.</p>

<h3 id="setting-an-expiration-date">Setting an Expiration Date</h3>

<p>When a user’s device is turned off or not connected to the internet, push notifications cannot be delivered. If you have a time sensitive notification that is not worth delivering late, you can set an expiration date. This avoids needlessly alerting users of information that may no longer be relevant.</p>

<p>There are two methods provided by the <code class="highlighter-rouge">PFPush</code> class to allow setting an expiration date for your notification. The first is <code class="highlighter-rouge">expireAtDate:</code> which simply takes an <code class="highlighter-rouge">NSDate</code> specifying when Parse should stop trying to send the notification.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create date object for tomorrow
</span><span class="n">NSDateComponents</span> <span class="o">*</span><span class="n">comps</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSDateComponents</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">comps</span> <span class="nf">setYear</span><span class="p">:</span><span class="mi">2015</span><span class="p">];</span>
<span class="p">[</span><span class="n">comps</span> <span class="nf">setMonth</span><span class="p">:</span><span class="mi">8</span><span class="p">];</span>
<span class="p">[</span><span class="n">comps</span> <span class="nf">setDay</span><span class="p">:</span><span class="mi">14</span><span class="p">];</span>
<span class="n">NSCalendar</span> <span class="o">*</span><span class="n">gregorian</span> <span class="o">=</span>
  <span class="p">[[</span><span class="n">NSCalendar</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithCalendarIdentifier</span><span class="p">:</span><span class="n">NSGregorianCalendar</span><span class="p">];</span>
<span class="n">NSDate</span> <span class="o">*</span><span class="n">date</span> <span class="o">=</span> <span class="p">[</span><span class="n">gregorian</span> <span class="nf">dateFromComponents</span><span class="p">:</span><span class="n">comps</span><span class="p">];</span>

<span class="c1">// Send push notification with expiration date
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">expireAtDate</span><span class="p">:</span><span class="n">date</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">everyoneQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Season tickets on sale until August 8th!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create date object for tomorrow</span>
<span class="k">let</span> <span class="nv">comps</span> <span class="o">=</span> <span class="kt">NSDateComponents</span><span class="p">()</span>
<span class="n">comps</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2015</span>
<span class="n">comps</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">comps</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="mi">14</span>
<span class="k">let</span> <span class="nv">gregorian</span> <span class="o">=</span> <span class="kt">NSCalendar</span><span class="p">(</span><span class="nv">calendarIdentifier</span><span class="p">:</span> <span class="kt">NSGregorianCalendar</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">date</span> <span class="o">=</span> <span class="n">gregorian</span><span class="o">!.</span><span class="nf">dateFromComponents</span><span class="p">(</span><span class="n">comps</span><span class="p">);</span>

<span class="c1">// Send push notification with expiration</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">expireAtDate</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">everyoneQuery</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Season tickets on sale until August 8th!"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>There is however a caveat with this method. Since device clocks are not guaranteed to be accurate, you may end up with inaccurate results. For this reason, the <code class="highlighter-rouge">PFPush</code> class also provides the <code class="highlighter-rouge">expireAfterTimeInterval:</code> method which accepts an <code class="highlighter-rouge">NSTimeInterval</code> object. The notification will expire after the specified interval has elapsed.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create time interval
</span><span class="n">NSTimeInterval</span> <span class="n">interval</span> <span class="o">=</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// 1 week
</span>
<span class="c1">// Send push notification with expiration interval
</span><span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">expireAfterTimeInterval</span><span class="p">:</span><span class="n">interval</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">everyoneQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Season tickets on sale until next week!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Create time interval</span>
<span class="k">let</span> <span class="nv">interval</span> <span class="o">=</span> <span class="mf">60*60*24*</span><span class="mi">7</span><span class="p">;</span> <span class="c1">// 1 week</span>

<span class="c1">// Send push notification with expiration interval</span>

<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">expireAfterTimeInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">everyoneQuery</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Season tickets on sale until next week!"</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="targeting-by-platform">Targeting by Platform</h3>

<p>If you build a cross platform app, it is possible you may only want to target devices of a particular operating system. Advanced Targeting allow you to filter which of these devices are targeted.</p>

<p>The following example would send a different notification to Android, iOS, and Windows users.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"channels"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"suitcaseOwners"</span><span class="p">];</span>

<span class="c1">// Notification for Android users
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"deviceType"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"android"</span><span class="p">];</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">androidPush</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">androidPush</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Your suitcase has been filled with tiny robots!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">androidPush</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">androidPush</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>

<span class="c1">// Notification for iOS users
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"deviceType"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"ios"</span><span class="p">];</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">iOSPush</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">iOSPush</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Your suitcase has been filled with tiny apples!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">iOSPush</span> <span class="nf">setChannel</span><span class="p">:</span><span class="s">@"suitcaseOwners"</span><span class="p">];</span>
<span class="p">[</span><span class="n">iOSPush</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">iOSPush</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>

<span class="c1">// Notification for Windows 8 users
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"deviceType"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"winrt"</span><span class="p">];</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">winPush</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">winPush</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Your suitcase has been filled with tiny glass!"</span><span class="p">];</span>
<span class="p">[</span><span class="n">winPush</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">winPush</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>

<span class="c1">// Notification for Windows Phone 8 users
</span><span class="p">[</span><span class="n">query</span> <span class="nf">whereKey</span><span class="p">:</span><span class="s">@"deviceType"</span> <span class="nf">equalTo</span><span class="p">:</span><span class="s">@"winphone"</span><span class="p">];</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">wpPush</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">wpPush</span> <span class="nf">setMessage</span><span class="p">:</span><span class="s">@"Your suitcase is very hip; very metro."</span><span class="p">];</span>
<span class="p">[</span><span class="n">wpPush</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">query</span><span class="p">];</span>
<span class="p">[</span><span class="n">wpPush</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="n">query</span> <span class="p">{</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"channels"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"suitcaseOwners"</span><span class="p">)</span>

    <span class="c1">// Notification for Android users</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"deviceType"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"android"</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">androidPush</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
    <span class="n">androidPush</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Your suitcase has been filled with tiny robots!"</span><span class="p">)</span>
    <span class="n">androidPush</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">androidPush</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>

    <span class="c1">// Notification for iOS users</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"deviceType"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"ios"</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">iOSPush</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
    <span class="n">iOSPush</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Your suitcase has been filled with tiny apples!"</span><span class="p">)</span>
    <span class="n">iOSPush</span><span class="o">.</span><span class="nf">setChannel</span><span class="p">(</span><span class="s">"suitcaseOwners"</span><span class="p">)</span>
    <span class="n">iOSPush</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">iOSPush</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>

    <span class="c1">// Notification for Windows 8 users</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"deviceType"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"winrt"</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">winPush</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
    <span class="n">winPush</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Your suitcase has been filled with tiny glass!"</span><span class="p">)</span>
    <span class="n">winPush</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">winPush</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>

    <span class="c1">// Notification for Windows Phone 8 users</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">whereKey</span><span class="p">(</span><span class="s">"deviceType"</span><span class="p">,</span> <span class="nv">equalTo</span><span class="p">:</span> <span class="s">"winphone"</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">wpPush</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
    <span class="n">wpPush</span><span class="o">.</span><span class="nf">setMessage</span><span class="p">(</span><span class="s">"Your suitcase is very hip; very metro."</span><span class="p">)</span>
    <span class="n">wpPush</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">wpPush</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="scheduling-pushes">Scheduling Pushes</h2>

<p>Sending scheduled push notifications is not currently supported by the iOS or OS X SDKs. Take a look at the <a href="/docs/rest/guide/#push-notifications-scheduling-pushes">REST API</a>, <a href="/docs/js/guide/#push-notifications-scheduling-pushes">JavaScript SDK</a> or the Parse.com push console.</p>

<h2 id="receiving-pushes">Receiving Pushes</h2>

<p>As we saw in the <a href="#push-notifications-sending-options">Customizing Your Notification</a> section, it is possible to send arbitrary data along with your notification message. We can use this data to modify the behavior of your app when a user opens a notification. For example, upon opening a notification saying that a friend commented on a user’s picture, it would be nice to display this picture.</p>

<p>Due to the package size restrictions imposed by Apple, you need to be careful in managing the amount of extra data sent, since it will cut down on the maximum size of your message. For this reason, it is recommended that you keep your extra keys and values as small as possible.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSDictionary</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span>
  <span class="s">@"alert"</span> <span class="o">:</span> <span class="s">@"James commented on your photo!"</span><span class="p">,</span>
  <span class="s">@"p"</span> <span class="o">:</span> <span class="s">@"vmRZXZ1Dvo"</span> <span class="c1">// Photo's object id
</span><span class="p">};</span>
<span class="n">PFPush</span> <span class="o">*</span><span class="n">push</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFPush</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setQuery</span><span class="p">:</span><span class="n">photoOwnerQuery</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">setData</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
<span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s">"alert"</span> <span class="p">:</span> <span class="s">"James commented on your photo!"</span><span class="p">,</span>
  <span class="s">"p"</span> <span class="p">:</span> <span class="s">"vmRZXZ1Dvo"</span> <span class="c1">// Photo's object id</span>
<span class="p">]</span>
<span class="k">let</span> <span class="nv">push</span> <span class="o">=</span> <span class="kt">PFPush</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setQuery</span><span class="p">(</span><span class="n">photoOwnerQuery</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="nf">sendPushInBackground</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="responding-to-the-payload">Responding to the Payload</h3>

<p>When an app is opened from a notification, the data is made available in the <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code> methods through the <code class="highlighter-rouge">launchOptions</code> dictionary.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span> <span class="p">{</span>
  <span class="p">.</span> <span class="p">.</span> <span class="p">.</span>
  <span class="c1">// Extract the notification data
</span>  <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">notificationPayload</span> <span class="o">=</span> <span class="n">launchOptions</span><span class="p">[</span><span class="nf">UIApplicationLaunchOptionsRemoteNotificationKey</span><span class="p">];</span>

  <span class="c1">// Create a pointer to the Photo object
</span>  <span class="n">NSString</span> <span class="o">*</span><span class="n">photoId</span> <span class="o">=</span> <span class="p">[</span><span class="n">notificationPayload</span> <span class="nf">objectForKey</span><span class="p">:</span><span class="s">@"p"</span><span class="p">];</span>
  <span class="n">PFObject</span> <span class="o">*</span><span class="n">targetPhoto</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"Photo"</span>   <span class="nf">objectId</span><span class="p">:</span><span class="n">photoId</span><span class="p">];</span>

  <span class="c1">// Fetch photo object
</span>  <span class="p">[</span><span class="n">targetPhoto</span> <span class="nf">fetchIfNeededInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Show photo view controller
</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">PhotoVC</span> <span class="o">*</span><span class="n">viewController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PhotoVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithPhoto</span><span class="p">:</span><span class="n">object</span><span class="p">]</span><span class="err">;</span>
      <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">navController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">viewController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">]</span><span class="err">;</span>
    <span class="p">}</span>
  <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
  <span class="c1">// Extract the notification data</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">notificationPayload</span> <span class="o">=</span> <span class="n">launchOptions</span><span class="p">?[</span><span class="kt">UIApplicationLaunchOptionsRemoteNotificationKey</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSDictionary</span> <span class="p">{</span>

      <span class="c1">// Create a pointer to the Photo object</span>
      <span class="k">let</span> <span class="nv">photoId</span> <span class="o">=</span> <span class="n">notificationPayload</span><span class="p">[</span><span class="s">"p"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
      <span class="k">let</span> <span class="nv">targetPhoto</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span> <span class="s">"Photo"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span> <span class="n">photoId</span><span class="p">)</span>

      <span class="c1">// Fetch photo object</span>
      <span class="n">targetPhoto</span><span class="o">.</span><span class="n">fetchIfNeededInBackgroundWithBlock</span> <span class="p">{</span>
        <span class="p">(</span><span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span><span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
          <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
              <span class="c1">// Show photo view controller</span>
              <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">PhotoVC</span><span class="p">(</span><span class="nv">photo</span><span class="p">:</span> <span class="n">object</span><span class="p">);</span>
              <span class="k">self</span><span class="o">.</span><span class="n">navController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">);</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If your app is already running when the notification is received, the data is made available in the <code class="highlighter-rouge">application:didReceiveRemoteNotification:fetchCompletionHandler:</code> method through the <code class="highlighter-rouge">userInfo</code> dictionary.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span>
  <span class="nf">didReceiveRemoteNotification</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">userInfo</span>  <span class="nf">fetchCompletionHandler</span><span class="p">:(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="n">UIBackgroundFetchResult</span><span class="p">))</span><span class="nv">handler</span> <span class="p">{</span>
  <span class="c1">// Create empty photo object
</span>  <span class="n">NSString</span> <span class="o">*</span><span class="n">photoId</span> <span class="o">=</span> <span class="p">[</span><span class="n">userInfo</span> <span class="nf">objectForKey</span><span class="p">:</span><span class="s">@"p"</span><span class="p">];</span>
  <span class="n">PFObject</span> <span class="o">*</span><span class="n">targetPhoto</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFObject</span> <span class="nf">objectWithoutDataWithClassName</span><span class="p">:</span><span class="s">@"Photo"</span>   <span class="nf">objectId</span><span class="p">:</span><span class="n">photoId</span><span class="p">];</span>

  <span class="c1">// Fetch photo object
</span>  <span class="p">[</span><span class="n">targetPhoto</span> <span class="nf">fetchIfNeededInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Show photo view controller
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">handler</span><span class="p">(</span><span class="n">UIBackgroundFetchResultFailed</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">PFUser</span> <span class="nf">currentUser</span><span class="p">])</span> <span class="p">{</span>
      <span class="n">PhotoVC</span> <span class="o">*</span><span class="n">viewController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PhotoVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithPhoto</span><span class="p">:</span><span class="n">object</span><span class="p">]</span><span class="err">;</span>
      <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">navController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">viewController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">]</span><span class="err">;</span>
      <span class="n">handler</span><span class="p">(</span><span class="n">UIBackgroundFetchResultNewData</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">handler</span><span class="p">(</span><span class="n">UIBackgroundFetchResultNoData</span><span class="p">)</span><span class="err">;</span>
    <span class="p">}</span>
  <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>  <span class="n">didReceiveRemoteNotification</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">],</span>  <span class="n">fetchCompletionHandler</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">photoId</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">userInfo</span><span class="p">[</span><span class="s">"p"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">targetPhoto</span> <span class="o">=</span> <span class="kt">PFObject</span><span class="p">(</span><span class="nv">withoutDataWithClassName</span><span class="p">:</span> <span class="s">"Photo"</span><span class="p">,</span> <span class="nv">objectId</span><span class="p">:</span> <span class="n">photoId</span><span class="p">)</span>
    <span class="n">targetPhoto</span><span class="o">.</span><span class="n">fetchIfNeededInBackgroundWithBlock</span> <span class="p">{</span> <span class="p">(</span><span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
      <span class="c1">// Show photo view controller</span>
      <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="o">.</span><span class="kt">Failed</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="kt">PFUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">PhotoVC</span><span class="p">(</span><span class="nv">withPhoto</span><span class="p">:</span> <span class="n">object</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">navController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="o">.</span><span class="kt">NewData</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="o">.</span><span class="kt">NoData</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nf">handler</span><span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="o">.</span><span class="kt">NoData</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>You can read more about handling push notifications in Apple’s <a href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction.html">Local and Push Notification Programming Guide</a>.</p>

<h3 id="tracking-pushes-and-app-opens">Tracking Pushes and App Opens</h3>

<p>To track your users’ engagement over time and the effect of push notifications, we provide some hooks in the <code class="highlighter-rouge">PFAnalytics</code> class. You can view the open rate for a specific push notification on the Parse.com push console. You can also view overall app open and push open graphs are on the Parse analytics console.  Our analytics graphs are rendered in real time, so you can easily verify that your application is sending the correct analytics events before your next release.</p>

<p>This section assumes that you’ve already set up your application to <a href="#push-notifications-installations">save the Installation object</a>. Push open tracking only works when your application’s devices are associated with saved <code class="highlighter-rouge">Installation</code> objects.</p>

<p>First, add the following to your <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code> method to collect information about when your application was launched, and what triggered it. The extra checks ensure that, even with iOS 7’s more advanced background push features, a single logical app-open or push-open event is counted as such.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">application</span><span class="p">.</span><span class="n">applicationState</span> <span class="o">!=</span> <span class="n">UIApplicationStateBackground</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Track an app open here if we launch with a push, unless
</span>  <span class="c1">// "content_available" was used to trigger a background push (introduced
</span>  <span class="c1">// in iOS 7). In that case, we skip tracking here to avoid double
</span>  <span class="c1">// counting the app-open.
</span>  <span class="n">BOOL</span> <span class="n">preBackgroundPush</span> <span class="o">=</span> <span class="o">!</span><span class="p">[</span><span class="n">application</span> <span class="nf">respondsToSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">backgroundRefreshStatus</span><span class="p">)];</span>
  <span class="n">BOOL</span> <span class="n">oldPushHandlerOnly</span> <span class="o">=</span> <span class="o">!</span><span class="p">[</span><span class="n">self</span> <span class="nf">respondsToSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nf">application</span><span class="p">:</span><span class="nf">didReceiveRemoteNotification</span><span class="p">:</span><span class="nf">fetchCompletionHandler</span><span class="p">:)];</span>
  <span class="n">BOOL</span> <span class="n">noPushPayload</span> <span class="o">=</span> <span class="o">!</span><span class="p">[</span><span class="n">launchOptions</span> <span class="nf">objectForKey</span><span class="p">:</span><span class="n">UIApplicationLaunchOptionsRemoteNotificationKey</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">preBackgroundPush</span> <span class="o">||</span> <span class="n">oldPushHandlerOnly</span> <span class="o">||</span> <span class="n">noPushPayload</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">:</span><span class="n">launchOptions</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">application</span><span class="o">.</span><span class="n">applicationState</span> <span class="o">!=</span> <span class="kt">UIApplicationState</span><span class="o">.</span><span class="kt">Background</span> <span class="p">{</span>
  <span class="c1">// Track an app open here if we launch with a push, unless</span>
  <span class="c1">// "content_available" was used to trigger a background push (introduced</span>
  <span class="c1">// in iOS 7). In that case, we skip tracking here to avoid double</span>
  <span class="c1">// counting the app-open.</span>
  <span class="k">let</span> <span class="nv">oldPushHandlerOnly</span> <span class="o">=</span> <span class="o">!</span><span class="k">self</span><span class="o">.</span><span class="nf">respondsToSelector</span><span class="p">(</span><span class="kt">Selector</span><span class="p">(</span><span class="s">"application:didReceiveRemoteNotification:fetchCompletionHandler:"</span><span class="p">))</span>
  <span class="k">let</span> <span class="nv">noPushPayload</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">?</span> <span class="o">=</span> <span class="n">launchOptions</span><span class="p">?[</span><span class="kt">UIApplicationLaunchOptionsRemoteNotificationKey</span><span class="p">]?</span>
  <span class="k">if</span> <span class="n">oldPushHandlerOnly</span> <span class="o">||</span> <span class="n">noPushPayload</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">(</span><span class="n">launchOptions</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Second, if your application is running or backgrounded, the <code class="highlighter-rouge">application:didReceiveRemoteNotification:</code> method handles the push payload instead. If the user acts on a push notification while the application is backgrounded, the application will be brought to the foreground. To track this transition as the application being “opened from a push notification,” perform one more check before calling any tracking code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didReceiveRemoteNotification</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">userInfo</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">application</span><span class="p">.</span><span class="n">applicationState</span> <span class="o">==</span> <span class="n">UIApplicationStateInactive</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The application was just brought from the background to the foreground,
</span>    <span class="c1">// so we consider the app as having been "opened by a push notification."
</span>    <span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">:</span><span class="n">userInfo</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didReceiveRemoteNotification</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">application</span><span class="o">.</span><span class="n">applicationState</span> <span class="o">==</span> <span class="o">.</span><span class="kt">Inactive</span>  <span class="p">{</span>
        <span class="c1">// The application was just brought from the background to the foreground,</span>
        <span class="c1">// so we consider the app as having been "opened by a push notification."</span>
        <span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">(</span><span class="n">userInfo</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Finally, if using iOS 7 any of its new push features (including the new “content-available” push functionality), be sure to also implement the iOS 7-only handler:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didReceiveRemoteNotification</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">userInfo</span> <span class="nf">fetchCompletionHandler</span><span class="p">:(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="n">UIBackgroundFetchResult</span><span class="p">))</span><span class="nv">completionHandler</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">application</span><span class="p">.</span><span class="n">applicationState</span> <span class="o">==</span> <span class="n">UIApplicationStateInactive</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">:</span><span class="n">userInfo</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>  <span class="n">didReceiveRemoteNotification</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">],</span>  <span class="n">fetchCompletionHandler</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">(</span><span class="kt">UIBackgroundFetchResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="n">application</span><span class="o">.</span><span class="n">applicationState</span> <span class="o">==</span> <span class="o">.</span><span class="kt">Inactive</span> <span class="p">{</span>
    <span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">(</span><span class="n">userInfo</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h4 id="tracking-on-os-x">Tracking on OS X</h4>

<p>If your OS X application supports receiving push notifications and you’d like to track application opens related to pushes, add hooks to the <code class="highlighter-rouge">application:didReceiveRemoteNotification:</code> method (as in iOS) and the following to <code class="highlighter-rouge">applicationDidFinishLaunching:</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationDidFinishLaunching</span><span class="p">:(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="nv">notification</span> <span class="p">{</span>
  <span class="c1">// ... other Parse setup logic here
</span>  <span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">:[</span><span class="n">notification</span> <span class="nf">userInfo</span><span class="p">]];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">applicationDidFinishLaunching</span><span class="p">(</span><span class="nv">notification</span><span class="p">:</span> <span class="kt">NSNotification</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... other Parse setup logic here</span>
  <span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithRemoteNotificationPayload</span><span class="p">(</span><span class="n">notification</span><span class="o">.</span><span class="n">userInfo</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<h4 id="tracking-local-notifications-ios-only">Tracking Local Notifications (iOS only)</h4>

<p>To track analytics around local notifications, note that <code class="highlighter-rouge">application:didReceiveLocalNotification:</code> is called <em>in addition to</em> <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code>, if implemented. Please be careful to prevent tracking duplicate events.</p>

<h4 id="clearing-the-badge">Clearing the Badge</h4>

<p>A good time to clear your app’s badge is usually when your app is opened. Setting the badge property on the current installation will update the application icon badge number and ensure that the latest badge value  will be persisted to the server on the next save. All you need to do is:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationDidBecomeActive</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="p">{</span>
  <span class="n">PFInstallation</span> <span class="o">*</span><span class="n">currentInstallation</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFInstallation</span> <span class="nf">currentInstallation</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">currentInstallation</span><span class="p">.</span><span class="n">badge</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">currentInstallation</span><span class="p">.</span><span class="n">badge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">[</span><span class="n">currentInstallation</span> <span class="nf">saveEventually</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">applicationDidBecomeActive</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">currentInstallation</span> <span class="o">=</span> <span class="kt">PFInstallation</span><span class="o">.</span><span class="nf">currentInstallation</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">currentInstallation</span><span class="o">.</span><span class="n">badge</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="n">currentInstallation</span><span class="o">.</span><span class="n">badge</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">currentInstallation</span><span class="o">.</span><span class="nf">saveEventually</span><span class="p">()</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The <a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/index.html">UIApplicationDelegate documentation</a> contains more information on hooks into an app’s life cycle; the ones which are most relevant for resetting the badge count are  <code class="highlighter-rouge">applicationDidBecomeActive:</code>,  <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code>,  and <code class="highlighter-rouge">application:didReceiveRemoteNotification:</code>.</p>

<h2 id="push-experiments">Push Experiments</h2>

<p>You can A/B test your push notifications to figure out the best way to keep your users engaged. With A/B testing, you can simultaneously send two versions of your push notification to different devices, and use each version’s push open rates to figure out which one is better.  You can test by either message or send time.</p>

<h3 id="ab-testing">A/B Testing</h3>

<p>Our web push console guides you through every step of setting up an A/B test.</p>

<p>For each push campaign sent through the Parse web push console, you can allocate a subset of your devices to be in the experiment’s test audience, which Parse will automatically split into two equally-sized experiment groups. For each experiment group, you can specify a different push message. The remaining devices will be saved so that you can send the winning message to them later. Parse will randomly assign devices to each group to minimize the chance for a test to affect another test’s results (although we still don’t recommend running multiple A/B tests over the same devices on the same day).</p>

<p><img src="https://parse.com/images/docs/ios_push/experiment_enable.png" alt="" /></p>

<p>After you send the push, you can come back to the push console to see in real time which version resulted in more push opens, along with other metrics such as statistical confidence interval. It’s normal for the number of recipients in each group to be slightly different because some devices that we had originally allocated to that experiment group may have uninstalled the app. It’s also possible for the  random group assignment to be slightly uneven when the test audience size is small. Since we calculate open rate separately for each group based on recipient count, this should not significantly affect your experiment results.</p>

<p><img src="https://parse.com/images/docs/ios_push/experiment_results.png" alt="" /></p>

<p>If you are happy with the way one message performed, you can send that to the rest of your app’s devices (i.e. the “Launch Group”). This step only applies to A/B tests where you vary the message.</p>

<p><img src="https://parse.com/images/docs/ios_push/experiment_launch.png" style="max-width:400px" /></p>

<p>Push experiments are supported on all recent Parse SDKs (iOS v1.2.13+, OS X v1.7.5+, Android v1.4.0+, .NET v1.2.7+). Before running experiments, you must instrument your app with <a href="#push-notifications-tracking-pushes-and-app-opens">push open tracking</a>.</p>

<h3 id="experiment-statistics">Experiment Statistics</h3>

<p>Parse provides guidance on how to run experiments to achieve statistically significant results.</p>

<h4 id="test-audience-size">Test Audience Size</h4>

<p>When you setup a push message experiment, we’ll recommend the minimum size of your test audience. These recommendations are generated through simulations based on your app’s historical push open rates. For big push campaigns (e.g. 100k+ devices), this recommendation is usually small subset of your devices. For smaller campaigns (e.g. &lt; 5k devices), this recommendation is usually all devices. Using all devices for your test audience will not leave any remaining devices for the launch group, but you can still gain valuable insight into what type of messaging works better so you can implement similar messaging in your next push campaign.</p>

<h4 id="confidence-interval">Confidence Interval</h4>

<p>After you send your pushes to experiment groups, we’ll also provide a statistical confidence interval when your experiment has collected enough data to have statistically significant results. This confidence interval is in absolute percentage points of push open rate (e.g. if the open rates for groups A and B are 3% and 5%, then the difference is reported as 2 percentage points). This confidence interval is a measure of how much difference you would expect to see between the two groups if you repeat the same experiment many times.</p>

<p>Just after a push send, when only a small number of users have opened their push notifications, the open rate difference you see between groups A and B could be due to random chance, so it might not be reproducible if you run the same experiment again. After your experiment collects more data over time, we become increasingly confident that the observed difference is a true difference. As this happens, the confidence interval will become narrower, allowing us to more accurately estimate the true difference between groups A and B. Therefore, we recommend that you wait until there is enough data to generate a statistical confidence interval before deciding which group’s push is better.</p>

<h2 id="push-localization">Push Localization</h2>

<p>Localizing your app’s content is a proven way to drive greater engagement. We’ve made it easy to localize your push messages with Push Localization. The latest version of the Parse iOS SDK will detect and store the user’s language in the installation object, and via the web push console you’ll be able to send localized push messages to your users in a single broadcast.</p>

<h3 id="setup">Setup</h3>

<p>To take advantage of  Push Localization you will need to make sure you’ve published your app with the Parse iOS SDK version 1.8.1 or greater. Any users of your application running the Parse iOS SDK version 1.8.1 or greater will then be targetable by Push Localization via the web push console.</p>

<p>It’s important to note that for developers who have users running apps with versions of the Parse iOS SDK earlier than 1.8.1 that targeting information for Localized Push will not be available and these users will receive the default message from the push console.</p>

<h3 id="sending-a-localized-push">Sending a localized push</h3>

<p>Our web push console guides you through every step of setting up a Localized Push.</p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>Setting up Push Notifications is often a source of frustration for developers. The process is complicated and invites problems to happen along the way. We have created a <a href="/tutorials/ios-push-notifications">tutorial which covers all the necessary steps to configure your app for push notifications</a>. If you run into issues, try some of the following troubleshooting tips.</p>

<p>It’s important to break down the system into components when troubleshooting push notification issues. You can start by asking yourself the following questions:</p>

<ul>
  <li>Is the push notification listed in your push logs?</li>
  <li>Are you targeting your push notification to the correct audience?</li>
  <li>Are your devices registering for push notifications?</li>
  <li>Is your app set up to receive these notifications?</li>
</ul>

<p>If the answer is Yes to all of these questions, there may be an operational issue that is affecting the delivery of push notifications. You can see the current status of the platform in our <a href="https://status.parse.com">status page</a>. If everything looks green, please <a href="https://parse.com/help#report">create a bug report</a> with more information. Every bug report opened against the push notification category will be redirected to this troubleshooting guide unless it includes evidence of having gone through these steps, so please be as verbose as possible.</p>

<p>If you’re unsure about the answer to any of the above questions, read on!</p>

<h3 id="confirm-that-the-push-campaign-was-created">Confirm that the push campaign was created</h3>

<p>Having everything set up correctly in your Parse app won’t help if your request to send a push notification does not reach Parse. The first step in debugging a push issue is to confirm that the push campaign is listed in your push logs. You can find these logs by visiting your app’s <a href="/apps">Dashboard</a> and clicking on Push.</p>

<p>If the push notification campaign is not showing up on that list, the issue is quite simple to resolve. Go back to your push notification sending code and make sure to check for any error responses. If you’re using any of the client SDKs, make sure to listen for and catch any errors that may be returned. For example, you could log errors like so:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">push</span> <span class="nf">sendPushInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"The push campaign has been created."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">kPFErrorPushMisconfigured</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Could not send push. Push is misconfigured: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">description</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error sending push: %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">description</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">push</span><span class="o">.</span><span class="n">sendPushInBackgroundWithBlock</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">success</span><span class="p">:</span> <span class="kt">Bool</span> <span class="p">,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"The push campaign has been created."</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">!.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">112</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Could not send push. Push is misconfigured: </span><span class="se">\(</span><span class="n">error</span><span class="o">!.</span><span class="n">description</span><span class="se">)</span><span class="s">."</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Error sending push: </span><span class="se">\(</span><span class="n">error</span><span class="o">!.</span><span class="n">description</span><span class="se">)</span><span class="s">."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Please note that SDKs that use a Client Key, such as the iOS/OS X SDKs, can only send push notifications if Client Push is enabled in your Parse app’s Push Notification settings. Otherwise, you’ll only be able to send pushes from the web console, the REST API, or by using the JavaScript SDK from Cloud Code. We strongly encourage developers to turn off Client Push before releasing their app publicly unless your use case allows for any amount of arbitrary pushes to be sent by any of your users. You can read our security guide for more information.</p>

<h3 id="verify-your-targeting">Verify your Targeting</h3>

<p>You have confirmed that the push notification is making it to your push logs. Now what? The next step is to verify if your push notification targeting is correct. Say, if you’re debugging why notifications are not reaching a specific device, it’s important to make sure that this device is actually included in the targeting of this push notification. You can’t deliver something that is not addressed correctly.</p>

<p>In order to do this, you’ll have to confirm that the device’s Installation object is included in your push notification targeting criteria. This is quite straightforward if you’re using channels: all you need to verify is that your device’s Installation is subscribed to the channel by checking the channels array. If you’re using advanced targeting, e.g. you’re using a push query with constraints, you’ll have to work a bit more to determine if your targeting is on point.</p>

<p>Basically, you will need to run the same push query you’re using for your targeting, and verify that your installation of interest is included in the result set. As you can only query the installation class programmatically using the Master Key, you will need to use one of the Master Key capable SDKs (JavaScript SDK, .NET) or the REST API. Ideally, you would use the same SDK that you’re currently using to send the push notifications.</p>

<h4 id="debugging-using-the-rest-api">Debugging using the REST API</h4>

<p>The REST API is quite easy to use for this sort of purpose as you can easily recreate the push query using the information provided in your push notification logs. If you look closely at the “Full Target” value in your push campaign log item, you may notice that it matches the query format for a REST API query. You can grab an example of what a <a href="/docs/rest#queries-constraints">REST API query</a> over Installations would look like from the REST API docs. Don’t forget to use the <code class="highlighter-rouge">X-Parse-Master-Key</code> header to ensure that the Master Key is used to run this query.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Query over installations</span>
curl -X GET <span class="se">\</span>
-H <span class="s2">"X-Parse-Application-Id: {YOUR_APPLICATION_ID}"</span> <span class="se">\</span>
-H <span class="s2">"X-Parse-Master-Key: {YOUR_MASTER_KEY}"</span> <span class="se">\</span>
-G <span class="se">\</span>
--data-urlencode <span class="s1">'limit=1000'</span> <span class="se">\</span>
--data-urlencode <span class="s1">'where={ "city": "San Francisco", "deviceType": { "$in": [ "ios", "android", "winphone", "embedded" ] } }'</span> <span class="se">\</span>
https://api.parse.com/1/installations
</code></pre>
</div>

<p>If you type the above into a console, you should be able to see the first 1,000 objects that match your query. Note that constraints are always ANDed, so if you want to further reduce the search scope, you can add a constraint that matches the specific installation for your device:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Query over installations</span>
curl -X GET <span class="se">\</span>
-H <span class="s2">"X-Parse-Application-Id: {YOUR_APPLICATION_ID}"</span> <span class="se">\</span>
-H <span class="s2">"X-Parse-Master-Key: {YOUR_MASTER_KEY}"</span> <span class="se">\</span>
-G <span class="se">\</span>
--data-urlencode <span class="s1">'limit=1'</span> <span class="se">\</span>
--data-urlencode <span class="s1">'where={ “objectId”: {YOUR_INSTALLATION_OBJECT_ID}, "city": "San Francisco", "deviceType": { "$in": [ "ios", "android", "winphone", "embedded" ] } }'</span> <span class="se">\</span>
https://api.parse.com/1/installations
</code></pre>
</div>

<p>If the above query returns no results, it is likely that your installation does not meet the targeting criteria for your campaign.</p>

<h3 id="check-your-device-configuration">Check your Device Configuration</h3>

<p>Your push campaign is created and the device is included in the targeting, but you’re still not receiving push notifications. What gives?</p>

<p>You can check the Push Delivery Report for the cause of failed deliveries: Invalid Tokens happens when the user have uninstalled the app or if it is misconfigured, No Certificates is returned when all available certificates were rejected by Apple.</p>

<p>This is a good time to go through your project settings and make sure everything is in order.</p>

<ul>
  <li>Make sure you are using the correct Bundle Identifier in the <code class="highlighter-rouge">Info.plist</code> file in your Xcode project. This should match your push certificate bundle identifier as well as your Installation object’s bundle identifier.</li>
  <li>Make sure you set the correct provisioning profile in <code class="highlighter-rouge">Project &gt; Build Settings</code> in Xcode.</li>
  <li>Clean your project and restart Xcode.</li>
  <li>Try regenerating the provisioning profile by navigating to <a href="https://developer.apple.com/account/overview.action">Certificates, Identifiers &amp; Profiles</a>, changing the App ID set on the provisioning profile, and changing it back. You will need to reinstall the profile as described in step two of the tutorial (Creating the Provisioning Profile) and set it in your Project’s Build Settings.</li>
  <li>Open the Xcode Organizer and delete all expired and unused provisioning profiles from both your computer and your iOS device.</li>
  <li>When enabling push notifications for an existing App ID in the Apple iOS Provisioning Portal, make sure to regenerate the provisioning profile, then add the updated profile to the Xcode Organizer.</li>
  <li>Distribution push notifications need to be enabled prior to submitting an app to the App Store. Make sure you have followed Section 7 of the tutorial, “Preparing for the App Store”, prior to submitting your app. If you skipped any of these steps, you might need to submit a new binary to the App Store.</li>
  <li>Double check that your app can receive distribution push notifications when signed with an Ad Hoc profile. This configuration is the closest you can get to an App Store provisioned app.</li>
</ul>

<p>If everything compiles and runs with no errors, but you are still not receiving pushes:</p>

<ul>
  <li>Check that the device token registration call is being called successfully when the user opts in to push notifications. Your device must successfully register an Installation object with a valid device token.</li>
  <li>Make sure that your app has been given permission to receive notifications. You can verify this in your iOS device’s <code class="highlighter-rouge">Settings &gt; Notification &gt; YourAppName</code>.</li>
  <li>If your app has been granted permission to receive push notifications, make sure that you are code signing your app with the correct provisioning profile.</li>
  <li>If you have uploaded a Development Push Notification Certificate to Parse, you will only receive push notifications if you built your app with a Development Provisioning Profile.</li>
  <li>If you have uploaded a Production Push Notification Certificate, you should sign your app with a Distribution Provisioning Profile. Ad Hoc and App Store Distribution Provisioning Profiles should both work when your app is configured with a Production Push Notification Certificate.</li>
  <li>Make sure that all of the push certificates that you’ve uploaded to Parse are valid. Check and see if there are any expired push certificates that may be preventing your push from being delivered to all your recipients successfully.</li>
</ul>

<p>If your app has been released for a while, it is expected that a percentage of your user base will have opted out of push notifications from your app or uninstalled your app from their device. Parse does not automatically delete installation objects in either of these cases. When a push campaign is sent out, Parse will detect uninstalled installations and exclude them from the total count of push notifications sent. The recipient estimate on the push composer is based on the estimated number of installations that match your campaign’s targeting criteria. With that in mind, it is possible for the recipient estimate to be higher than the number of push notifications that is sent as reported by the push campaign status page.</p>

<h3 id="handling-push-notifications">Handling Push Notifications</h3>

<p>If everything looks great so far, but push notifications are not showing up on your phone, there are a few more things you can check. For example, if your app is in the foreground when the push notification is received, an alert will not be displayed by default. You will need to handle the incoming push notification and perform the necessary action as documented in <a href="/docs/ios/guide#push-notifications-responding-to-the-payload">Responding to the Payload</a>.</p>

<p>If your app is not running in the foreground and the push notification is not showing up, make sure that you’re specifying an “alert” key in your payload. Otherwise, the push notification will be treated as a silent push notification.</p>

<p>When using <code class="highlighter-rouge">content-available</code> to send silent push notifications, keep in mind that APNS may throttle push notifications sent to the same device token within a short period of time.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="config">Config</h1>

<h2 id="parse-config">Parse Config</h2>

<p><code class="highlighter-rouge">PFConfig</code> is a way to configure your applications remotely by storing a single configuration object on Parse. It enables you to add things like feature gating or a simple “Message of the Day”. To start using <code class="highlighter-rouge">PFConfig</code> you need to add a few key/value pairs (parameters) to your app on the Parse Config Dashboard.</p>

<p><img src="https://parse.com/images/docs/config_editor.png" alt="" /></p>

<p>After that you will be able to fetch the <code class="highlighter-rouge">PFConfig</code> on the client, like in this example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">PFConfig</span> <span class="nf">getConfigInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">NSNumber</span> <span class="o">*</span><span class="n">number</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s">@"winningNumber"</span><span class="p">]</span><span class="err">;</span>
  <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Yay! The number is %@!"</span><span class="p">,</span> <span class="p">[</span><span class="n">number</span> <span class="nf">stringValue</span><span class="p">])</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFConfig</span><span class="o">.</span><span class="n">getConfigInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">PFConfig</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">let</span> <span class="nv">number</span> <span class="o">=</span> <span class="n">config</span><span class="p">?[</span><span class="s">"winningNumber"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Int</span>
  <span class="nf">print</span><span class="p">(</span><span class="s">"Yay! The number is </span><span class="se">\(</span><span class="n">number</span><span class="se">)</span><span class="s">!"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="retrieving-config">Retrieving Config</h2>

<p><code class="highlighter-rouge">PFConfig</code> is built to be as robust and reliable as possible, even in the face of poor internet connections. Caching is used by default to ensure that the latest successfully fetched config is always available. In the below example we use <code class="highlighter-rouge">getConfigInBackgroundWithBlock</code> to retrieve the latest version of config from the server, and if the fetch fails we can simply fall back to the version that we successfully fetched before via <code class="highlighter-rouge">currentConfig</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSLog</span><span class="p">(</span><span class="s">@"Getting the latest config..."</span><span class="p">);</span>
<span class="p">[</span><span class="n">PFConfig</span> <span class="nf">getConfigInBackgroundWithBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">PFConfig</span> <span class="o">*</span><span class="n">config</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Yay! Config was fetched from the server."</span><span class="p">)</span><span class="err">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Failed to fetch. Using Cached Config."</span><span class="p">)</span><span class="err">;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFConfig</span> <span class="nf">currentConfig</span><span class="p">]</span><span class="err">;</span>
  <span class="p">}</span>

  <span class="n">NSString</span> <span class="o">*</span><span class="n">welcomeMessage</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s">@"welcomeMessage"</span><span class="p">]</span><span class="err">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">welcomeMessage</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Falling back to default message."</span><span class="p">)</span><span class="err">;</span>
    <span class="n">welcomeMessage</span> <span class="o">=</span> <span class="s">@"Welcome!"</span><span class="err">;</span>
  <span class="p">}</span>
  <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Welcome Messsage = %@"</span><span class="p">,</span> <span class="n">welcomeMessage</span><span class="p">)</span><span class="err">;</span>
<span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="s">"Getting the latest config..."</span><span class="p">);</span>
<span class="kt">PFConfig</span><span class="o">.</span><span class="n">getConfigInBackgroundWithBlock</span> <span class="p">{</span>
  <span class="p">(</span><span class="k">var</span> <span class="nv">config</span><span class="p">:</span> <span class="kt">PFConfig</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Yay! Config was fetched from the server."</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Failed to fetch. Using Cached Config."</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="kt">PFConfig</span><span class="o">.</span><span class="nf">currentConfig</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="k">var</span> <span class="nv">welcomeMessage</span><span class="p">:</span> <span class="kt">NSString</span><span class="p">?</span> <span class="o">=</span> <span class="n">config</span><span class="p">?[</span><span class="s">"welcomeMessage"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">welcomeMessage</span> <span class="o">=</span> <span class="n">welcomeMessage</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Welcome Message = </span><span class="se">\(</span><span class="n">welcomeMessage</span><span class="se">)</span><span class="s">!"</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Falling back to default message."</span><span class="p">)</span>
    <span class="n">welcomeMessage</span> <span class="o">=</span> <span class="s">"Welcome!"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
</div>

<h2 id="current-config">Current Config</h2>

<p>Every <code class="highlighter-rouge">PFConfig</code> instance that you get is always immutable. When you retrieve a new <code class="highlighter-rouge">PFConfig</code> in the future from the network, it will not modify any existing <code class="highlighter-rouge">PFConfig</code> instance, but will instead create a new one and make it available via <code class="highlighter-rouge">[PFConfig currentConfig]</code>. Therefore, you can safely pass around any <code class="highlighter-rouge">PFConfig</code> object and safely assume that it will not automatically change.</p>

<p>It might be troublesome to retrieve the config from the server every time you want to use it. You can avoid this by simply using the cached <code class="highlighter-rouge">currentConfig</code> object and fetching the config only once in a while.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Fetches the config at most once every 12 hours per app runtime
</span><span class="k">const</span> <span class="n">NSTimeInterval</span> <span class="n">configRefreshInterval</span> <span class="o">=</span> <span class="mi">12</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
<span class="k">static</span> <span class="n">NSDate</span> <span class="o">*</span><span class="n">lastFetchedDate</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lastFetchedDate</span> <span class="o">==</span> <span class="nb">nil</span> <span class="o">||</span>
    <span class="p">[</span><span class="n">lastFetchedDate</span> <span class="nf">timeIntervalSinceNow</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span> <span class="o">&gt;</span> <span class="n">configRefreshInterval</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">[</span><span class="n">PFConfig</span> <span class="nf">getConfigInBackgroundWithBlock</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
  <span class="n">lastFetchedDate</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSDate</span> <span class="nf">date</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// Fetches the config at most once every 12 hours per app runtime</span>
<span class="k">let</span> <span class="nv">configRefreshInterval</span><span class="p">:</span> <span class="kt">NSTimeInterval</span>  <span class="o">=</span> <span class="mf">12.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span>
<span class="kd">struct</span> <span class="kt">DateSingleton</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">lastFetchedDate</span><span class="p">:</span> <span class="kt">NSDate</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">date</span><span class="p">:</span> <span class="kt">NSDate</span><span class="p">?</span> <span class="o">=</span> <span class="kt">DateSingleton</span><span class="o">.</span><span class="n">lastFetchedDate</span><span class="p">;</span>
<span class="k">if</span> <span class="n">date</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">||</span>
   <span class="n">date</span><span class="o">!.</span><span class="n">timeIntervalSinceNow</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">&gt;</span> <span class="n">configRefreshInterval</span> <span class="p">{</span>
  <span class="kt">PFConfig</span><span class="o">.</span><span class="nf">getConfigInBackgroundWithBlock</span><span class="p">(</span><span class="kc">nil</span><span class="p">);</span>
  <span class="kt">DateSingleton</span><span class="o">.</span><span class="n">lastFetchedDate</span> <span class="o">=</span> <span class="kt">NSDate</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="parameters">Parameters</h2>

<p><code class="highlighter-rouge">PFConfig</code>  supports most of the data types supported by <code class="highlighter-rouge">%{ParseObject}</code>:</p>

<ul>
  <li>NSString</li>
  <li>NSNumber</li>
  <li>NSDate</li>
  <li>PFFile</li>
  <li>PFGeoPoint</li>
  <li>NSArray</li>
  <li>NSDictionary</li>
</ul>

<p>We currently allow up to <strong>100</strong> parameters in your config and a total size of <strong>128KB</strong> across all parameters.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <p>–
title: Analytics
permalink: /analy
–</p>

<h1 id="analytics">Analytics</h1>

<p>Parse provides a number of hooks for you to get a glimpse into the ticking heart of your app. We understand that it’s important to understand what your app is doing, how frequently, and when.</p>

<p>While this section will cover different ways to instrument your app to best take advantage of Parse’s analytics backend, developers using Parse to store and retrieve data can already take advantage of metrics on Parse.</p>

<p>Without having to implement any client-side logic, you can view real-time graphs and breakdowns (by device type, Parse class name, or REST verb) of your API Requests in your app’s dashboard and save these graph filters to quickly access just the data you’re interested in.</p>

<h2 id="app-open--push-analytics">App-Open &amp; Push Analytics</h2>

<p>Our initial analytics hook allows you to track your application being launched. By adding the following line to <code class="highlighter-rouge">applicationDidFinishLaunching:</code>, you’ll begin to collect data on when and how often your application is opened.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in iOS
</span><span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">:</span><span class="n">launchOptions</span><span class="p">];</span>

<span class="c1">// in OS X
</span><span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// in iOS</span>
<span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">(</span><span class="n">launchOptions</span><span class="p">)</span>

<span class="c1">// in OS X</span>
<span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackAppOpenedWithLaunchOptions</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
</code></pre>
</div>

<p>Graphs and breakdowns of your statistics are accessible from your app’s Dashboard.</p>

<p>Further analytics are available around push notification delivery and open rates. Be sure to take a look at the <a href="/docs/push_guide#receiving-tracking/iOS">Tracking Pushes and App Opens subsection</a> of our Push Guide for more detailed information on handling remote notification payloads and push-related callbacks.</p>

<h2 id="custom-analytics">Custom Analytics</h2>

<p><code class="highlighter-rouge">PFAnalytics</code> also allows you to track free-form events, with a handful of <code class="highlighter-rouge">NSString</code> keys and values. These extra dimensions allow segmentation of your custom events via your app’s Dashboard.</p>

<p>Say your app offers search functionality for apartment listings, and you want to track how often the feature is used, with some additional metadata.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSDictionary</span> <span class="o">*</span><span class="n">dimensions</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span>
  <span class="c1">// Define ranges to bucket data points into meaningful segments
</span>  <span class="s">@"priceRange"</span><span class="o">:</span> <span class="s">@"1000-1500"</span><span class="p">,</span>
  <span class="c1">// Did the user filter the query?
</span>  <span class="s">@"source"</span><span class="o">:</span> <span class="s">@"craigslist"</span><span class="p">,</span>
  <span class="c1">// Do searches happen more often on weekdays or weekends?
</span>  <span class="s">@"dayType"</span><span class="o">:</span> <span class="s">@"weekday"</span>
<span class="p">};</span>
<span class="c1">// Send the dimensions to Parse along with the 'search' event
</span><span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackEvent</span><span class="p">:</span><span class="s">@"search"</span> <span class="nf">dimensions</span><span class="p">:</span><span class="n">dimensions</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">dimensions</span> <span class="o">=</span> <span class="p">[</span>
  <span class="c1">// Define ranges to bucket data points into meaningful segments</span>
  <span class="s">"priceRange"</span><span class="p">:</span> <span class="s">"1000-1500"</span><span class="p">,</span>
  <span class="c1">// Did the user filter the query?</span>
  <span class="s">"source"</span><span class="p">:</span> <span class="s">"craigslist"</span><span class="p">,</span>
  <span class="c1">// Do searches happen more often on weekdays or weekends?</span>
  <span class="s">"dayType"</span><span class="p">:</span> <span class="s">"weekday"</span>
<span class="p">]</span>
<span class="c1">// Send the dimensions to Parse along with the 'search' event</span>
<span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackEvent</span><span class="p">(</span><span class="s">"search"</span><span class="p">,</span> <span class="nv">dimensions</span><span class="p">:</span><span class="n">dimensions</span><span class="p">)</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">PFAnalytics</code> can even be used as a lightweight error tracker — simply invoke the following and you’ll have access to an overview of the rate and frequency of errors, broken down by error code, in your application:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">NSString</span> <span class="o">*</span><span class="n">codeString</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%d"</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">code</span><span class="p">]];</span>
<span class="p">[</span><span class="n">PFAnalytics</span> <span class="nf">trackEvent</span><span class="p">:</span><span class="s">@"error"</span> <span class="nf">dimensions</span><span class="p">:</span><span class="err">@</span><span class="p">{</span> <span class="s">@"code"</span><span class="o">:</span> <span class="n">codeString</span> <span class="p">}];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">codeString</span> <span class="o">=</span> <span class="kt">NSString</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span><span class="s">"%@"</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
<span class="kt">PFAnalytics</span><span class="o">.</span><span class="nf">trackEvent</span><span class="p">(</span><span class="s">"error"</span><span class="p">,</span> <span class="nv">dimensions</span><span class="p">:[</span><span class="s">"code"</span><span class="p">:</span> <span class="n">codeString</span><span class="p">])</span>
</code></pre>
</div>

<p>Note that Parse currently only stores the first eight dimension pairs per call to <code class="highlighter-rouge">trackEvent:dimensions:</code>.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="user-interface">User Interface</h1>

<p>At the end of the day, users of your app are going to be interacting with UIKit components.</p>

<p><a href="https://github.com/ParsePlatform/ParseUI-iOS">ParseUI</a> is an opensource collection of a handy user interface components aimed to streamline and simplify user authentication, displaying lists of data, and other common app elements.</p>

<p>Please note that <a href="https://github.com/ParsePlatform/ParseUI-iOS">ParseUI</a> is not included inside the main Parse iOS SDK.</p>

<p>To learn more on how to install it - follow the instructions on the official <a href="https://github.com/ParsePlatform/ParseUI-iOS">GitHub page</a>.</p>

<h2 id="pfloginviewcontroller">PFLogInViewController</h2>

<p>If you are using Parse to manage users in your mobile app, you are already familiar with the <code class="highlighter-rouge">%{ParseUser}</code> class. At some point in your app, you might want to present a screen to log in your <code class="highlighter-rouge">%{ParseUser}</code>. <code class="highlighter-rouge">ParseUI</code> provides a view controller that does exactly this:</p>

<div class="tip info"><div>
  Watch a  [tutorial on using the login and signup views](/tutorials/login-and-signup-views), which provide a set of built-in views ready to be customized and dropped into your app that uses `%{ParseUser}`.
</div></div>

<p>You use the <code class="highlighter-rouge">PFLogInViewController</code> class by instantiating it and presenting it modally:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFLogInViewController</span> <span class="o">*</span><span class="n">logInController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFLogInViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">logInController</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>
<span class="p">[</span><span class="n">self</span> <span class="nf">presentViewController</span><span class="p">:</span><span class="n">logInController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">logInController</span> <span class="o">=</span> <span class="kt">PFLogInViewController</span><span class="p">()</span>
<span class="n">logInController</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
<span class="k">self</span><span class="o">.</span><span class="nf">presentViewController</span><span class="p">(</span><span class="n">logInController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="configuring-the-log-in-elements">Configuring the Log In Elements</h3>

<p><img src="https://parse.com/images/docs/login_diagram.png" alt="" /></p>

<p><code class="highlighter-rouge">PFLogInViewController</code> can be configured to provide a variety of log in options. By default, <code class="highlighter-rouge">PFLogInViewController</code> presents the following UI:</p>

<ul>
  <li>Username and Password Fields</li>
  <li>Log In Button</li>
  <li>Password Forgotten Button</li>
  <li>Sign Up Button</li>
  <li>Dismiss Button</li>
</ul>

<p>Any of the above features can be turned on or off. The options can be set using the <code class="highlighter-rouge">fields</code> property on <code class="highlighter-rouge">PFLogInViewController</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">logInController</span><span class="p">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFLogInFieldsUsernameAndPassword</span>
                           <span class="o">|</span> <span class="n">PFLogInFieldsLogInButton</span>
                           <span class="o">|</span> <span class="n">PFLogInFieldsSignUpButton</span>
                           <span class="o">|</span> <span class="n">PFLogInFieldsPasswordForgotten</span>
                           <span class="o">|</span> <span class="n">PFLogInFieldsDismissButton</span><span class="p">);</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="n">logInController</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">UsernameAndPassword</span><span class="p">,</span>
                            <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">LogInButton</span><span class="p">,</span>
                            <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">SignUpButton</span><span class="p">,</span>
                            <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">PasswordForgotten</span><span class="p">,</span>
                            <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">DismissButton</span><span class="p">]</span>
</code></pre>
</div>

<p>Essentially, you create an array of all the options you want to include in the log in screen, and assign the value to <code class="highlighter-rouge">fields</code>.</p>

<p>In addition, there are a number of other options that can be turned on, including:</p>

<ul>
  <li>Facebook Button</li>
  <li>Twitter Button</li>
</ul>

<p>Similarly, you can turn on Facebook or Twitter log in as such:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">logInController</span><span class="p">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFLogInFieldsUsernameAndPassword</span>
                          <span class="o">|</span> <span class="n">PFLogInFieldsFacebook</span>
                          <span class="o">|</span> <span class="n">PFLogInFieldsTwitter</span><span class="p">);</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">logInController</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">UsernameAndPassword</span><span class="p">,</span>
                           <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">Facebook</span><span class="p">,</span>
                           <span class="kt">PFLogInFields</span><span class="o">.</span><span class="kt">Twitter</span><span class="p">]</span>
</code></pre>
</div>

<p>The above code would produce a log in screen that includes username, password, Facebook and Twitter buttons. Facebook log in permissions can be set via the <code class="highlighter-rouge">facebookPermissions</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFLogInViewController</span> <span class="o">*</span><span class="n">logInController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFLogInViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">logInController</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>
<span class="n">logInController</span><span class="p">.</span><span class="n">facebookPermissions</span> <span class="o">=</span> <span class="p">@[</span> <span class="s">@"friends_about_me"</span> <span class="p">];</span>
<span class="p">[</span><span class="n">self</span> <span class="nf">presentViewController</span><span class="p">:</span><span class="n">logInController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">var</span> <span class="nv">logInController</span> <span class="o">=</span> <span class="kt">PFLogInViewController</span><span class="p">()</span>
<span class="n">logInController</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
<span class="n">logInController</span><span class="o">.</span><span class="n">facebookPermissions</span> <span class="o">=</span> <span class="p">[</span> <span class="s">"friends_about_me"</span> <span class="p">]</span>
<span class="k">self</span><span class="o">.</span><span class="nf">presentViewController</span><span class="p">(</span><span class="n">logInController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span><span class="kc">nil</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="responding-to-log-in-success-failure-or-cancellation">Responding to Log In Success, Failure or Cancellation</h3>

<p>When the user signs in or cancels, the <code class="highlighter-rouge">PFLogInViewController</code> notifies the delegate of the event. Upon receiving this callback, the delegate should, at a minimum, dismiss <code class="highlighter-rouge">PFLogInViewController</code>. Additionally, the delegate could possibly update its own views or forward the message to the other components that need to know about the <code class="highlighter-rouge">%{ParseUser}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">logInViewController</span><span class="p">:(</span><span class="n">PFLogInViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">controller</span>
               <span class="nf">didLogInUser</span><span class="p">:(</span><span class="n">PFUser</span> <span class="o">*</span><span class="p">)</span><span class="nv">user</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">dismissViewControllerAnimated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">logInViewControllerDidCancelLogIn</span><span class="p">:(</span><span class="n">PFLogInViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">logInController</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">dismissViewControllerAnimated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">logInViewController</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">PFLogInViewController</span><span class="p">,</span> <span class="n">didLogInUser</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">dismissViewControllerAnimated</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">logInViewControllerDidCancelLogIn</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">PFLogInViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">dismissViewControllerAnimated</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Besides the delegate pattern, the <code class="highlighter-rouge">PFLogInViewController</code> also supports <code class="highlighter-rouge">NSNotification</code>s, which is useful if there are multiple observers of the sign in events.</p>

<h3 id="customizing-the-logo-and-background-image">Customizing the Logo and Background Image</h3>

<p>You might want to use your own logo or background image. You can achieve this by subclassing <code class="highlighter-rouge">PFLogInViewController</code> and overriding <code class="highlighter-rouge">viewDidLoad</code> method:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@interface</span> <span class="nc">MyLogInViewController</span> <span class="p">:</span> <span class="nc">PFLogInViewController</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyLogInViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>

    <span class="n">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIColor</span> <span class="nf">darkGrayColor</span><span class="p">];</span>

    <span class="n">UIImageView</span> <span class="o">*</span><span class="n">logoView</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIImageView</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithImage</span><span class="p">:[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"logo.png"</span><span class="p">]];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">logInView</span><span class="p">.</span><span class="n">logo</span> <span class="o">=</span> <span class="n">logoView</span><span class="p">;</span> <span class="c1">// logo can be any UIView
</span><span class="p">}</span>
<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">MyLogInViewController</span> <span class="p">:</span> <span class="kt">PFLogInViewController</span> <span class="p">{</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="nf">darkGrayColor</span><span class="p">()</span>

    <span class="k">let</span> <span class="nv">logoView</span> <span class="o">=</span> <span class="kt">UIImageView</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span><span class="s">"logo.png"</span><span class="p">))</span>
    <span class="k">self</span><span class="o">.</span><span class="n">logInView</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="n">logoView</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>If you would like to modify the logo and the background of the associated sign up view, you will need to subclass <code class="highlighter-rouge">PFSignUpViewController</code> and create an instance of the subclass and assign it to the <code class="highlighter-rouge">signUpController</code> as soon as you instantiate <code class="highlighter-rouge">PFLogInViewController</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">MyLogInViewController</span> <span class="o">*</span><span class="n">logInController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MyLogInViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">logInController</span><span class="p">.</span><span class="n">signUpController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MySignUpViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="p">[</span><span class="n">self</span> <span class="nf">presentViewController</span><span class="p">:</span><span class="n">logInController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">logInController</span> <span class="o">=</span> <span class="kt">MyLogInViewController</span><span class="p">()</span>
<span class="n">logInController</span><span class="o">.</span><span class="n">signUpController</span> <span class="o">=</span> <span class="kt">MySignUpViewController</span><span class="p">()</span>
<span class="k">self</span><span class="o">.</span><span class="nf">presentViewController</span><span class="p">(</span><span class="n">logInController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="further-view-customization">Further View Customization</h3>

<p>Occasionally you might want to customize <code class="highlighter-rouge">PFLogInViewController</code> further. For example, you might want to change the placeholder text to “Email” or change the size of the login button. In both cases, you need to subclass <code class="highlighter-rouge">PFLogInViewController</code> and override either <code class="highlighter-rouge">viewDidLoad</code> or <code class="highlighter-rouge">viewDidLayoutSubviews</code>. Override the former if the behavior is not related to layout, and override the latter otherwise:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@interface</span> <span class="nc">MyLogInViewController</span> <span class="p">:</span> <span class="nc">PFLogInViewController</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyLogInViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">logInView</span><span class="p">.</span><span class="n">usernameField</span><span class="p">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">@"email"</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLayoutSubviews</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">logInView</span><span class="p">.</span><span class="n">logInButton</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(...);</span> <span class="c1">// Set a different frame.
</span><span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">MyLogInViewController</span> <span class="p">:</span> <span class="kt">PFLogInViewController</span> <span class="p">{</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">logInView</span><span class="o">.</span><span class="n">usernameField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">"email"</span>
  <span class="p">}</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLayoutSubviews</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">logInView</span><span class="o">.</span><span class="n">logInButton</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRectMake</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1">// Set a different frame.</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Developers interested in this kind of customization should take a look at the interface of <a href="ios/api/Classes/PFLogInView.html"><code class="highlighter-rouge">PFLogInView</code></a>, where all customizable properties are documented.</p>

<h3 id="portrait-and-landscape">Portrait and Landscape</h3>

<p>By default, the <code class="highlighter-rouge">PFLogInViewController</code> supports all orientations on iPad and <code class="highlighter-rouge">UIInterfaceOrientationPortrait</code> on iPhone.</p>

<h3 id="resolution-independent">Resolution Independent</h3>

<p>The <code class="highlighter-rouge">PFLogInViewController</code> is written to be resolution-independent, meaning it looks great on all iOS device sizes and pixel densities.</p>

<h2 id="pfsignupviewcontroller">PFSignUpViewController</h2>

<p>If you are using <code class="highlighter-rouge">PFLogInViewController</code> with the <code class="highlighter-rouge">PFLogInFieldsSignUpButton</code> option enabled, you do not need to do any additional work to enable the sign up functionality. When your user taps on the sign up button on the log in screen, a sign up screen will appear and allow them to sign up. However, there are occasions where you might want to use the sign up screen independently of the log in screen. This is when the <code class="highlighter-rouge">PFSignUpViewController</code> comes in handy.</p>

<p>You use <code class="highlighter-rouge">PFSignUpViewController</code> by instantiating it and presenting it modally:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFSignUpViewController</span> <span class="o">*</span><span class="n">signUpController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFSignUpViewController</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">signUpController</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>
<span class="p">[</span><span class="n">self</span> <span class="nf">presentViewController</span><span class="p">:</span><span class="n">signUpController</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">signUpController</span> <span class="o">=</span> <span class="kt">PFSignUpViewController</span><span class="p">()</span>
<span class="n">signUpController</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
<span class="k">self</span><span class="o">.</span><span class="nf">presentViewController</span><span class="p">(</span><span class="n">signUpController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
</div>

<p>That is all you need to do to get a functional sign up screen.</p>

<h3 id="configuring-the-sign-up-elements">Configuring the Sign Up Elements</h3>

<p><img src="https://parse.com/images/docs/signup_diagram.png" alt="" /></p>

<p><code class="highlighter-rouge">PFSignUpViewController</code> can be configured to provide a variety of sign up options. By default, it presents the following UI:</p>

<ul>
  <li>Username and Password Fields</li>
  <li>Email</li>
  <li>Sign Up Button</li>
  <li>Dismiss Button</li>
</ul>

<p>If your sign up screen requires an additional field on top of the default ones, such as “phone number”, you can turn on a field called named “additional”:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">signUpController</span><span class="p">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFSignUpFieldsUsernameAndPassword</span>
                          <span class="o">|</span> <span class="n">PFSignUpFieldsSignUpButton</span>
                          <span class="o">|</span> <span class="n">PFSignUpFieldsEmail</span>
                          <span class="o">|</span> <span class="n">PFSignUpFieldsAdditional</span>
                          <span class="o">|</span> <span class="n">PFSignUpFieldsDismissButton</span><span class="p">);</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">signUpController</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="kt">PFSignUpFields</span><span class="o">.</span><span class="kt">UsernameAndPassword</span>
                          <span class="o">|</span> <span class="kt">PFSignUpFields</span><span class="o">.</span><span class="kt">SignUpButton</span>
                          <span class="o">|</span> <span class="kt">PFSignUpFields</span><span class="o">.</span><span class="kt">Email</span>
                          <span class="o">|</span> <span class="kt">PFSignUpFields</span><span class="o">.</span><span class="kt">Additional</span>
                          <span class="o">|</span> <span class="kt">PFSignUpFields</span><span class="o">.</span><span class="kt">DismissButton</span><span class="p">)</span>
</code></pre>
</div>

<p>Essentially, you use the bitwise or operator (<code class="highlighter-rouge">|</code>) to chain up all the options you want to include in the sign up screen, and assign the value to <code class="highlighter-rouge">fields</code>. Similarly, you can turn off any field by omitting it in the assignment to fields.</p>

<h3 id="responding-to-sign-up-success-failure-or-cancellation">Responding to Sign Up Success, Failure or Cancellation</h3>

<p>When the user signs up or cancels, the <code class="highlighter-rouge">PFSignUpViewController</code> notifies the delegate of the event. Upon receiving this callback, the delegate should, at a minimum, dismiss <code class="highlighter-rouge">PFSignUpViewController</code>. Additionally, the delegate could update its own views or forward the message to the other components that need to know about the <code class="highlighter-rouge">%{ParseUser}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">signUpViewController</span><span class="p">:(</span><span class="n">PFSignUpViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">signUpController</span> <span class="nf">didSignUpUser</span><span class="p">:(</span><span class="n">PFUser</span> <span class="o">*</span><span class="p">)</span><span class="nv">user</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">dismissViewControllerAnimated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">signUpViewControllerDidCancelSignUp</span><span class="p">:(</span><span class="n">PFSignUpViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">signUpController</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">dismissViewControllerAnimated</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">signUpViewController</span><span class="p">(</span><span class="nv">signUpController</span><span class="p">:</span> <span class="kt">PFSignUpViewController</span><span class="p">,</span> <span class="n">didSignUpUser</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">PFUser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">dismissViewControllerAnimated</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">signUpViewControllerDidCancelSignUp</span><span class="p">(</span><span class="nv">signUpController</span><span class="p">:</span> <span class="kt">PFSignUpViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
  <span class="k">self</span><span class="o">.</span><span class="nf">dismissViewControllerAnimated</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Besides the delegate pattern, the <code class="highlighter-rouge">PFSignUpViewController</code> also supports <code class="highlighter-rouge">NSNotification</code>s, which is useful when there are multiple listeners of the sign up events.</p>

<h3 id="customizing-the-logo-and-background-image-1">Customizing the Logo and Background Image</h3>

<p>You might want to use your own logo or background image. You can achieve this by subclassing <code class="highlighter-rouge">PFSignUpViewController</code> and overriding <code class="highlighter-rouge">viewDidLoad</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@interface</span> <span class="nc">MySignUpViewController</span> <span class="p">:</span> <span class="nc">PFSignUpViewController</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MySignUpViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>

    <span class="n">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIColor</span> <span class="nf">darkGrayColor</span><span class="p">];</span>

    <span class="n">UIImageView</span> <span class="o">*</span><span class="n">logoView</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIImageView</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithImage</span><span class="p">:</span><span class="s">@"logo.png"</span><span class="p">];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">signUpView</span><span class="p">.</span><span class="n">logo</span> <span class="o">=</span> <span class="n">logoView</span><span class="p">;</span> <span class="c1">// logo can be any UIView
</span><span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">MySignUpViewController</span> <span class="p">:</span> <span class="kt">PFSignUpViewController</span> <span class="p">{</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="nf">darkGrayColor</span><span class="p">()</span>

    <span class="k">let</span> <span class="nv">logoView</span> <span class="o">=</span> <span class="kt">UIImageView</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"logo.png"</span><span class="p">))</span>
    <span class="k">self</span><span class="o">.</span><span class="n">signUpView</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="n">logoView</span> <span class="c1">// 'logo' can be any UIView</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="customizing-validation-logic">Customizing Validation Logic</h3>

<p>Often you will want to run some client-side validation on the sign up information before submitting it to the Parse Cloud. You can add your validation logic in the <code class="highlighter-rouge">signUpViewController:shouldBeginSignUp:</code> method in the <code class="highlighter-rouge">PFSignUpViewControllerDelegate</code>. For example, if you decide any password less than 8 characters is too short, you can achieve the following with:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">signUpViewController</span><span class="p">:(</span><span class="n">PFSignUpViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">signUpController</span>
           <span class="nf">shouldBeginSignUp</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">info</span> <span class="p">{</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">password</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s">@"password"</span><span class="p">];</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">);</span> <span class="c1">// prevent sign up if password has to be at least 8 characters long
</span><span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">signUpViewController</span><span class="p">(</span><span class="nv">signUpController</span><span class="p">:</span> <span class="kt">PFSignUpViewController</span><span class="o">!</span><span class="p">,</span>
                          <span class="n">shouldBeginSignUp</span> <span class="nv">info</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">password</span> <span class="o">=</span> <span class="n">info</span><span class="p">?[</span><span class="s">"password"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">password</span><span class="o">.</span><span class="n">utf16Count</span> <span class="o">&gt;=</span> <span class="mi">8</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre>
</div>
<p><code class="highlighter-rouge">info</code> is a dictionary that contains all sign up fields, such as username, password, email, and additional.</p>

<h3 id="further-view-customization-1">Further View Customization</h3>

<p>Occasionally you might want to customize <code class="highlighter-rouge">PFSignUpViewController</code> further. For example, you might want to change the “additional” placeholder text to “Phone” or change the size of the signup button. You can always subclass <code class="highlighter-rouge">PFSignUpViewController</code> and override <code class="highlighter-rouge">UIViewController</code>’s various methods. You should override the <code class="highlighter-rouge">viewDidLoad</code> if the behavior you want to change is unrelated to view layout, and override <code class="highlighter-rouge">viewDidLayoutSubviews</code> otherwise:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@interface</span> <span class="nc">MySignUpViewController</span> <span class="p">:</span> <span class="nc">PFSignUpViewController</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MySignUpViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">signUpView</span><span class="p">.</span><span class="n">usernameField</span><span class="p">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">@"phone"</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLayoutSubviews</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">];</span>
    <span class="n">self</span><span class="p">.</span><span class="n">signUpView</span><span class="p">.</span><span class="n">signUpButton</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(...);</span> <span class="c1">// Set a different frame.
</span><span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">MySignUpViewController</span> <span class="p">:</span> <span class="kt">PFSignUpViewController</span> <span class="p">{</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">signUpView</span><span class="o">.</span><span class="n">usernameField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">"phone"</span>
  <span class="p">}</span>

  <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLayoutSubviews</span><span class="p">()</span>

    <span class="k">self</span><span class="o">.</span><span class="n">signUpView</span><span class="o">.</span><span class="n">signUpButton</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRectMake</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1">// Set a different frame.</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Developer interested in this kind of customization should take a look at the interface of <a href="ios/api/Classes/PFSignUpView.html"><code class="highlighter-rouge">PFSignUpView</code></a>, where all customizable properties are documented.</p>

<h3 id="portrait-and-landscape-1">Portrait and Landscape</h3>

<p>By default, the <code class="highlighter-rouge">PFSignUpViewController</code> supports all orientations on iPad and <code class="highlighter-rouge">UIInterfaceOrientationPortrait</code> on iPhone.</p>

<h3 id="resolution-independent-1">Resolution Independent</h3>

<p>The <code class="highlighter-rouge">PFSignUpViewController</code> is written to be resolution-independent, meaning it looks great on all iOS device sizes and pixel densities.</p>

<h2 id="pfquerytableviewcontroller">PFQueryTableViewController</h2>

<p>Data oriented iOS applications are mostly a collection of <code class="highlighter-rouge">UITableViewController</code>s and corresponding <code class="highlighter-rouge">UITableView</code>s. When using Parse, each cell of a <code class="highlighter-rouge">UITableView</code> typically represents data from a <code class="highlighter-rouge">%{ParseObject}</code>. <code class="highlighter-rouge">PFQueryTableViewController</code> is a sub-class of <code class="highlighter-rouge">UITableViewController</code> that provides a layer of abstraction that lets you easily display data from one of your Parse classes.</p>

<div class="tip info"><div>
  Watch a [tutorial on using PFQueryTableViewController](/tutorials/parse-query-table) to display objects from a `Todo` class in your Parse application.
</div></div>

<p>You use <code class="highlighter-rouge">PFQueryTableViewController</code> much like how you would use <code class="highlighter-rouge">UITableViewController</code>:</p>

<ol>
  <li>Make a subclass of <code class="highlighter-rouge">PFQueryTableViewController</code> and customize it. Use the <a href="https://gist.github.com/ba03c1a550f14f88f95d">template file</a> as a starting point.</li>
  <li>It automatically sets itself as the delegate and datasource.</li>
  <li>Set the <code class="highlighter-rouge">parseClassName</code> instance variable to specify which Parse class should be queried for data.</li>
  <li>Override the <code class="highlighter-rouge">queryForTable</code> method to construct a custom <code class="highlighter-rouge">%{ParseQuery}</code> that should be used to get objects for the table.</li>
  <li>Override the <code class="highlighter-rouge">tableView:cellForRowAtIndexPath:object:</code> method to return a custom cell tailored for each <code class="highlighter-rouge">%{ParseObject}</code>.</li>
  <li>Implement your custom cell class; makes sure it inherits from <code class="highlighter-rouge">PFTableViewCell</code> class.</li>
  <li>When the view loads, the class automatically grabs the <code class="highlighter-rouge">%{ParseObject}</code>s via the constructed query and loads it into the table. It even includes pagination and pull-to-refresh out of the box.</li>
</ol>

<p>The class allows you to think about a one-to-one mapping between a <code class="highlighter-rouge">%{ParseObject}</code> and a <code class="highlighter-rouge">UITableViewCell</code>, rather than having to juggle index paths. You also get the following features out of the box:</p>

<ul>
  <li>Pagination with a cell that can be tapped to load the next page.</li>
  <li>Pull-to-refresh table view header.</li>
  <li>Automatic downloading and displaying of remote images in cells.</li>
  <li>Loading screen, shown before any data is loaded.</li>
  <li>Automatic loading and management of the objects array.</li>
  <li>Various methods that can be overridden to customize behavior at major events in the data cycle.</li>
</ul>

<p>The easiest way to understand this class is with an example. This subclass of <code class="highlighter-rouge">PFQueryTableViewController</code> displays a series of Todo items and their numeric priorities:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@interface</span> <span class="nc">SimpleTableViewController</span> <span class="p">:</span> <span class="nc">PFQueryTableViewController</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">SimpleTableViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">initWithStyle</span><span class="p">:(</span><span class="n">UITableViewStyle</span><span class="p">)</span><span class="nv">style</span> <span class="p">{</span>
    <span class="n">self</span> <span class="o">=</span> <span class="p">[</span><span class="n">super</span> <span class="nf">initWithStyle</span><span class="p">:</span><span class="n">style</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// This table displays items in the Todo class
</span>      <span class="n">self</span><span class="p">.</span><span class="n">parseClassName</span> <span class="o">=</span> <span class="s">@"Todo"</span><span class="p">;</span>
      <span class="n">self</span><span class="p">.</span><span class="n">pullToRefreshEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
      <span class="n">self</span><span class="p">.</span><span class="n">paginationEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
      <span class="n">self</span><span class="p">.</span><span class="n">objectsPerPage</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">PFQuery</span> <span class="o">*</span><span class="p">)</span><span class="n">queryForTable</span> <span class="p">{</span>
    <span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="n">self</span><span class="p">.</span><span class="n">parseClassName</span><span class="p">];</span>

    <span class="c1">// If no objects are loaded in memory, we look to the cache first to fill the table
</span>    <span class="c1">// and then subsequently do a query against the network.
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">query</span><span class="p">.</span><span class="n">cachePolicy</span> <span class="o">=</span> <span class="n">kPFCachePolicyCacheThenNetwork</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">query</span> <span class="nf">orderByDescending</span><span class="p">:</span><span class="s">@"createdAt"</span><span class="p">];</span>

    <span class="k">return</span> <span class="n">query</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="n">tableView</span><span class="o">:</span><span class="p">(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="n">tableView</span>  
         <span class="n">cellForRowAtIndexPath</span><span class="o">:</span><span class="p">(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="n">indexPath</span>
                        <span class="n">object</span><span class="o">:</span><span class="p">(</span><span class="n">PFObject</span> <span class="o">*</span><span class="p">)</span><span class="n">object</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">cellIdentifier</span> <span class="o">=</span> <span class="s">@"cell"</span><span class="p">;</span>

    <span class="n">PFTableViewCell</span> <span class="o">*</span><span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="n">tableView</span> <span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">:</span><span class="n">cellIdentifier</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cell</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFTableViewCell</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithStyle</span><span class="p">:</span><span class="n">UITableViewCellStyleSubtitle</span>
                                    <span class="nf">reuseIdentifier</span><span class="p">:</span><span class="n">cellIdentifier</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">// Configure the cell to show todo item with a priority at the bottom
</span>    <span class="n">cell</span><span class="p">.</span><span class="n">textLabel</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">@"text"</span><span class="p">];</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">detailTextLabel</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"Priority: %@"</span><span class="p">,</span>  <span class="n">object</span><span class="p">[</span><span class="s">@"priority"</span><span class="p">]];</span>

    <span class="k">return</span> <span class="n">cell</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">SimpleTableViewController</span> <span class="p">:</span> <span class="kt">PFQueryTableViewController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="kt">UITableViewStyle</span><span class="p">,</span> <span class="nv">className</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span> <span class="nv">className</span><span class="p">:</span> <span class="n">className</span><span class="p">)</span>
        <span class="n">parseClassName</span> <span class="o">=</span> <span class="s">"Todo"</span>
        <span class="n">pullToRefreshEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">paginationEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">objectsPerPage</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="n">coder</span> <span class="nv">aDecoder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">aDecoder</span><span class="p">)</span>
        <span class="n">parseClassName</span> <span class="o">=</span> <span class="s">"Todo"</span>
        <span class="n">pullToRefreshEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">paginationEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">objectsPerPage</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">queryForTable</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">PFQuery</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">parseClassName</span><span class="o">!</span><span class="p">)</span>

        <span class="c1">// If no objects are loaded in memory, we look to the cache first to fill the table</span>
        <span class="c1">// and then subsequently do a query against the network.</span>
        <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">objects</span><span class="o">!.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
            <span class="n">query</span><span class="o">.</span><span class="n">cachePolicy</span> <span class="o">=</span> <span class="o">.</span><span class="kt">CacheThenNetwork</span>
        <span class="p">}</span>

        <span class="n">query</span><span class="o">.</span><span class="nf">orderByDescending</span><span class="p">(</span><span class="s">"createdAt"</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">query</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">PFTableViewCell</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">cellIdentifier</span> <span class="o">=</span> <span class="s">"cell"</span>

        <span class="k">var</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="n">cellIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">PFTableViewCell</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="kt">PFTableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="kt">Subtitle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">cellIdentifier</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// Configure the cell to show todo item with a priority at the bottom</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="n">object</span> <span class="p">{</span>
            <span class="n">cell</span><span class="o">!.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"text"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
            <span class="k">let</span> <span class="nv">priority</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"priority"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
            <span class="n">cell</span><span class="o">!.</span><span class="n">detailTextLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"Priority </span><span class="se">\(</span><span class="n">priority</span><span class="se">)</span><span class="s">"</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><img src="https://parse.com/images/docs/todo_view.png" style="max-width:200px" /></p>

<p>This view shows a list of Todo items and also allows the user to pull-to-refresh and load the next page by touching a special pagination cell at the end of the table. It also properly caches the objects such that  when the view is no longer in memory, the next time it loads it will use the query cache to immediately show the previously loaded objects while making a network call to update.</p>

<p>Notice all the code that we’re not writing. We don’t need to handle loading the data into the table, wrangle index paths, or handle tricky pagination code. That’s all handled by the <code class="highlighter-rouge">PFQueryTableViewController</code> automatically.</p>

<p>A good starting point to learn more is to look at the <a href="/images/docs/ios/api/Classes/PFQueryTableViewController.html">API for the class</a> and also the <a href="https://gist.github.com/ba03c1a550f14f88f95d">template subclass file</a>. We designed the class with customizability in mind, so it should accommodate many instances where you used to use <code class="highlighter-rouge">UITableViewController</code>.</p>

<h3 id="loading-remote-images-in-cells">Loading Remote Images in Cells</h3>

<p><code class="highlighter-rouge">PFQueryTableViewController</code> makes it simple to display remote images stored in the Parse Cloud as <code class="highlighter-rouge">%{ParseFile}</code>s. All you need to do is to override <code class="highlighter-rouge">tableView:cellForRowAtIndexPath:object:</code> and return a <code class="highlighter-rouge">PFTableViewCell</code> with its <code class="highlighter-rouge">imageView</code>’s <code class="highlighter-rouge">file</code> property specified. If you would like to display a placeholder image to be shown before the remote image is loaded, assign the placeholder image to the <code class="highlighter-rouge">image</code> property of the <code class="highlighter-rouge">imageView</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@implementation</span> <span class="nc">SimpleTableViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span>  <span class="nf">cellForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="nf">object</span><span class="p">:(</span><span class="n">PFObject</span> <span class="o">*</span><span class="p">)</span><span class="nv">object</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">identifier</span> <span class="o">=</span> <span class="s">@"cell"</span><span class="p">;</span>
    <span class="n">PFTableViewCell</span> <span class="o">*</span><span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="n">tableView</span> <span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cell</span><span class="p">)</span> <span class="p">{</span> <span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFTableViewCell</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithStyle</span><span class="p">:</span><span class="n">UITableViewCellStyleDefault</span> <span class="nf">reuseIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">textLabel</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">@"title"</span><span class="p">];</span>

    <span class="n">PFFile</span> <span class="o">*</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">@"thumbnail"</span><span class="p">];</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"placeholder.jpg"</span><span class="p">];</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">cell</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">PFTableViewCell</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">identifier</span> <span class="o">=</span> <span class="s">"cell"</span>

    <span class="k">var</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">PFTableViewCell</span>
    <span class="k">if</span> <span class="n">cell</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="kt">PFTableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="kt">Default</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">identifier</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="n">object</span> <span class="p">{</span>
        <span class="n">cell</span><span class="p">?</span><span class="o">.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
        <span class="n">cell</span><span class="p">?</span><span class="o">.</span><span class="n">imageView</span><span class="p">?</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"placeholder.jpg"</span><span class="p">)</span>
        <span class="n">cell</span><span class="p">?</span><span class="o">.</span><span class="n">imageView</span><span class="p">?</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"thumbnail"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">PFFile</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">cell</span>
<span class="p">}</span>
</code></pre>
</div>

<p><img src="https://parse.com/images/docs/images_table.png" style="max-width:200px" /></p>

<p>This table shows a list of cute animal photos which are stored in the Parse Cloud, as <code class="highlighter-rouge">%{ParseFile}</code>s. “placeholder.jpg” is an image included in the application bundle which is shown before the animal photos are downloaded.</p>

<p>The images are downloaded on demand. As you scroll through the table, the images in the currently visible cells are downloaded. This just-in-time behavior is desirable because not only does it conserve bandwidth, it also ensures timely display of visible images. If a more aggressive loading behavior is desired, you can use the <code class="highlighter-rouge">loadInBackground</code> method on <code class="highlighter-rouge">imageView</code> to download the image.</p>

<h3 id="customizing-the-query">Customizing the Query</h3>

<p>The default query is set to get objects from your class ordered by descending <code class="highlighter-rouge">createdAt</code>. To customize, simply override the <code class="highlighter-rouge">queryForTable</code> method to return your own <code class="highlighter-rouge">%{ParseQuery}</code>. The table will use this query when getting objects to display.</p>

<h3 id="customizing-the-cells">Customizing the Cells</h3>

<p>To customize the look of your table, override <code class="highlighter-rouge">tableView:cellForRowAtIndexPath:object:</code> to return a customized cell. Notice that this method is similar to the typical table data source method, but it includes the <code class="highlighter-rouge">%{ParseObject}</code> directly as a parameter.</p>

<p>You should no longer override <code class="highlighter-rouge">tableView:cellForRowAtIndexPath:</code>.</p>

<p><em>Important:</em> your table view cells should inherit from <code class="highlighter-rouge">PFTableViewCell</code>, rather than <code class="highlighter-rouge">UITableViewCell</code>. <code class="highlighter-rouge">PFTableViewCell</code> is a subclass of <code class="highlighter-rouge">UITableViewCell</code> that supports remote image loading. When used in <code class="highlighter-rouge">PFQueryTableViewController</code>, <code class="highlighter-rouge">PFTableViewCell</code>’s remote images would be automatically loaded.</p>

<h3 id="lifecycle-methods">Lifecycle Methods</h3>

<p>Several methods are exposed that are called at major events during the data lifecycle of the table. They are <code class="highlighter-rouge">objectsDidLoad:</code> and <code class="highlighter-rouge">objectsWillLoad</code>, which are called after the objects have loaded from the query, and right before the query is fired, respectively. You can override these to provide extra functionality during these events.</p>

<h3 id="pagination">Pagination</h3>

<p><img src="https://parse.com/images/docs/pagination.png" style="max-width:200px" /></p>

<p>Pagination ensures that the table only gets one page of objects at a time. You can customize how many objects are in a page by setting the <code class="highlighter-rouge">objectsPerPage</code> instance variable.</p>

<p>The query is automatically altered to apply pagination, and, when the table first loads, it only shows the first page of objects. A pagination cell appears at the bottom of the table which allows users to load the next page. You can customize this cell by overriding <code class="highlighter-rouge">tableView:cellForNextPageAtIndexPath:</code></p>

<p>Pagination is turned on by default. If you want to turn it off, simply set <code class="highlighter-rouge">paginationEnabled</code> to <code class="highlighter-rouge">NO</code>.</p>

<h3 id="pull-to-refresh">Pull to Refresh</h3>

<p><img src="https://parse.com/images/docs/pull_to_refresh.png" style="max-width:200px" /></p>

<p>Pull to Refresh is a feature that allows users to pull the table down and release to reload the data. Essentially, the first page of data is reloaded from your class and the table is cleared and updated with the data.</p>

<p>Pull to Refresh is turned on by default. If you want to turn it off, simply set <code class="highlighter-rouge">pullToRefreshEnabled</code> to <code class="highlighter-rouge">NO</code>.</p>

<h3 id="loading-view">Loading View</h3>

<p>A loading view is displayed when the table view controller is loading the first page of data. It is turned on by default, and can be turned off via the property <code class="highlighter-rouge">loadingViewEnabled</code>.</p>

<h3 id="offline-and-error-messages">Offline and Error Messages</h3>

<p>When the user is offline or a Parse error was generated from a query, an alert can automatically be shown to the user. By default, this is turned on when using <code class="highlighter-rouge">PFQueryTableViewController</code>. If you want to turn this behavior off, you can do so using the methods <code class="highlighter-rouge">offlineMessagesEnabled</code> and <code class="highlighter-rouge">errorMessagesEnabled</code> on the <code class="highlighter-rouge">Parse</code> class.</p>

<h2 id="pfimageview">PFImageView</h2>

<p>Many apps need to display images stored in the Parse Cloud as <code class="highlighter-rouge">%{ParseFile}</code>s. However, to load remote images with the built-in <code class="highlighter-rouge">UIImageView</code> involves writing many lines of boilerplate code. <code class="highlighter-rouge">PFImageView</code> simplifies this task:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFImageView</span> <span class="o">*</span><span class="n">imageView</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFImageView</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
<span class="n">imageView</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"..."</span><span class="p">];</span> <span class="c1">// placeholder image
</span><span class="n">imageView</span><span class="p">.</span><span class="n">file</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFFile</span> <span class="o">*</span><span class="p">)</span><span class="n">someObject</span><span class="p">[</span><span class="s">@"picture"</span><span class="p">];</span> <span class="c1">// remote image
</span>
<span class="p">[</span><span class="n">imageView</span> <span class="nf">loadInBackground</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">imageView</span> <span class="o">=</span> <span class="kt">PFImageView</span><span class="p">()</span>
<span class="n">imageView</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"..."</span><span class="p">)</span> <span class="c1">// placeholder image</span>
<span class="n">imageView</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">someObject</span><span class="o">.</span><span class="n">picture</span> <span class="c1">// remote image</span>

<span class="n">imageView</span><span class="o">.</span><span class="nf">loadInBackground</span><span class="p">()</span>
</code></pre>
</div>

<p>If assigned to, the <code class="highlighter-rouge">image</code> property is used to display a placeholder before the remote image is downloaded. Note that the download does not start as soon as the <code class="highlighter-rouge">file</code> property is assigned to, but the loading only begins when <code class="highlighter-rouge">loadInBackground:</code> is called. The remote image is cached both in memory and on disc. If the image is found in cache, the call to <code class="highlighter-rouge">loadInBackground:</code> would return immediately.</p>

<h2 id="pftableviewcell">PFTableViewCell</h2>

<p>Many apps need to display table view cells which contain images stored in the Parse Cloud as <code class="highlighter-rouge">%{ParseFile}</code>s. However, to load remote images with the built-in <code class="highlighter-rouge">UITableViewCell</code> involves writing many lines of boilerplate code. <code class="highlighter-rouge">PFTableViewCell</code> simplifies this task by exposing an <code class="highlighter-rouge">imageView</code> property of the type <code class="highlighter-rouge">PFImageView</code> that supports remote image loading:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">@implementation</span> <span class="nc">SimpleTableViewController</span>

<span class="k">-</span> <span class="p">(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span>  <span class="nf">cellForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="nf">object</span><span class="p">:(</span><span class="n">PFObject</span> <span class="o">*</span><span class="p">)</span><span class="nv">object</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">identifier</span> <span class="o">=</span> <span class="s">@"cell"</span><span class="p">;</span>
    <span class="n">PFTableViewCell</span> <span class="o">*</span><span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="n">tableView</span> <span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cell</span><span class="p">)</span> <span class="p">{</span> <span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PFTableViewCell</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithStyle</span><span class="p">:</span><span class="n">UITableViewCellStyleDefault</span> <span class="nf">reuseIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">textLabel</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">@"title"</span><span class="p">];</span>

    <span class="n">PFFile</span> <span class="o">*</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">@"thumbnail"</span><span class="p">];</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"placeholder.jpg"</span><span class="p">];</span>
    <span class="n">cell</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">cell</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">identifier</span> <span class="o">=</span> <span class="s">"cell"</span>
    <span class="k">var</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">PFTableViewCell</span>
    <span class="k">if</span> <span class="n">cell</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="kt">PFTableViewCell</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="kt">Default</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">identifier</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="n">cell</span><span class="o">!.</span><span class="n">textLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">thumbnail</span> <span class="o">=</span> <span class="n">object</span><span class="p">[</span><span class="s">"thumbnail"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">PFFile</span> <span class="p">{</span>
        <span class="n">cell</span><span class="o">!.</span><span class="n">imageView</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"placeholder.jpg"</span><span class="p">)</span>
        <span class="n">cell</span><span class="o">!.</span><span class="n">imageView</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">thumbnail</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">cell</span><span class="o">!</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Like <code class="highlighter-rouge">UITableViewCell</code>, <code class="highlighter-rouge">PFTableViewCell</code> supports the default layout styles. Unlike <code class="highlighter-rouge">UITableViewCell</code>, <code class="highlighter-rouge">PFTableViewCell</code>’s <code class="highlighter-rouge">imageView</code> property is of the type <code class="highlighter-rouge">PFImageView</code>, which supports downloading remote images in <code class="highlighter-rouge">%{ParseFile}</code>.</p>

<p>Although it can be used independently, <code class="highlighter-rouge">PFTableViewCell</code> really shines when used in <code class="highlighter-rouge">PFQueryTableViewController</code>. <code class="highlighter-rouge">PFQueryTableViewController</code> knows about <code class="highlighter-rouge">PFTableViewCell</code> and loads the images automatically. This behavior is discussed in detail in the documentation for <code class="highlighter-rouge">PFQueryTableViewController</code>.</p>

<h2 id="customizinglocalizing-string-resources">Customizing/Localizing String Resources</h2>

<p>All strings in Parse’s UI classes are customizable/localizable. The easiest way to customize a string is through the <a href="https://developer.apple.com/internationalization/">default localization support</a> provided by iOS.</p>

<p>Say, for example, you would like to customize the loading message in the HUD of <code class="highlighter-rouge">PFSignUpViewController</code> that says “Loading…” Assume you have followed the localization guide and set up <code class="highlighter-rouge">Localizable.strings</code> in the <code class="highlighter-rouge">en.lproj</code> directory. In <code class="highlighter-rouge">Localizable.strings</code>, you can then enter:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"Loading..."</span> <span class="o">=</span> <span class="s2">"In progress"</span><span class="p">;</span>
</code></pre>
</div>

<p>That would customize the string to “In progress”. The key on the left is the original string you want to customize, and the value on the right is the customized value.</p>

<p>Say, you would like to customize the error message in <code class="highlighter-rouge">PFSignUpViewController</code> that says “The email address “andrew@x” is invalid. Please enter a valid email.” You are not sure how to enter this into <code class="highlighter-rouge">Localizable.strings</code> because it contains a variable.</p>

<p>Included in  the Parse SDK is a file named <code class="highlighter-rouge">Localizable.string</code> which includes all the localizable keys in the Parse framework. Browsing this file, developers can find the key for the string they would like to customize. You notice that the string <code class="highlighter-rouge">"The email address \"%@\" is invalid. Please enter a valid email."</code> is a key in the file. In your own <code class="highlighter-rouge">Localizable.strings</code>, you can then enter:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"The email address \"%@\" is invalid. Please enter a valid email."</span> <span class="o">=</span> <span class="s2">"Wrong email: \"%@\""</span><span class="p">;</span>
</code></pre>
</div>

<p>The string is now customized.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="in-app-purchases">In-App Purchases</h1>

<p>Parse provides a set of APIs for working with in-app purchases. Parse makes it easier to work with <code class="highlighter-rouge">StoreKit</code> and facilitates delivery of downloadable content with receipt verification in the cloud. Receipt verification is a mechanism that allows you to restrict downloads to only those users that have paid accordingly.</p>

<p>In addition, developers can attach query-able metadata on products to categorize, search, and dynamically manipulate products available for purchase.</p>

<p>Lastly, any content uploaded to Parse is exempt from the Apple review process, and hence can be served as soon as the upload is complete.</p>

<h2 id="apple-setup">Apple Setup</h2>

<p>Prior to using in-app purchases on Parse, you’ll need to set up your app and products with Apple. This process spans both the provisioning portal and iTunes Connect. We recommend following this <a href="https://developer.apple.com/library/ios/#technotes/tn2259/_index.html">step-by-step guide</a>.</p>

<p>Note that this is a tricky setup process so please ensure you follow Apple’s documentation precisely.</p>

<h2 id="simple-purchases">Simple Purchases</h2>

<p>Once the setup above is complete, you can begin working with in-app purchases.</p>

<p>On the main thread, register the handlers for the products:
<code class="highlighter-rouge">objc
// Use the product identifier from iTunes to register a handler.
[PFPurchase addObserverForProduct:@"Pro" block:^(SKPaymentTransaction *transaction) {
    // Write business logic that should run once this product is purchased.
    isPro = YES;
}];
</code>
<code class="highlighter-rouge">swift
// Use the product identifier from iTunes to register a handler.
PFPurchase.addObserverForProduct("Pro") {
    (transaction: SKPaymentTransaction?) -&gt; Void in
    // Write business logic that should run once this product is purchased.
    isPro = YES;
}
</code>
Note that this does not make the purchase, but simply registers a block to be run if a purchase is made later. This registration must be done on the main thread, preferably as soon as the app is launched, i.e. in <code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code>. If there are multiple products, we recommend registering all product handlers in the same method, such as <code class="highlighter-rouge">application:didFinishLaunchingWithOptions</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="p">[</span><span class="n">PFPurchase</span> <span class="nf">addObserverForProduct</span><span class="p">:</span><span class="s">@"Pro"</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">SKPaymentTransaction</span> <span class="o">*</span><span class="n">transaction</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">isPro</span> <span class="o">=</span> <span class="nb">YES</span><span class="err">;</span>
    <span class="p">}];</span>
    <span class="p">[</span><span class="n">PFPurchase</span> <span class="nf">addObserverForProduct</span><span class="p">:</span><span class="s">@"VIP"</span> <span class="nf">block</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">SKPaymentTransaction</span> <span class="o">*</span><span class="n">transaction</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">isVip</span> <span class="o">=</span> <span class="nb">YES</span><span class="err">;</span>
    <span class="p">}];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kt">PFPurchase</span><span class="o">.</span><span class="nf">addObserverForProduct</span><span class="p">(</span><span class="s">"Pro"</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">transaction</span><span class="p">:</span> <span class="kt">SKPaymentTransaction</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="n">isPro</span> <span class="o">=</span> <span class="kt">YES</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">PFPurchase</span><span class="o">.</span><span class="nf">addObserverForProduct</span><span class="p">(</span><span class="s">"VIP"</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">transaction</span><span class="p">:</span> <span class="kt">SKPaymentTransaction</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
    <span class="n">isVip</span> <span class="o">=</span> <span class="kt">YES</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To initiate a purchase, use the <code class="highlighter-rouge">+[PFPurchase buyProduct:block:]</code> method:
<code class="highlighter-rouge">objc
[PFPurchase buyProduct:@"Pro" block:^(NSError *error) {
    if (!error) {
        // Run UI logic that informs user the product has been purchased, such as displaying an alert view.
    }
}];
</code>
<code class="highlighter-rouge">swift
PFPurchase.buyProduct("Pro") {
    (error: NSError?) -&gt; Void in
    if error == nil {
        // Run UI logic that informs user the product has been purchased, such as displaying an alert view.
    }
}
</code></p>

<p>The call to <code class="highlighter-rouge">buyProduct:block:</code> brings up a dialogue that asks users to enter their Apple credentials. When the user’s identity is verified, the product will be purchased. If the product is non-consumable and has been purchased by the user before, the user will not be charged.</p>

<h2 id="downloadable-purchases">Downloadable Purchases</h2>

<p>Many IAP products such as books and movies have associated content files that should be downloaded once the purchase is made. This is very simple to do with Parse:</p>

<ol>
  <li>First, go to the web data browser and create a <code class="highlighter-rouge">Product</code> class,</li>
  <li>For each product, fill in the required metadata information and upload the content files:</li>
  <li><code class="highlighter-rouge">productIdentifier:</code> the product identifier of the product, matching the one in iTunes Connect&lt;/code&gt;</li>
  <li><code class="highlighter-rouge">icon:</code> the icon to be displayed in <code class="highlighter-rouge">PFProductTableViewController</code></li>
  <li><code class="highlighter-rouge">title:</code> the title to be displayed in <code class="highlighter-rouge">PFProductTableViewController</code></li>
  <li><code class="highlighter-rouge">subtitle:</code> the subtitle to be displayed in <code class="highlighter-rouge">PFProductTableViewController</code></li>
  <li><code class="highlighter-rouge">order</code>: the order this product should appear in <code class="highlighter-rouge">PFProductTableViewController</code>. This is used only in <code class="highlighter-rouge">PFProductTableViewController</code>; fill in 0 if the order is not important,</li>
  <li><code class="highlighter-rouge">download</code>: the downloadable content file. Note that the file uploaded in <code class="highlighter-rouge">download</code> is not publicly accessible, and only becomes available for download when a purchase is made. <code class="highlighter-rouge">downloadName</code> is the name of the file on disk once downloaded. You don’t need to fill this in.</li>
  <li>Next, you need to register the product handler:
<code class="highlighter-rouge">objc
[PFPurchase addObserverForProduct:@"Pro" block:^(SKPaymentTransaction *transaction) {
[PFPurchase downloadAssetForTransaction:transaction completion:^(NSString *filePath, NSError *error) {
    if (!error) {
        // at this point, the content file is available at filePath.
    }
}];
}];
</code>
<code class="highlighter-rouge">swift
PFPurchase.addObserverForProduct("Pro") {
(transaction: SKPaymentTransaction?) -&gt; Void in
if let transaction = transaction {
    PFPurchase.downloadAssetForTransaction(transaction) {
        (filePath: String?, error: NSError?) -&gt; Void in
        if error == nil {
            // at this point, the content file is available at filePath.
        }
    }
}
}
</code>
Note that this does not make the purchase, but simply registers a block to be run if a purchase is made later. The call to <code class="highlighter-rouge">downloadAssetForTransaction:completion:</code> passes the receipt of the purchase to the Parse Cloud, which then verifies with Apple that the purchase was made. Once the receipt is verified, the purchased file is downloaded.</li>
</ol>

<p>To make the purchase:
<code class="highlighter-rouge">objc
[PFPurchase buyProduct:@"Pro" block:^(NSError *error) {
    if (!error) {
        // run UI logic that informs user the product has been purchased, such as displaying an alert view.
    }
}];
</code>
<code class="highlighter-rouge">swift
PFPurchase.buyProduct("Pro") {(error: NSError?) -&gt; Void in
    if error == nil {
        // run UI logic that informs user the product has been purchased, such as displaying an alert view.
    }
}
</code></p>

<p>The call to <code class="highlighter-rouge">buyProduct:block:</code> brings up a dialogue that asks users to enter their Apple credentials. When the user’s identity is verified, the product will be purchased.</p>

<h2 id="querying-product-information">Querying Product Information</h2>

<p>You can query the product objects created in the data browser using <code class="highlighter-rouge">PFProduct</code>. Like <code class="highlighter-rouge">%{ParseUser}</code> or <code class="highlighter-rouge">%{ParseRole}</code>, <code class="highlighter-rouge">PFProduct</code> is a subclass of <code class="highlighter-rouge">%{ParseObject}</code> that contains convenience accessors to various product-specific properties.</p>

<p>For example, here’s a simple query to get a product:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFQuery</span> <span class="o">*</span><span class="n">productQuery</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFProduct</span> <span class="nf">query</span><span class="p">];</span>
<span class="n">PFProduct</span> <span class="o">*</span><span class="n">product</span> <span class="o">=</span> <span class="p">[[</span><span class="n">productQuery</span> <span class="nf">findObjects</span><span class="p">]</span> <span class="nf">lastObject</span><span class="p">];</span>
<span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@, %@"</span><span class="p">,</span> <span class="n">product</span><span class="p">.</span><span class="n">productIdentifier</span><span class="p">,</span> <span class="n">product</span><span class="p">.</span><span class="n">title</span><span class="p">);</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">productQuery</span> <span class="o">=</span> <span class="kt">PFProduct</span><span class="o">.</span><span class="nf">query</span><span class="p">()</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">product</span> <span class="o">=</span> <span class="n">productQuery</span><span class="o">.</span><span class="n">findObjects</span><span class="o">.</span><span class="n">lastObject</span> <span class="k">as?</span> <span class="kt">PFProduct</span> <span class="p">{}</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">productIdentifier</span><span class="p">,</span> <span class="n">product</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="pfproducttableviewcontroller">PFProductTableViewController</h2>

<p><img src="https://parse.com/images/docs/products_table_screenshot.png" style="max-width: 200px" /></p>

<p><code class="highlighter-rouge">PFProductTableViewController</code> is a subclass of <code class="highlighter-rouge">PFQueryTableViewController</code> that displays all IAP products in a table view. Some content apps, such as an app that sells comic books or video tutorials, may find it handy to use <code class="highlighter-rouge">PFProductTableViewController</code> to sell the products. By default, each cell is a product, and tapping on a cell initiates the purchase for the product. If the product has associated downloadable content, the download will start when the cell is selected and a progress bar is displayed to indicate the progress of the download.</p>

<p>Note that in order to use this class, you must enter all product information in the <code class="highlighter-rouge">Product</code> class via the data browser.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    <h1 id="handling-errors">Handling Errors</h1>

<p>Parse has a few simple patterns for surfacing errors and handling them in your code.</p>

<p>There are two types of errors you may encounter. The first is those dealing with logic errors in the way you’re using the SDK. These types of errors result in an <code class="highlighter-rouge">NSException</code> being raised. For an example take a look at the following code:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">PFUser</span> <span class="o">*</span><span class="n">user</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFUser</span> <span class="nf">user</span><span class="p">];</span>
<span class="p">[</span><span class="n">user</span> <span class="nf">signUp</span><span class="p">];</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">PFUser</span><span class="p">()</span>
<span class="n">user</span><span class="o">.</span><span class="n">signUp</span>
</code></pre>
</div>

<p>This will throw an <code class="highlighter-rouge">NSInternalInconsistencyException</code> because <code class="highlighter-rouge">signUp</code> was called without first setting the required properties (<code class="highlighter-rouge">username</code> and <code class="highlighter-rouge">password</code>).</p>

<p>The second type of error is one that occurs when interacting with the Parse Cloud over the network. These errors are either related to problems connecting to the cloud or problems performing the requested operation. Let’s take a look at another example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">getMyNote</span> <span class="p">{</span>
    <span class="n">PFQuery</span> <span class="o">*</span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">PFQuery</span> <span class="nf">queryWithClassName</span><span class="p">:</span><span class="s">@"Note"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">query</span> <span class="nf">getObjectInBackgroundWithId</span><span class="p">:</span><span class="s">@"thisObjectIdDoesntExist"</span>
                                <span class="nf">target</span><span class="p">:</span><span class="n">self</span>
                              <span class="nf">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nf">callbackForGet</span><span class="p">:</span><span class="nf">error</span><span class="p">:)];</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">getMyNote</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">PFQuery</span><span class="p">(</span><span class="nv">className</span><span class="p">:</span> <span class="s">"Note"</span><span class="p">)</span>
    <span class="n">query</span><span class="o">.</span><span class="nf">getObjectInBackgroundWithId</span><span class="p">(</span><span class="s">"thisObjectIdDoesntExist"</span><span class="p">,</span> <span class="nv">target</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">selector</span><span class="p">:</span> <span class="kt">Selector</span><span class="p">(</span><span class="s">"callbackForGet:error:"</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
</div>

<p>In the above code, we try to fetch an object with a non-existent <code class="highlighter-rouge">objectId</code>. The Parse Cloud will return an error with an error code set in <code class="highlighter-rouge">code</code> and message in the error’s <code class="highlighter-rouge">userInfo</code>. Here’s how to handle it properly in your callback:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">callbackForGet</span><span class="p">:(</span><span class="n">PFObject</span> <span class="o">*</span><span class="p">)</span><span class="nv">result</span> <span class="nf">error</span><span class="p">:(</span><span class="n">NSError</span> <span class="o">*</span><span class="p">)</span><span class="nv">error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Everything went fine!"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">error</span> <span class="nf">code</span><span class="p">]</span> <span class="o">==</span> <span class="n">kPFErrorObjectNotFound</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh, we couldn't find the object!"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">][</span><span class="s">@"error"</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">callbackForGet</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Everything went fine!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="kt">PFErrorCode</span><span class="o">.</span><span class="kt">ErrorObjectNotFound</span><span class="o">.</span><span class="n">rawValue</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh, we couldn't find the object!"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">errorString</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">userInfo</span><span class="o">!</span><span class="p">[</span><span class="s">"error"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">errorString</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The query might also fail because the device couldn’t connect to the Parse Cloud. Here’s the same callback but with a bit of extra code to handle that scenario explicitly:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">callbackForGet</span><span class="p">:(</span><span class="n">PFObject</span> <span class="o">*</span><span class="p">)</span><span class="nv">result</span> <span class="nf">error</span><span class="p">:(</span><span class="n">NSError</span> <span class="o">*</span><span class="p">)</span><span class="nv">error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Everything went fine!"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">error</span> <span class="nf">code</span><span class="p">]</span> <span class="o">==</span> <span class="n">kPFErrorObjectNotFound</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh, we couldn't find the object!"</span><span class="p">);</span>
        <span class="c1">// Now also check for connection errors:
</span>        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">error</span> <span class="nf">code</span><span class="p">]</span> <span class="o">==</span> <span class="n">kPFErrorConnectionFailed</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh, we couldn't even connect to the Parse Cloud!"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">][</span><span class="s">@"error"</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">callbackForGet</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">PFObject</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Everything went fine!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="kt">PFErrorCode</span><span class="o">.</span><span class="kt">ErrorObjectNotFound</span><span class="o">.</span><span class="n">rawValue</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh, we couldn't find the object!"</span><span class="p">)</span>
                <span class="c1">// Now also check for connection errors:</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="kt">PFErrorCode</span><span class="o">.</span><span class="kt">ErrorConnectionFailed</span><span class="o">.</span><span class="n">rawValue</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh, we couldn't even connect to the Parse Cloud!"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">errorString</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">userInfo</span><span class="o">!</span><span class="p">[</span><span class="s">"error"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">errorString</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>When the callback expects a <code class="highlighter-rouge">NSNumber</code>, its <code class="highlighter-rouge">boolValue</code> tells you whether the operation succeeded or not. For example, this is how you might implement the callback for <code class="highlighter-rouge">%{ParseObject}</code>’s <code class="highlighter-rouge">saveInBackgroundWithTarget:selector:</code> method:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">callbackForSave</span><span class="p">:(</span><span class="n">NSNumber</span> <span class="o">*</span><span class="p">)</span><span class="nv">result</span> <span class="nf">error</span><span class="p">:(</span><span class="n">NSError</span> <span class="o">*</span><span class="p">)</span><span class="nv">error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">result</span> <span class="nf">boolValue</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Everything went fine!"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">error</span> <span class="nf">code</span><span class="p">]</span> <span class="o">==</span> <span class="n">kPFErrorConnectionFailed</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Uh oh, we couldn't even connect to the Parse Cloud!"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Error: %@"</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">][</span><span class="s">@"error"</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">callbackForSave</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">NSNumber</span><span class="p">?,</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NSError</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">?</span><span class="o">.</span><span class="n">boolValue</span> <span class="o">==</span> <span class="kc">true</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Everything went fine!"</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="kt">PFErrorCode</span><span class="o">.</span><span class="kt">ErrorConnectionFailed</span><span class="o">.</span><span class="n">rawValue</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Uh oh, we couldn't even connect to the Parse Cloud!"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">errorString</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">userInfo</span><span class="o">!</span><span class="p">[</span><span class="s">"error"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">NSString</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">errorString</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>For synchronous (non-background) methods, error handling is mostly the same except that instead of a <code class="highlighter-rouge">NSNumber</code> representing success or failure you’ll get an actual <code class="highlighter-rouge">BOOL</code> directly.</p>

<p>By default, all connections have a timeout of 10 seconds, so the synchronous methods will not hang indefinitely.</p>

<p>For a list of all possible <code class="highlighter-rouge">NSError</code> types, scroll down to <a href="#errors">Error Codes</a>, or see the <code class="highlighter-rouge">PFErrorCode</code> section of the <a href="/docs/ios/api/Constants/PFErrorCode.html">iOS API</a> or <a href="/docs/osx/api/Constants/PFErrorCode.html">OS X API</a>.</p>


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                    
                    


                    

<div class="helpful">
	<span>Want to contribute to this doc? <a href="https://github.com/ParsePlatform/Docs/tree/gh-pages/iOS">Edit this section.</a></span>
	<hr/>
</div>

                  
                </div>

              </div>
          		<!-- footer goes here -->
            </div>
          </div><!-- end content grid col -->
        </div><!-- end .guide > .grid-container -->
      </div><!-- /.content__wrapper -->
    </div><!-- /.site__content -->
  </div><!-- /.site__wrapper -->

  <script src="/Docs/assets/js/bundle.js"></script>
</body>

</html>
